<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="James S. Clark" />

<meta name="date" content="2017-12-21" />

<title>Generalized joint attribute modeling - gjam</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Generalized joint attribute modeling - gjam</h1>
<h4 class="author"><em><a href="http://sites.nicholas.duke.edu/clarklab/">James S. Clark</a></em></h4>
<h4 class="date"><em>2017-12-21</em></h4>


<div id="TOC">
<ul>
<li><a href="#overview"><span style="color:darkgreen">overview</span></a><ul>
<li><a href="#model-summary"><span style="color:teal">model summary</span></a></li>
<li><a href="#data-types"><span style="color:teal">data types</span></a></li>
<li><a href="#effort-and-weight-of-discrete-data"><span style="color:teal">effort and weight of discrete data</span></a></li>
</ul></li>
<li><a href="#using-gjam"><span style="color:darkgreen">using gjam</span></a><ul>
<li><a href="#simulated-data"><span style="color:teal">simulated data</span></a></li>
<li><a href="#my-data"><span style="color:teal">my data</span></a></li>
</ul></li>
<li><a href="#plotting-output"><span style="color:darkgreen">plotting output</span></a></li>
<li><a href="#flexibility-in-gjam"><span style="color:darkgreen">flexibility in gjam</span></a><ul>
<li><a href="#heterogeneous-effort"><span style="color:teal">heterogeneous effort</span></a></li>
<li><a href="#specifying-censored-intervals"><span style="color:teal">specifying censored intervals</span></a></li>
<li><a href="#prior-distribution-on-coefficients"><span style="color:teal">prior distribution on coefficients</span></a></li>
<li><a href="#sample-effort-in-count-data"><span style="color:teal">sample effort in count data</span></a></li>
<li><a href="#sample-effort-in-composition-data"><span style="color:teal">sample effort in composition data</span></a></li>
<li><a href="#the-partition-in-ordinal-data"><span style="color:teal">the partition in ordinal data</span></a></li>
<li><a href="#categorical-data"><span style="color:teal">categorical data</span></a></li>
<li><a href="#combinations-of-data-types"><span style="color:teal">combinations of data types</span></a></li>
<li><a href="#missing-data-out-of-sample-prediction"><span style="color:teal">missing data, out-of-sample prediction</span></a></li>
<li><a href="#prediction-with-heterogenous-effort"><span style="color:teal">prediction with heterogenous effort</span></a></li>
<li><a href="#conditional-prediction"><span style="color:teal">conditional prediction</span></a></li>
<li><a href="#presence-only-data-with-effort"><span style="color:teal">presence-only data with effort</span></a></li>
</ul></li>
<li><a href="#dimension-reduction"><span style="color:darkgreen">dimension reduction</span></a><ul>
<li><a href="#big-s-composition-data-fungal-endophytes"><span style="color:teal"><em>big-S</em> composition data: fungal endophytes</span></a></li>
<li><a href="#interactions-and-indirect-effects"><span style="color:teal">interactions and indirect effects</span></a></li>
</ul></li>
<li><a href="#joint-trait-modeling"><span style="color:darkgreen">joint trait modeling</span></a><ul>
<li><a href="#trait-response-model-trm"><span style="color:teal">trait response model (TRM)</span></a><ul>
<li><a href="#input-data"><span style="color:brown">input data</span></a></li>
<li><a href="#traits-by-species"><span style="color:brown">traits by species</span></a></li>
<li><a href="#factors-in-this-example"><span style="color:brown">factors in this example</span></a></li>
<li><a href="#trm-analysis"><span style="color:brown">TRM analysis</span></a></li>
<li><a href="#interactions-and-indirect-effects-1"><span style="color:brown">interactions and indirect effects</span></a></li>
</ul></li>
<li><a href="#predictive-trait-model-ptm"><span style="color:teal">predictive trait model (PTM)</span></a><ul>
<li><a href="#start-with-species-abundance"><span style="color:brown">start with species abundance</span></a></li>
<li><a href="#trouble-shooting-in-ptm"><span style="color:brown">trouble shooting in PTM</span></a></li>
</ul></li>
</ul></li>
<li><a href="#selecting-variables"><span style="color:darkgreen">selecting variables</span></a></li>
<li><a href="#trouble-shooting"><span style="color:darkgreen">trouble shooting</span></a></li>
<li><a href="#reference-notes"><span style="color:darkgreen">reference notes</span></a><ul>
<li><a href="#model-summary-1"><span style="color:teal">model summary</span></a></li>
<li><a href="#more-on-parameter-dimensions"><span style="color:teal">more on parameter dimensions</span></a></li>
<li><a href="#more-on-factors-in-mathbfx"><span style="color:teal">more on factors in <span class="math inline">\(\mathbf{X}\)</span></span></a></li>
</ul></li>
<li><a href="#algorithm-summary"><span style="color:darkgreen">algorithm summary</span></a></li>
<li><a href="#acknowledgements"><span style="color:darkgreen">acknowledgements</span></a></li>
<li><a href="#references"><span style="color:darkgreen">references</span></a></li>
</ul>
</div>

<div id="citation" class="section level4">
<h4>citation:</h4>
<p><em>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017. Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data, Ecological Monographs, 87, 34–56.</em></p>
<p><a href="http://sites.nicholas.duke.edu/clarklab/code/">website</a></p>
<p><br></p>
</div>
<div id="overview" class="section level1">
<h1><span style="color:darkgreen">overview</span></h1>
<p><code>gjam</code> models multivariate responses that can be combinations of discrete and continuous variables, where interpretation is needed on the observation scale. It was motivated by the challenges of modeling distribution and abundance of multiple species, so-called joint species distribution models (JSDMs). Because species and other attributes are often recorded on many different scales and with different levels of sampling effort, many analyses are limited to presence-absence, the lowest common denominator. Combining species and other attributes is challenging because some species groups are counted. Some may be continuous cover values or basal area. Some may be recorded in ordinal bins, such as ‘rare’, ‘moderate’, and ‘abundant’. Others may be presence-absence. Some are composition data, either fractional (continuous on (0, 1)) or counts (e.g., molecular and fossil pollen data). Attributes such as body condition, infection status, and herbivore damage are often included in field data. <code>gjam</code> accommodate multifarious observations.</p>
<p>To allow transparent interpretation <code>gjam</code> avoids non-linear link functions. This is a departure from generalized linear models (GLMs) and most hierarchical Bayes models.</p>
<p>The integration of discrete and continuous data on the observed scales makes use of <em>censoring</em>. Censoring extends a model for continuous variables across censored intervals. Continuous observations are uncensored. Censored observations are discrete and can depend on sample effort.</p>
<p>Censoring is used with the <em>effort</em> for an observation to combine continuous and discrete variables with appropriate weight. In count data, effort is determined by the size of the sample plot, search time, or both. It is comparable to the offset in GLMs. In count composition data (e.g., microbiome, fossil pollen), effort is the total count taken over all species. In <code>gjam</code>, discrete observations can be viewed as censored versions of an underlying continuous space.</p>
<p><code>gjam</code> generates an object of <code>class</code> <code>&quot;gjam&quot;</code>, allowing it to appropriate the <code>summary</code> and <code>print</code> functions in R. To avoid conflicts with other packages, <code>gjam function</code> names begin with <code>&quot;gjam&quot;</code>. <code>gjam</code> uses the <code>RcppArmadillo</code> linear algebra library with the <code>Rcpp</code> interface library for R/C++.</p>
<div id="model-summary" class="section level2">
<h2><span style="color:teal">model summary</span></h2>
<p>The basic model is detailed in Clark et al. (2017) and summarized at the end of this vignette (see <strong>reference notes</strong>). An observation consists of two vectors <span class="math inline">\((\mathbf{x}_i, \mathbf{y}_i)^n_{i = 1}\)</span>, where <span class="math inline">\(\mathbf{x}_i\)</span> is a length-<span class="math inline">\(Q\)</span> design vector (intercept and predictors) and <span class="math inline">\(\mathbf{y}_i\)</span> is a length-<span class="math inline">\(S\)</span> vector of response variables, each potentially measured in different ways. <span class="math inline">\(\mathbf{y}_i\)</span> may include both continuous and discrete variables. There is a latent vector <span class="math inline">\(\mathbf{w}_i\)</span> that represents response variables all on a continuous scale. The vector <span class="math inline">\(\mathbf{w}_i\)</span> has the joint distribution <span class="math inline">\(\mathbf{w}_i \sim MVN(\boldsymbol{\mu}_i, \boldsymbol{\Sigma})\)</span>, where <span class="math inline">\(\boldsymbol{\mu}_i\)</span> is the length-<span class="math inline">\(S\)</span> mean vector, and <span class="math inline">\(\boldsymbol{\Sigma}\)</span>, is an <span class="math inline">\(S \times S\)</span> covariance matrix.</p>
<p>As a data-generating mechanism the model can be thought of like this: There is a vector of continuous responses <span class="math inline">\(\mathbf{w}_{i}\)</span> generated from mean vector <span class="math inline">\(\boldsymbol{\mu}_{i}\)</span> and covariance <span class="math inline">\(\boldsymbol{\Sigma}\)</span> (Fig. 1a). A partition <span class="math inline">\(\mathbf{p}_{is} = (-\infty, \dots, \infty)\)</span> segments the real line into intervals, some of which are censored and others not. Each interval is defined by two values, <span class="math inline">\((p_{is,k}, p_{is,k+1}]\)</span>. For a value of <span class="math inline">\(w_{is}\)</span> that falls within a censored interval <span class="math inline">\(k\)</span> the observed <span class="math inline">\(y_{is}\)</span> is assigned to discrete interval <span class="math inline">\(z_{is} = k\)</span>. For a value of <span class="math inline">\(w_{is}\)</span> that falls in an uncensored interval <span class="math inline">\(y_{is}\)</span> is assigned <span class="math inline">\(w_{is}\)</span>.</p>
<p>Of course, data present us with the inverse problem: the observed <span class="math inline">\(y_{is}\)</span> are continuous or discrete, with known or unknown partition <span class="math inline">\((p_{is,k}, p_{is,k+1}]\)</span> (Fig. 1b). Depending on how the data are observed, we must impute the elements of <span class="math inline">\(n \times S\)</span> matrix <span class="math inline">\(\mathbf{W}\)</span> that lie within censored intervals. Unknown elements of <span class="math inline">\(\mathcal{P}\)</span> will also be imputed in order to estimate <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\boldsymbol{\Sigma}\)</span>.</p>
<p><br></p>
<p><img src="data:image/png;base64,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as6ePWu9tjyDBEiABEiABEiABCIQcFyx+fLLL6Vw4cLSqlUr6devn8yePTtC9XiIBEiABEiABEiABMwTcFyxwYKXgwcPVivp9unTR+D+PXDgQLXCt/lqMycJkAAJkAAJkAAJpCTguGJTqVIl6dKli78mN998s/To0UP27t0rb7zxhhw4cMB/jBskQAIkQAIkQAIkYIWArV5RkSri8/lk+fLlMn36dFmyZImsWbNGtm/fLkOGDJGPP/5YLbsQ6XweIwESIAESIAESIIFgAo6P2OzevVtefvllKV68uFSrVk3Z2Rw5ckQefvhhmTJlivz222+SKVMmpeCcP38+uL7cJwESIAESIAESIIGwBBwfsZk0aZIMHTpUmjdvrgyI69WrJ5dddllABUuWLCmYoho0aJCapsqY0fFqBtSHOyRAAiRAAiRAAolBwPERGyyC2blzZ4F31D333JNCqdGxIbjf3XffLd27d9eT+EkCJEACJEACJEACEQk4rthUqFBBjdRErNX/H8Tozvjx481kZR4SIAESIAESIAESEMfneLJnzy5VqlQxhb5FixZSs2ZNU3mZiQRIgARIgARIgAQcV2ysIL/++usFf5S0EcBipJcuXQooJH369ELbpQAk3CEBEiABEvAAAcenojzALKGa8NZbb0nmzJklS5YsAX/wPHvllVcSqi2sLAmQAAmQAAlEI+DqEZtolefx6ATgPo+YQRidwSgNBKM3GMX59ddfoxfAHCRAAiRAAiSQQAQ4YpNANystVf3iiy/UwqNYfHTatGlpKYrnkgAJkAAJkIBrCVCxce2tYcVIgARIgARIgASsEqBiY5UY85MACZAACZAACbiWABUbG2/NunXrbCydRZMACZDA/wiwr+GTQAL/EqDx8L8sYrp18eJFmT17tpQvXz6m5SZqYTNmzBDY+bhx/S+EFOjWrZtkyJAhUfGy3klMgH1N4M1fv369vPPOO3Ly5MnAAy7YK1y4sLz66quSJ08eF9TGu1WgYmPy3q5YsUL9+JnMLhs2bJDHH3/cbPaQ+bCcxI4dO0IeC07ctWuXHDhwIDjZFftQZu677z45deqUK+oTqhKlSpUSBISkkEC8CcSjr/n4449l3rx5ppp++vRpOXbsmKm88ciEfnfJkiXxuLSpa8JDdfDgwabyMlPqCFCxMcmtYsWKgpXJ//jjD8mbN6+kS5cu7Jlwpz548GDY42YP1K5dW7DyuRlZvny5LFy40ExWx/MgZk7RokVly5Ytjl/bzAVxL7HaPIUE3EAgHn0NrpkjRw5TzUefNH/+fFN545EJiyi7WbEpUaJEPLAk1TWp2Ji83YgB069fPxXsrnHjxlHP2rRpk0yYMCFqvkgZGjZsGOlwwDF0SlC63CqLFy9Wb4RunIoqW7asVKpUya3oWK8kIxCPvqZ69eqCPzOyZ88e6d+/v5mscckzZswYadmypStHiDEVVadOnbhwSaaLUrGxcLfvv/9+mTVrlqkzypQpIzVq1DCVNxky5c+fXx588MFkaCrbSAJpJsC+JvUIEWW9SZMmqS+AZyY8AXpFWbiFmLJo0KCB6TPq169vOi8zkgAJkIBOgH2NToKfJGCdABUb68x4BgmQAAmQAAmQgEsJcCrKpTcm1tVatWqV5M6dWxULrwsKCZAACZAACXiRABUbL95VQ5v0hS9ff/11wZ9R9GPGNG6TAAmQAAmQQCIToGKTyHfPRN3bt2+vYk4giJdRoNR06NDBmMRtEiABEiCBBCOAMCSHDx+WfPnySZEiRUzVHuFI9u3bp1z8EeoiUvgSUwW6LBMVG5fdkFhXp169eoI/CgmQAAmQgLcIIMTHxo0bVaO2bt0qCF0Bj9xI8vfffwvinuly6NAhqVy5sr7riU8aD3viNrIRJEACJEACyUZg27ZtAU1G/LQLFy4EpBl3fD6fiopvTEN0ezfGFzPW0eo2FRurxJifBEiABEiABFxAIHgKCSYHmJoKJxidwZIYRgkuw3gsUbep2CTqnWO9SYAESIAEkpoAlqoJlp07dwYn+fcxDRUsBQoUECx74yWhYuOlu8m2JCSBP//8U7788ktZt25dQP2xsKmxI5o+fbqr1+gJqDx3SIAEbCcQao07LIYcamoJaxiGGs0JVYbtFbf5AlRsbAbM4kkgEoGTJ0/Kzz//LE899ZSMGDEiIOuzzz4riD+ky9ixY1U+fZ+fJEACyU0ACzJny5YtBYSjR4+mSDt16lQK+xusNG7WkypFgS5OoGLj4pvDqnmfwOWXXy6PPPKIWhjPOGIzefJk+fHHH2Xv3r1+CMOHD5cbb7zRv88NEiABEgg14hJKsTlx4kQKWJjKypAhQ4r0RE+gYpPod5D19wSB6667TuCuCfnnn39k/fr1UqxYsQDFZuHChdKuXTuVx/hvwIAB8sMPPxiTuE0CJJAkBEIpNmfPnk3ReozYBAv6GC8KFRsv3lW2KeEIGJWYoUOHyjPPPCOFCxdWQbTQmDNnzsjixYulbt26KdqGuBWhjAhTZGQCCZCA5whg1DdPnjyW25U1a1bJnz+/5fMS4QQG6EuEu8Q6ep4APBPOnTsnU6ZMkWuuuUZy5cqlFBt9KuqNN96QF198MSSHZs2ahUxnIgmQQHIQKFGihBw5csRSYzHS40VXb0DgiI2lR4GZScAeAjAChHz++efSsmVLtQ2jPig248aNk/r166d4u8Jw8+DBg6Vq1apiXDIDAbd69uwpGPl5+OGHVVn8RwIk4F0CGLG1qqR4dRoKd5mKjXefdbYsgQjkyJFDMmfOLP369fPXGlNRa9euVdNQNWvW9KfrG1myZFFD0CVLlgwwAJw4caLAULBz587SoEEDPTs/SYAEPEoAfQf6C7OCEeGcOXOazZ5w+ajYJNwtY4W9SACKzUsvvSQwItYFIzatW7eWJ554Qk9K8Tlz5kxp2LBhQDpGd0aOHCmrV68OaWwckJk7JEACniAQyog4XMOs5A1XhpvTqdi4+e6wbklDAAbAffr0CWgvpqTg4h1OEHBr9uzZKRSbSpUqKeNjrOxOIQESSA4ChQoVMhVBGFNWXp6Gwt2mYpMczzxb6XICGErG1JJRsmfPbtxNsb1s2TJBZ4aOCobHEIzUQF577TVZs2aNHD9+XO3zHwmQgLcJpE+fXq644oqojYSjQnBfE/WkBMtAr6gEu2GsLgnoBA4fPqze0P744w/Rh5YR1A9rxVSuXFnZ2GCKi0ICJJAcBNAP/PXXXxEbq/cVETMl+EEqNgl+A1n9xCGAN6pgCZUWnCfc/p133im1atUKCKkODyqs3os3sqZNm4Y7lekkQAIeJADvSsS1wVItocSrSygEtzVlTxucg/skQAIxIYBpI6Ogk8mXL58xyfJ28DoxGKEpWLCgioNjuTCeQAIkkPAEItnPeHUJheCbRsUmmAj3ScAkgQsXLii3apPZVXTgChUqCJQPvFnVqFFDEP2TQgIkQALRCBhjVUXKG2mqKdKxSGUm2jFORSXaHWN940oAwe8Q9G7RokUCryQIjHdhtNepUyfp0qVLxPpdddVVgj8KCZAACUQigP4F9jIbN25Uq3JjHwtW4qUIozJQUtD3BAumojCSG7w2VCxGiIOv5dZ9jti49c6wXq4j8Oyzz8qVV14pCxYs8Cs16Gh8Pp8y2O3atavA4+D33393Xd1ZIRIggcQhAMeAuXPnKs9GeDxCqYESg1Gb3bt3y4033iilS5eWefPmhWxUqDWgEJQvlCIUsoAET+SITYLfQFbffgLoWOBlhBW3IeXLl1eGuZhWgpHuvn375Oeff5bvv/9eDh48KDfddJO8//778vTTT9tfOV6BBEjAUwS2bdumIo7jhQkhHzAyg7/LLrtMsIzKihUrZP/+/eoPkcUHDRqkgnsaIaCPgnekPqqMYxUrVjRm8fQ2FRtP3142Lq0EsKo23ox27dqlXKuffPLJFMsUwCgYC1Gikxk2bJjqeLA697Fjx6R79+5prQLPJwESSBICmHZC+AYI+p2yZcuK0XMSL1K6cTBGX2Dn9/LLL6sFMPv37++nhLhYd9xxh2zYsEGN8iCiOaao/BVbtQAAJ05JREFUkkU4FZUsd5rtTBWBcuXKKaUGc9YIehdp7aXcuXNLr169VIeCi/Xo0UM++uijVF2XJ5EACSQXga1bt/qVGowQY9TFqNQE08iTJ4/gRQsyYMAAtSCuMQ+UIEQhxyK5yaTUgAEVG+OTwG0SMBCoXbu2/Pnnn8pzqW/fvurtyXA45CZsbjAFpStA2MY0FYUESIAEwhHYs2ePmn7C8SpVqkiJEiXCZQ1Iv+uuu6RDhw4qDS9SX3/9dcDxZN2hYpOsd57tjkigZ8+eMn/+fGVsB08nrOVkVjBE/NRTT6k3JcyTI5AejAEpJEACJBBMAMueLF++XCVj6smqS3ajRo3kwQcfVPY0jz32mJp+Cr5Gsu1TsUm2O872RiUAr6eBAweqfG3btlUKStSTgjJg5AardSMgFux0ELOGQgIkQAJGAvBy+u2335StDEJGWHmBMpaDEBTwlDpx4oTcd999ysjYeDzZtqnYJNsdZ3sjEoAHFIZ3MdJSvXp11UlEPCHCQdjlwAU8U6ZMsmnTJnnxxRcj5OYhEiCBZCOwbt06tVAtvJ9gD5NawSjx888/r6KOwwAZzgvJLFRskvnus+0pCNxzzz2qo0EQrI4dO6Y4bjXhSi3uDYaHIUOHDpWVK1daLYL5SYAEPEgALtuw4YNSUq1aNUEAvbQIlCO8PMHgePTo0YIFcZNVqNh4/M7DHfCvKKu9ehyB6eZNmjRJZs6cqfLj7SdWK2NjDhwGgRgFuu2220zXhxlJgAS8SeD8+fMqLARaB7saBM+LhcCt+4EHHlB9Tfv27ZUbeCzKTbQyqNgk2h2zWN9u3bqpEP6//PKLxTOTKzumoFq3bq0a3bBhw5gHs8LoD6amYCjYrl275ILL1pIACQQQWLt2rbK9g8s24tXEUlq0aCEYKd67d2/SBgmlYhPLJ8qFZSH6JAQB5ijhCeAtB2urIBT5I488Ej5jKo9gauvxxx9XZ48dO1at/5LKongaCZBAAhM4cOCAYM05TBkhXg2momIpmNLCunUof+LEiTJr1qxYFp8QZVGxSYjbxEraSQBxZqZOnaouAaM7hC63Q+rVqydYhgFTUpieopAACSQXAXhBrVq1SjUaHlCxmu4Opnj11VerZV/Q1yCIH0akk0mo2CTT3WZbQxLAaA0E9i+whbFToDjBSwpGg1jjhUICJJA8BOAdefLkSaXQXHPNNbY2HFNShQsXVn0N4nIlk6TNDDuZSBnaunnzZvniiy+U8RemeBCzBKH3EQIbsQRuv/12Q25uupkAjISxcCVCjuveS3bWFx3NQw89JOPGjZNXX31VBfLDUgwUEghFgH1NKCqJmfbPP/8I7icErt2RlkuIRQuxpAIin/fp00feffddZduH36hkECo2Fu4yLNmfffZZGTlyZIqzfv31V38aAiS99957KjibP5EbriOAtyd84SGwq3FKwWjatKlaZmH79u0C93IEBKSQgJEA+xojjcTfxpQQvuf4LFmypMDmzgnBit4YicZ0O2z8lixZ4sRl434NKjYWbgF+kLCmx6hRo1TcAYS+xps+RmwQ8REaOVZmhQfSLbfcIuvXr1eeMBYu4cqsGDqdPXu2io6ZlgrCKwgrztr9pmK2jk2aNFFZ4W6pr+1k9ty05NPXk8LK3wsXLlT2PVBwKCSgE0jWvubSpUsq5AL6nLQIvmOwaUNsFzcIjIWhrEIwuu+kYCR62bJlsnTpUhkxYoQaJXby+vG4FhUbk9QRCwYudOGCHiEOAf6g7OBHslmzZiovPlMrWP8DowpmBEpVrK3r9ev269dP3nzzTX03TZ+YwmvVqlWayojFyRh1gxKKDhB2L3axC1dXxJvAGlLTp08XhEM/cuSIaxS+cHVmujME4tHX9O7dW77//ntTDcQP9KFDh0zltZoJizhiqjYWgmB1Q4YMiUVRaSrj7NmzggjDEIzUZM6cOU3lWT0ZI9EYkf7ggw/klVdeUetKwfvTy0LFxuTdhcarxzkxcwq0cthRpEWxgXHp6dOnzVxOGaTB4t4OQRswbYJgf2kRjNi4wf4Ibt3PPfecagqmDa0uOpcWBsZz27Rpo4aGjx07Jo8++qiMGTPGeJjbSUogHn0NVog221ehH8DItR1Sq1YtwfcirSM2cHlu3ry5HVW0XCZi1kAZhAcU+sB4CF62586dqxbIxAK933zzTTyq4dg1qdiYRI2pJViW33zzzabe7hE/oFixYiZLD50t1oGbQl8leioMoidMmBA9Y4LkwBQU3qJgyBvPzg/D5IgOirdKKMFYNBPu4JTkJhCPvgYLMOLPrCD+ih2CRWMR58krgmUTEEsMI8MlSpQQvMTEQzAijZHpF154Qb799ls1m3D33XfHoyqOXJOKjUnMRYoUEQRWwhQCLM2h4MAIDDY2cN/FyMrhw4eVXQ1scNasWSOLFy82WTqzOUXgv//9rz9gFb7oTg8LB7cTb6jz5s1Tc+BYfFMPqBicj/vJQ4B9jTfuNUa29LXh8LsBL6V4Ckam77//fhW0D6M2WCwzXiNIdnNgHBsLhLGWUN26dZXWW6NGDeX1BLsaPBz58uUTxCXAaMC+fftkxowZUqhQIQulM6vdBNDRILYDpH79+q4ZHUEnkzVrVhUdGqM2FBJgX5P4zwCcR/DCi9+IUqVKuaJBmG7ETAJeoBDqwquSTnM/83m1cXa1C5oujNxWrFih1uPADya0YQw1QiO+9dZb7bq05XLxQ45psa+++ipmRnmWK+GSE+69916ZMmWKYH2W4cOHu8ZjAnimTZumPBYwZAxDQ3hqUUggkfoa3q1/CSA2Fjwe8X2GXSGUm7///lswNVW1atV/M6ZiC0oJfm9giPzpp59aLgHPFDwyUTc4L+Alz2vCqahU3NFrr71WevXqlYozeUq8CEChwR8EsYjc4gaq84CHFDpCTGGio+HaXjqZ5P5kX5N49x+GwsuXL1cVx7IJUGrcJHimMLMALzi4gmNkyW39YVp5cSoqrQRdfj7sfyD6p8ura0v1EGPIOAVVrVo1W66TlkLx9oSF67BO1e7dux2JgpyW+vJcEiCB0ATwcoIpKLhZQ7FxoyDEBEZ9MIqkL87rxnqmtk5UbFJLLkHOQ9yC/v37CwxTk1UQeRMdDbyg3PwlLlCggFqwDvdp9OjRAkNnCgmQQOIQgKKAP3hBYd05twQjDSaIF114SMEtHqYK6G+8JFRsvHQ3Q7QF8XTgpm7XitUhLumqpB49eihbKHQ0CNjldg516tRRIdABETF24GlHIQEScD+B48eP+1fuvuGGG2xbuTtWJLACeNu2bVVxGC3esGFDrIqOezlUbOJ+C1gBuwjAMO6NN95QxeML7NZh4eD2I5wA4nkg1o4bp82C68t9Ekh2ArCrwXqBCJKKeEAIBZIIAocKxCnDdD22MbLtBaFi44W7yDakIICw9I0bN1aLzsE1X18XKkVGFyZgVAleC3AB//PPP5N6GtGFt4dVIoEAAnAsRrRoKAeILoyVuxNJ4PYNT9EtW7Yo71kvOEpTsUmkJ5B1NUUA62ahc8Fb1JXa+l6JGK8BoQM6d+6s2gtbG6wbRiEBEnAfARgLI3YZ7FaqV6+u7FbcV8vwNYJHlB5zDe7oWCwz0YWKTaLfQdY/gMCZM2dUdGiELsdbCOyLMPKRiILo1li8DoIw6AMGDEjEZrDOJOBZAlhIF6OqMBKGUoNI9IkuUNIwepPIQsUmke8e6x5AAItbYn0tLNCHDqZv374CT6NEFhgQY0oNgthJVG4S+W6y7l4iAKUGwe4gCLqH6POJLnABhyBIaCIrN1RsEv1JZP0VAaw+ji8lAtthiYt+/foljAFftFuIIFoI4AeBcqOvTB7tPB4nARKIPQHYoCDqvK7UwK0bxv5eEEzdV6xYUTUFyg08pRLR5oaKjReexiRvw+zZswWui3CNRpRPxO1xy8rosbg1CN6H9aTgtQB57733lEs4lvKgkAAJOEcAdntz5syRHTt2qCUJ4LWoj3I4Vwt7rwTlBqu3o9/ZtGmT/P7775JofQ0VG3ufEZZuM4Enn3xSLUFw6dIltbgb3Luh5HhN0Mlg5AZ/2P7ll1/UNBtXkPfanWZ73Erg0KFDMnfuXOX9hO8gHBTg2u1FgfOCbgiNSOjz5s2TI0eOJExTqdgkzK1iRY0Epk6dKvnz55eRI0eq5FtuuUXefPNNFV3YmM9r2xi1ge0QRqaOHj0qaPc999yjOluvtZXtIQE3EEA8qZUrV8qCBQv8SyVgPTf8+HtZ4CmFBTxz5swpJ0+elJ9//llWr14t586dc32zqdi4/haxgkYC8A4qVaqUMqjFGxRcFeHO3bVrV9dHFTa2Iy3bmAMfNmyYID4P5Mcff1Tr0jRv3lytHpyWsnkuCZDA/wggWB3sTGbOnCmw4cMoDRaQrFWrlrLjSwZO6F+xJA2m9tF+eICBB2xv4IHqVuHq3m69M6yXnwCmW95++22ZNm2af2QCSyQ0aNBAWrVqpd4o/JmTZAML7HXr1k2tIvzZZ5+pOf+vv/5a8IcIy4i0DCNjvG1RSIAEzBHAaATcneGEgJguuuEsRi/Kly/v+mUSzLXSWi70tWg7bInWrl0rBw4cULY3mzdvViPkmI4rWLCgqxZapmJj7R4zt40EYKC2fPlymTBhgnpDWrVqlfqEwZ4uiMpbt25dZUirB5XSjyXjJzwyMNe/ZMkS+eGHHwQuqDD4g/cU/vDGdf3116uw6TVr1hT8FStWLBlRsc0kEEAAU0z4kYYyg6jBcD5A/CtdMEIBbyeMViAmVrILXpIw9Q1OcAXfu3evCq2B8BoQ9M1FihRRL1OIwIyQG1myZIkLtnSaRuqLy5V50ZgT+O6772yZisADjNESrINiFP3RwWfwNvbRSSBwFR5unIs/KC/4g7KCDgWf+EOaXobxGsZtrM59pWaxjwiflNAEYOCHNyl02pEE9wUcM2fOrD6xjT9dicSIEN7U0LkjL/6wjT9I8DbSMB8f7I0Gxap169Y4TPEQAUwDI8J3rAV9AGzH4AwQSkL1EUhDX4Jz0NdgXz8fn8Y/vf+J1N/gBxk2bPgOYPXrWAm+m1goM622OVAk8IKCerZp0yYm1Zs0aZIaqcJK32bXpwND3CsoOuGmpdBPgCH6FvQnel+CT9wX9DdoR6h+xdgw/bieBiUKYT2CBWt0qb5Kewio2ATTSdB9PJBYs4RCAm4hgGHqnTt3uqU6rEeMCMCYFnYnFOcJQJlo166dLRcePHhwwiwWHAoA4n0h0nzs1NFQV2GaowSwnhBWao21wGAMK9eaFV27xqgBtGeMCiBN/zNq7diGJg+tHn/6uWavxXzWCegjZ/ooGj71t1y8+WIf90x/5wn+DHdFzMNj2ssoeOuleI8APBLt+K7i2cNIr/7MmSWnj8DoUx84X+9nUE9s65/ob/TRA7PlxyKfPoqEuqRVXnrppZgrloicXK9ePcUmrfXTz0eb9X5GHznDvdHTMWKDvgai33N86tvhnjHcZ4wGB4s+wsapqGAy3CcBEiABEiABEkhYAmlXHRO26aw4CZAACZAACZCA1whQsfHaHWV7SIAESIAESCCJCVCxSeKbz6aTAAmQAAmQgNcIULHx2h1le0iABEiABEggiQlQsUnim8+mkwAJkAAJkIDXCNDd22t3NKg9WHIeAdIQnTaeAndMRBW+6aab4lkNdW1E6UU9YuF2mZbGIOYQ3KN1F9W0lJWWc7Gw3XvvvaciOqelHJ5LAldffbUK8Bbv7xb6mnLlyqmYJvG8K2vWrJErtaCiiMQbT9m4caNaNBgu3fGUbdu2yf333y/du3e3tRpUbGzF647CES78vvvui2tlUAdEL453PQDhm2++kQEDBsQ0qmhq4M6aNUuwSjBigsRToPwi1gSFBNJKAGss9evXzx+bJK3lpfb8OXPmqJgsWMMongIF6+abb4570LshQ4ZIhQoV4v5iOWrUKEdWB2ccm3g+9Q5cG6uwPvDAA7J+/XoHrhb+EggnjlW5EX473oIREoQ21wNDxas+CP/9yy+/pDnEelrrX716dRk+fHjcO720toPnx58AwtxjuQWEvI+nYORo9uzZctVVV8WzGmptJSgVNWrUiGs9MEqC5Rfi/WL5zDPPyA033CBPP/20rTxoY2MrXhZOAiRAAiRAAiTgJAEqNk7S5rVIgARIgARIgARsJUDFxla8LJwESIAESIAESMBJAlRsnKTNa5EACZAACZAACdhKgIqNrXhZOAmQAAmQAAmQgJMEqNg4SZvXIgESIAESIAESsJUAFRtb8bJwEiABEiABEiABJwlQsXGSNq9FAiRAAiRAAiRgKwEqNrbiZeEkQAIkQAIkQAJOEqBi4yTtOFwL0XVLlCgRhysHXjJDhgxxjwKq1wgRkNOlS6fvxu0TkYczZcoUt+vrFy5WrFjc19TR68LPxCaAiL/xXicKBPndCnyOChcuLNmzZw9MjMNegQIFJFeuXLZfmUsq2I6YFyABEiABEiABEnCKAEdsnCLN65AACZAACZAACdhOgIqN7Yh5ARIgARIgARIgAacIULFxijSvQwIkQAIkQAIkYDsBKja2I+YFSIAESIAESIAEnCJAxcYp0rwOCZAACZAACZCA7QSo2NiOmBcgARIgARIgARJwigAVG6dI8zokQAIkQAIkQAK2E6BiYztiXoAESIAESIAESMApAlRsnCLN65AACZAACZAACdhOgIqN7Yh5ARIgARIgARIgAacIULFxijSvQwIkQAIkQAIkYDsBKja2I+YFSIAESIAESIAEnCJAxcYp0rwOCZAACZAACZCA7QSo2NiOmBcgARIgARIgARJwigAVG6dI8zokQAIkQAIkQAK2E6BiYztiXoAEEofA6dOnxefzJU6FWVMSIIGEJXDy5Elb6k7Fxhas7ir06NGj0q1bNylXrpyUKlVK2rZtK7t373akknhw33rrLXnmmWekQ4cO8vrrr8upU6ccubbxIvFkYKxH8HaPHj2ke/fuwcmO7q9evVoeeeQR6devn0yePFkuXrzo6PV5Me8QiOf3jH1N5Odox44dcu2118q+ffsiZ7Tx6Pnz59XvwVNPPSVDhw6Vv//+25arpdPezvh6ZgtadxR69uxZqVu3rhQrVkxKlCghEyZMUA8TttesWSM5c+a0raJ4tJo1aya5cuWSkSNHSrp06aRz586yc+dO+eabb9S+bRc3FBxPBoZqpNicOXOm3HnnnfL4448rPiky2Jxw/Phx6dWrl8ydO1fGjh0rlSpVsvmKLN7LBOL5PWNfE/nJunTpktSpU0d+/vln1f9eccUVkU+w4eicOXOkY8eO8uCDD8qrr74qmTJlsuEq/18kFBuKdwkMHz7cN378eH8DL1y44Lv77ruhzPo0jdmfbsfGsGHDfJoy49u0aZO/eE2p8WkPtA/HnJJ4MgjXxgMHDvg0pc9XoEABX/v27cNlsy1d6+h8jRs39uXNm9envcnZdh0WnDwE4vk9Y18T+TnTRsp9TZs2Vf0++mCnZfHixarff/nllx25NKei7NMZXVHy4cOHpUWLFv66ZMiQQR599FG1rykc/nQ7Nj755BOpUqWKXHPNNf7i8aZQo0YNR0co4snA3/CgjZdeekkGDx4suB/xkCFDhsiUKVNkxIgRUrx48XhUgdf0GIF4fs/Y14R/mH777Tc5ePCgNGzYMHwmG4/ozwVMIQYOHGjjlf4tmorNvyw8udW7d+8U7YJiAbnqqqtSHItVAqabMNVVpkyZFEVC0Vm7dq389ddfKY7ZkRAvBuHa8vHHH0v9+vXlyiuvDJfF1vSNGzcKbHtKliwp999/v2zevFm2bt1Ko2FbqXu/8Hh9z9jXhH+2YHcEu8YBAwaEz2TzEZgfwL7nueeeU/aVK1asEEyD2ylUbOyk69Ky161bJ1myZFFznXZVUTcKy5cvX4pL5MmTR6Vt3749xTGnEpxgEKotUCqWLl0qbdq0CXXYkTTY1GhTkoJ707p1a2XUXbZsWSlfvrysWrXKkTrwIslBwInvGfua8M9S165dpW/fvpI1a9bwmWw+MmPGDHWFRYsWSbt27aRJkyaC3wC8XMH2xw7JaEehLNPdBD788EPlJWXniAGGPiGXXXZZChh6mp4nRQYHEpxgENwMeATAA2r06NHBhxzdh2IF6dmzpxqxwfayZcvklltuUfv4MYpnR4j6ULxBwInvmd6P6P2KkZyepucxHnNq2wkGodry3XffKS/YihUrhjrsSBpeXuGFVa1aNfnggw/UCzUuDAPiQYMGqVmDJ598MuZ14YhNzJG6u8BZs2apCvbp08fWimpGqar8UK7D586dU8cwFRIPcYpBcNvA/Pnnn5fcuXMHH3J0H9OA8FC74447/NetWrWqepvatm2bzJ4925/ODRJILQGnvmfsa1LeoV27dikP2BdeeCHlQQdT0NdA4JGFWQJdNENztQlvWTuEIzZ2UHW4zIULF4rm4RJwVQw/durUKSANP1rvvPOOfP3115I+vb06LdzJIaECMGF+FT+smP5wWpxkYGwbYsX8+OOPonlBCeaYdQEffPlxXypXriy1a9fWD9n2WahQIcmYMaNkzpw54Bow9IZs2bIlIJ07JGAkcO+998qCBQv8SRjdC46L5eT3jH2N/1b4N/AChRF5xIrRRfNMUptQJhCCA7HFjMqGni+Wn+hrINmyZQsotkiRIlK4cGHb+hoqNgG4E3MH1uYTJ04MqHzp0qUD9o8dO6amHsaNG5fiIQvIGKOdokWLKhuOUAbCGJrEaM3ll18eo6uZK8ZpBsZanThxQikTn3/+uTFZzpw5o4x3kY7RLScUGwTpgpIFBat69er++ug/EFC+KCQQjgBGHo8cOeI/HPyS5PT3jH2N/1b4N9C3wpbOKIcOHVK7mKJCDBktzITtig2cR/ASq09/G+uD/sb4HBmPpXnbEadyXiSuBLRIv77HHnvMt3fv3oB6aD+qPi1IXEBaLHe0IEwqToo2KhFQrKbU+LTOMSDN7p14MYjWLs3V2vE4Nhs2bPBpIzYpYglprpgq1oSmjEarNo+TQEgC8fqesa8JeTsCEkeNGuXTFAaf03FsHn74YfU7gNhZumj2hj5N+fI98cQTelJMPxl5OM2qobsLgMGqFphJGWnpb+SoMUYQ5s2bJx999JFtU0L79+9XcWy6dOmibEtw3fnz56shUIwWBE+F4LgdEk8G0dqDe4Low3bNNYe7PrwlEPl4yZIl/re2Bg0ayA033CBvv/12uNOYTgJhCcTze8a+Juxt8R/49NNPVZRzuMc7GXkYXmuYZofxcPPmzVV9YD7RqFEj0V6ybKkLp6L8t92bGwjG99NPP4VsXK1atWxTanDBggULCh5gbbRI/vjjD7VOCazktUjIjik1qEc8GeD6bhQEB8Qf4tggpg7sfND5OBVAy41MWKe0EYjn94x9TdrunZ1nIwAoggRirUBMScG2Bi9VsNOyS8HiiI2dd5Rl+wlgLhUjNE7b1fgrwI2QBGDXA0NP2Dw5NYIWsiJMJIEYEWBfEyOQNhSjLSUjGNmDXZSdQsXGTrosmwRIgARIgARIwFEC9vr8OtoUXowESIAESIAESCDZCVCxSfYngO0nARIgARIgAQ8RoGLjoZvJppAACZAACZBAshOgYpPsTwDbTwIkQAIkQAIeIkDFxkM3k00hARIgARIggWQnQMUm2Z8Atp8ESIAESIAEPESAio2HbiabQgIkQAIkQALJToCKTbI/AWw/CZAACZAACXiIABUbD91MNoUESIAESIAEkp0AFZtkfwLYfhIgARIgARLwEAEqNh66mWwKCZAACZAACSQ7ASo2yf4EsP0kQAIkQAIk4CECVGw8dDPZFBIgARIgARJIdgJUbJL9CWD7SYAESIAESMBDBKjYeOhmsikkQAIkQAIkkOwEqNgk+xPA9pMACZAACZCAhwhQsfHQzWRTSIAESIAESCDZCVCxSfYngO0nARIgARIgAQ8RoGLjoZvJppAACZAACZBAshOgYpPsTwDbTwIkQAIkQAIeIkDFxkM3k00hARIgARIggWQnQMUm2Z8Atp8ESIAESIAEPESAio2HbiabQgIkQAIkQALJToCKTbI/AWw/CZAACZAACXiIABUbD91MNoUESIAESIAEkp0AFZtkfwLYfhIgARIgARLwEAEqNh66mcnclHPnzsmuXbvE5/PZigHlb9q0SU6fPm3rdVg4CZBA4hM4dOiQHDt2LPEbkmAtSKd11Pb+EiQYEFY3MQksXLhQbr31Vjl8+LDkyZPHlkZMmjRJZsyYIddff72MGzdOSpQoIb169ZIKFSpYuh7OnTx5ctRznnvuObn99tuj5mMGEiABdxJo0KCBlCtXToYNG+bOCnq0Vhk92i42iwRiSmDRokXSp08fWbVqlaRLl07at28vefPmld9++022bdum0sxe8O6775aBAwfKhg0bpHv37tK7d2916oULFwQK2pQpU2TEiBFy7733mi2S+UiABEiABP6fAKei+CiQgAkCeOO67bbb/ApMlixZpHbt2vLXX3/Jzp07TZTwbxYoRNOnT5dixYrJoEGDZOzYsXLZZZdJjhw5pGHDhvL+++/Lfffd9+8J3CIBEiABEjBNgIqNaVTMmKwEMFv7/fffS/78+VMguO6666R48eIp0qMl4BwoN1BynnnmGfnuu+8CTunSpYvky5cvII07JEACJBCJAPqq8+fPR8qSFMeo2CTFbU6cRv7555/y5Zdfyrp16wIqDcPgv//+258GpWD+/Pn+fePG5s2bpVatWlK2bFn1h5GW2bNny08//aTSYRPz+eefG0+JuH3gwAGBcXLWrFmV0fDFixfVSM3evXvlgw8+iHhupIOYe8e0E0Z/WrVqFdCe6tWrC6asKCRAAvElcPLkSVmwYIF89tlnKSqyZMkSf9o///wjw4cPF+QPJSdOnBBMaWNEdvfu3f4sK1euVH2eP8HExvHjx9VUtd7HYWobL0NFixZVI7+NGzeWffv2mSjJo1lgPEwhATcQ0L6sPq3z8GlTMr6OHTsGVKlJkyY+TQnwp2mKgE8bLfHvax0PjOB9mvGwStM6HF+GDBlU2lVXXeXTFBPfpUuXfJrC49OUHP95Zja0jkeVo3Uevnbt2vmqVq3qq1Onjk9TrlSZZsqIlGfq1Km+jBkz+nLlyuXDtSgkQALuIYDvZNOmTVUfoL3k+Cv2+++/+2666Sb//tq1a32ZMmXyjR8/3p9Wv359X6dOndT+smXLfC+99JLql/Cpy+DBg1XZ2ouSnmTq848//lDnod8rXLiw79NPP/VpHpu+q6++WqVXq1YtJv2Tqcq4LBPcYykk4CoCmtGsUhz0SmnTQOqHf+TIkXqST3Oj9LVp08a/H6zY4EDXrl39X3zNQNfXv39/38cff+w/x+wGlCR0HlBstNEadZr2NuTTRoJ89erV8+3fv99sUWHzjRo1Sl1jwIABYfPwAAmQQHwILF++XH0/tVFiVQHN0N938803+6644oqACkGJ2bJliz/NqNjoiS1btlTn4UVLl/vvv9935swZfdfUJ/od9Ev4w4ueLj169PCna16cenJSfXIqSnsqKO4iALuVrVu3qkpheHf9+vXK0BZTP7rAe0gbPdF3Q37269dPypQpo45pCoNgmuuJJ54ImddsYvr0//vKFCxYULQ3JDXF9eSTT5o9PWQ+eEPBjVzrkOSVV14JmYeJJEAC8SNw7bXXqovr/ZL2giR33XWXaMqFP3aWpjmINvIqpUqVilhRTDtjal1Tlvz5MD2OKenUSrZs2fynGm3+gqf0/Zk8vkHFxuM3OBGbB28hXYkZOnSoMq7Vhlr9c8bam40sXrxY6tatG7F5sIn55JNPlCcT7GK0oWCBEhErQQdWoEAB+eGHH1IdsA+2O82aNVOxcV5//fVYVY3lkAAJxJAAFAcY+u/Zs0e9IKE/0aahlKEuYmdBEJ9KG0WOelVtlFcyZ86snAeQGXY6iMEVK4GdjS5QvJJRqNgk4113eZuhLOAHH4a111xzjWi2JwLFRld23njjDXnxxRdNtQLn4Q8CIz1tPtvUeWYzYURIG1KWU6dOmT3Fnw/Ri7W5e2XQjEB/RkG0UihiFBIgAXcQQL+EPui9996TDh06+PsVpG3cuFFg0FupUqWolUVoByhFuuHx3LlzBcpOrARGyrogiGgyChWbZLzrLm8z3owg8FzS5qPVdpEiRVSngrcibd46pOu1ymj4B2VDM0JWQe/0KanXXntNBcYzZEv1Jt7aELAPdbPqmg3PCXgu4C+UkjZx4kQV/C/VleOJJEACMSWAfkkzDFbeSJqRsPre4wKaTY1oNnJqZNnsBRFRfM2aNTJt2jRp1KiR2dNM5cOoki6aHZC+mVSfVGyS6nYnRmMRqA5DtbCR0QWjLprXgWAaqmbNmnpy2E9MObVu3Vratm0rmleUfPjhhyrv2bNnVdRgjLLo8vTTT8uNN96YwsVcP65/QpGBLYwuiDqMt6NXX31VT1Kf0cqD3dAdd9yhXEgR+A82RcY/DCWn1W4noELcIQESSDMBPYCmvswJ4lppnpfy1ltvKfs4RCQ3KzVq1JDt27erF6NQozwYrS1fvrz07NnTVJFz5sxR9j4Y6cbLH0TzJDU1gmTqAgmWiYpNgt2wZKguOhDNHVL92OvtxagIFBUzxr+IdwP7G6zthLgREExD6YK0bt266btqZERz3fQrP/4DQRvoxBAbAnY/MB6E8oGpraeeeiogJxSeSOW1aNFC1QtKFoawg/+Mb1wBBXOHBEggbgRglAslRhc4EkD5gB2f1fXpsN4cFKPHHntMLy7gE8bFWHIFkcnNxKPBlD2mtdFPrl69Wr04jRkzJqDMZNrhIpjJdLcTpK1464CHgdFLACMj2bNnt6UFGN2BsrNixQp5/vnnU1xj6dKlgiFdBMHC2k4Y7cHbFuavoewES7TygvNznwRIwP0EYEODly6jhEozHg+3/eOPPyrDYygj4eTgwYNqkV0E/cPUV7AgcCi8MyFYu04LhyFaHBsVSDRZbWt0Rhyx0Unw0zUEMA1lVGpQMbuUGpQNJQqeTRgRMiN4U8P0ViilJjXlmbkm85AACcSXQLBSg9qESotWSy0Gl2jB9dQIS6S8UFLgBh5KqQk+D30YBLaEya7UgANX9wYFSlITgFdCLNdminV5SX1z2HgS8AAB2AdOmDBBLW6L0RqM/EYSjFpjSh3ryIUTjBbpsm3bNn2TnxoBKjZ8DJKeAAx5YymxLi+WdWNZJEACzhPYuXOnjB49WsW7gt0MAvlFEoxawxYvnGDUB04Kl19+ucoCm77nnntOEArDGKwv3PleT6eNjdfvMNuXZgLwhoInE+JPIOgfhQRIgARIwL0EqNi4996wZiRAAiRAAiRAAhYJ0HjYIjBmJwESIAESIAEScC8BKjbuvTesGQmQAAmQAAmQgEUC/wcftU3INDZ41QAAAABJRU5ErkJggg==" /><!-- --></p>
<p><strong>Censoring in gjam.</strong> As a data-generating model (a), a realization <span class="math inline">\(w_{is}\)</span> that lies within a censored interval is translated by the partition <span class="math inline">\(\mathbf{p}_{is}\)</span> to discrete <span class="math inline">\(y_{is}\)</span>. The distribution of data (bars at left) is induced by the latent scale and the partition. For inference (b), observed discrete <span class="math inline">\(y_{is}\)</span> takes values on the latent scale from a truncated distribution.</p>
</div>
<div id="data-types" class="section level2">
<h2><span style="color:teal">data types</span></h2>
<p>The different types of data that can be included in the model are summarized in Table 1, assigned to the <code>character</code> variable <code>typeNames</code> that is included in the <code>modelList</code> passed to <code>gjam</code>:</p>
<p><strong>Table 1. Partition for each data type</strong></p>
<table style="width:100%;">
<colgroup>
<col width="8%"></col>
<col width="12%"></col>
<col width="16%"></col>
<col width="39%"></col>
<col width="22%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"><code>typeNames</code></th>
<th align="center">Type</th>
<th align="center">Obs values</th>
<th align="center">Default partition</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><code>'CON'</code></td>
<td align="center">continuous, uncensored</td>
<td align="center"><span class="math inline">\((-\infty, \infty)\)</span></td>
<td align="center">none</td>
<td>e.g., centered, standardized</td>
</tr>
<tr class="even">
<td align="center"><code>'CA'</code></td>
<td align="center">continuous abundance</td>
<td align="center"><span class="math inline">\([0, \infty)\)</span></td>
<td align="center"><span class="math inline">\((-\infty, 0, \infty)\)</span></td>
<td>with zeros</td>
</tr>
<tr class="odd">
<td align="center"><code>'DA'</code></td>
<td align="center">discrete abundance</td>
<td align="center"><span class="math inline">\(\{0, 1, 2, \dots \}\)</span></td>
<td align="center"><span class="math inline">\((-\infty, \frac{1}{2E_{i}}, \frac{3}{2E_{i}}, \dots , \frac{max_s(y_{is}) - 1/2}{E_i}, \infty)^1\)</span></td>
<td>e.g., count data</td>
</tr>
<tr class="even">
<td align="center"><code>'PA'</code></td>
<td align="center">presence- absence</td>
<td align="center"><span class="math inline">\(\{0, 1\}\)</span></td>
<td align="center"><span class="math inline">\((-\infty, 0, \infty)\)</span></td>
<td>unit variance scale</td>
</tr>
<tr class="odd">
<td align="center"><code>'OC'</code></td>
<td align="center">ordinal counts</td>
<td align="center"><span class="math inline">\(\{0, 1, 2, \dots , K \}\)</span></td>
<td align="center"><span class="math inline">\((-\infty, 0, estimates, \infty)\)</span></td>
<td>unit variance scale, imputed partition</td>
</tr>
<tr class="even">
<td align="center"><code>'FC'</code></td>
<td align="center">fractional composition</td>
<td align="center"><span class="math inline">\([0, 1]\)</span></td>
<td align="center"><span class="math inline">\((-\infty, 0, 1, \infty)\)</span></td>
<td>relative abundance</td>
</tr>
<tr class="odd">
<td align="center"><code>'CC'</code></td>
<td align="center">count composition</td>
<td align="center"><span class="math inline">\(\{0, 1, 2, \dots \}\)</span></td>
<td align="center"><span class="math inline">\((-\infty, \frac{1}{2E_{i}}, \frac{3}{2E_{i}}, \dots , 1 - \frac{1}{2E_i}, \infty)^1\)</span></td>
<td>relative abundance counts</td>
</tr>
<tr class="even">
<td align="center"><code>'CAT'</code></td>
<td align="center">categorical</td>
<td align="center"><span class="math inline">\(\{0, 1\}\)</span></td>
<td align="center"><span class="math inline">\((-\infty, max_{k}(0, w_{is,k}), \infty)^2\)</span></td>
<td>unit variance, multiple levels</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(^1\)</span> For <code>'DA'</code> and <code>'CC'</code> data the second element of the partition is not zero, but rather depends on effort. There is thus zero-inflation. The default partition for each data type can be changed with the function <code>gjamCensorY</code> (see <strong>specifying censored intervals</strong>).<br />
<span class="math inline">\(^2\)</span> For <code>'CAT'</code> data species <span class="math inline">\(s\)</span> has <span class="math inline">\(K_s - 1\)</span> non-reference categories. The category with the largest <span class="math inline">\(w_{is,k}\)</span> is the ‘1’, all others are zeros.</p>
<p><br></p>
</div>
<div id="effort-and-weight-of-discrete-data" class="section level2">
<h2><span style="color:teal">effort and weight of discrete data</span></h2>
<p>The partition for a discrete interval <span class="math inline">\(k\)</span> depends on effort for sample <span class="math inline">\(i\)</span></p>
<p><span class="math display">\[(p_{i,k}, p_{i,k+1}] = \left(\frac{k - 1/2}{E_{i}}, \frac{k + 1/2}{E_{i}}\right]\]</span></p>
<p>Effort affects the partition and, thus, the weight of each observation; wide intervals allow large variance, and vice versa. For <strong>discrete abundance</strong> (<code>'DA'</code>) data on plots of a given area, large plots contribute more weight than small plots. Because plots have different areas one might choose to model <span class="math inline">\(w_{is}\)</span> on a ‘per-area’ scale (density) rather than a ‘per-plot’ scale. If so, plot area becomes the ‘effort’. Here is a table of variables for the case where counts represent the same density of trees per area, but have different effort due to different plot areas:</p>
<table style="width:100%;">
<colgroup>
<col width="24%"></col>
<col width="19%"></col>
<col width="27%"></col>
<col width="6%"></col>
<col width="22%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="right">count <span class="math inline">\(y_{is} = z_{is}\)</span></th>
<th align="center">plot area <span class="math inline">\(E_{i}\)</span></th>
<th align="center">density <span class="math inline">\(w_{is}\)</span></th>
<th align="right">bin <span class="math inline">\(k\)</span></th>
<th align="center">density <span class="math inline">\(\mathbf{p}_{ik}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="center">0.1 ha</td>
<td align="center">100 ha<span class="math inline">\(^{-1}\)</span></td>
<td align="right">11</td>
<td align="center">(95, 105]</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="center">1.0 ha</td>
<td align="center">100 ha<span class="math inline">\(^{-1}\)</span></td>
<td align="right">101</td>
<td align="center">(99.5, 100.5]</td>
</tr>
</tbody>
</table>
<p>The wide partition on the 0.1-ha plot admits large variance around the observation of 10 trees per 0.1 ha plot. Wide variance on an observation decreases its contribution to the fit. Conversely, the narrow partition on the 1.0-ha plot constrains density to a narrow interval around the observed value.</p>
<p>For <strong>composition count</strong> (<code>'CC'</code>) data effort is represented by the total count. For <span class="math inline">\(0 &lt; y_{is} &lt; E_i\)</span> the variable <span class="math inline">\(0 &lt; w_{is} &lt; 1\)</span>, i.e., the composition scale. Using the same partition as previously the table for two observations that represent the fraction 0.10 with different effort (e.g., total reads in PCR data) looks like this:</p>
<table style="width:100%;">
<colgroup>
<col width="24%"></col>
<col width="18%"></col>
<col width="20%"></col>
<col width="10%"></col>
<col width="25%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="right">count <span class="math inline">\(y_{is} = z_{is}\)</span></th>
<th align="right">total count <span class="math inline">\(E_{i}\)</span></th>
<th align="center">fraction <span class="math inline">\(w_{is}\)</span></th>
<th align="right">bin <span class="math inline">\(k\)</span></th>
<th align="center">fraction <span class="math inline">\(\mathbf{p}_{ik}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">100</td>
<td align="center">0.1</td>
<td align="right">11</td>
<td align="center">(0.095, 0.105]</td>
</tr>
<tr class="even">
<td align="right">10,000</td>
<td align="right">100,000</td>
<td align="center">0.1</td>
<td align="right">10,001</td>
<td align="center">(0.099995, 0.100005]</td>
</tr>
</tbody>
</table>
<p>Again, on the composition scale <span class="math inline">\([0, 1]\)</span>, weight of the observation is determined by the partition width and, in turn, effort.</p>
<p><br></p>
</div>
</div>
<div id="using-gjam" class="section level1">
<h1><span style="color:darkgreen">using gjam</span></h1>
<p>It’s easiest to start with the examples from <code>gjam</code> help pages. This section provides additional examples and explanation.</p>
<div id="simulated-data" class="section level2">
<h2><span style="color:teal">simulated data</span></h2>
<p>Simulated data are used to check that the algorithm can recover true parameter values and predict data, including underlying latent variables. To illustrate I simulate a sample of size <span class="math inline">\(n = 500\)</span> for <span class="math inline">\(S = 10\)</span> species and <span class="math inline">\(Q = 4\)</span> predictors. To indicate that all species are <em>continuous abundance</em> data I specify <code>typeNames</code> as <code>'CA'</code>. <code>CA</code> data are continuous above zero, with point mass at zero.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gjam)
f &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">S =</span> <span class="dv">10</span>, <span class="dt">Q =</span> <span class="dv">4</span>, <span class="dt">typeNames =</span> <span class="st">'CA'</span>)
<span class="kw">summary</span>(f)</code></pre></div>
<p>The object <code>f</code> includes elements needed to analyze the simulated data set. <code>f$typeNames</code> is a length-<span class="math inline">\(S\)</span> <code>character vector</code>. The <code>formula</code> follows standard R syntax. It does not start with <code>y ~</code>, because gjam is multivariate. The multivariate response is supplied as a <span class="math inline">\(n \times S\)</span> <code>matrix</code> or <code>data.frame ydata</code>. Here is the <code>formula</code> for this example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f$formula</code></pre></div>
<p>The simulated parameter values are returned from <code>gjamSimData</code> in the list <code>f$trueValues</code>, shown in Table 2, with the corresponding names of estimates from <code>function gjam</code>, which I discuss below:</p>
<p><strong>Table 2. Variable names and dimensions in simulation and fitting</strong></p>
<table>
<thead>
<tr class="header">
<th align="center">model</th>
<th align="center"><code>$trueValues</code><span class="math inline">\(^{1}\)</span></th>
<th align="center"><code>$parameters</code><span class="math inline">\(^{2}\)</span></th>
<th align="center"><code>$chains</code><span class="math inline">\(^{2}\)</span></th>
<th align="left">dimensions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\mathbf{B}^3_{Q \times S}\)</span></td>
<td align="center"><code>beta</code></td>
<td align="center"><code>betaMu</code></td>
<td align="center"><code>bgibbs</code></td>
<td align="left"><span class="math inline">\(W\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\mathbf{B}^3_{u, Q \times S}\)</span></td>
<td align="center">-</td>
<td align="center"><code>betaMuUn</code></td>
<td align="center"><code>bgibbsUn</code></td>
<td align="left"><span class="math inline">\(W/X\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\tilde{\mathbf{B}}^3_{Q_1 \times S}\)</span></td>
<td align="center">-</td>
<td align="center"><code>fBetaMu</code></td>
<td align="center"><code>fbgibbs</code></td>
<td align="left">dimensionless</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\boldsymbol{\Sigma}_{S \times S}\)</span></td>
<td align="center"><code>sigma</code></td>
<td align="center"><code>sigMu</code></td>
<td align="center"><code>sgibbs</code></td>
<td align="left"><span class="math inline">\(W_{s}W_{s'}\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\mathbf{R}_{S \times S}\)</span></td>
<td align="center"><code>corSpec</code></td>
<td align="center"><code>corMu</code></td>
<td align="center"></td>
<td align="left">correlation</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\mathbf{f}_{Q_1}^4\)</span></td>
<td align="center">-</td>
<td align="center"><code>fMu</code></td>
<td align="center"><code>fgibbs</code></td>
<td align="left">dimensionless</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\mathbf{F}_{Q_1 \times Q_1}^4\)</span></td>
<td align="center">-</td>
<td align="center"><code>fmatrix</code></td>
<td align="center"></td>
<td align="left">dimensionless</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\mathbf{E}_{S \times S}\)</span></td>
<td align="center">-</td>
<td align="center"><code>ematrix</code></td>
<td align="center">-</td>
<td align="left">dimensionless</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\mathcal{P}^5\)</span></td>
<td align="center"><code>cuts</code></td>
<td align="center"><code>cutMu</code></td>
<td align="center"><code>cgibbs</code></td>
<td align="left">correlation</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(K^6\)</span></td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center"><code>kgibbs</code></td>
<td align="left">dimensionless</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\sigma^2\)</span> <span class="math inline">\(^6\)</span></td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center"><code>sigErrGibbs</code></td>
<td align="left"><span class="math inline">\(W^2\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\boldsymbol{\alpha}_{Q \times M}^7\)</span></td>
<td align="center">-</td>
<td align="center"><code>betaTraitMu</code></td>
<td align="center"><code>agibbs</code></td>
<td align="left"><span class="math inline">\(W/X\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\boldsymbol{\Omega}_{M \times M}^7\)</span></td>
<td align="center">-</td>
<td align="center"><code>sigmaTraitMu</code></td>
<td align="center"><code>mgibbs</code></td>
<td align="left"><span class="math inline">\(W_{m}U_{m'}\)</span> <span class="math inline">\(^8\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(^1\)</span> simulated object from <code>gjamSimData</code>.</p>
<p><span class="math inline">\(^2\)</span> fitted object from <code>gjam</code>.</p>
<p><span class="math inline">\(^3\)</span> coefficients are <span class="math inline">\((\mathbf{B}_u)\)</span>: unstandardized; <span class="math inline">\((\mathbf{B})\)</span>: standardized for <span class="math inline">\(\mathbf{X}\)</span>; <span class="math inline">\(\tilde{\mathbf{B}}\)</span>: standardized for <span class="math inline">\(\mathbf{X}\)</span>, correlation scale for <span class="math inline">\(\mathbf{Y}\)</span> and factor levels relative to the mean for each factor (see section <em><span style="color:teal">factors in <span class="math inline">\(\mathbf{X}\)</span></em></span>**).</p>
<p><span class="math inline">\(^4\)</span> sensitivities based on unstandardized <span class="math inline">\(\mathbf{B}\)</span> and covariance scales <span class="math inline">\(\Sigma\)</span>.</p>
<p><span class="math inline">\(^5\)</span> Only when <code>ydata</code> includes ordinal types <code>&quot;OC&quot;</code>.</p>
<p><span class="math inline">\(^6\)</span> Only with dimension reduction, <code>reductList</code> is included in <code>modelList</code>.</p>
<p><span class="math inline">\(^7\)</span> Only for trait analysis, <code>traitList</code> is included in <code>modelList</code> (Trait vignette).</p>
<p><br></p>
<p>The dimension for response <span class="math inline">\(Y\)</span> is <span class="math inline">\(W \times E\)</span>, where <span class="math inline">\(W\)</span> is the latent variable scale, and <span class="math inline">\(E\)</span> is sample effort. When effort <span class="math inline">\(E\)</span> = 1, then <span class="math inline">\(Y\)</span> and <span class="math inline">\(W\)</span> have the same dimension.</p>
<p>The matrix <span class="math inline">\(\mathbf{F}\)</span> contains the covariance between predictors in <span class="math inline">\(\mathbf{X}\)</span> in terms of the responses they elicit from <span class="math inline">\(\mathbf{Y}\)</span>. The diagonal vector <span class="math inline">\(\mathbf{f} = diag( \mathbf{F} )\)</span> is the sensitivity of the entire response matrix to each predictor in <span class="math inline">\(\mathbf{X}\)</span>.</p>
<p>The matrix <span class="math inline">\(\mathbf{E}\)</span> is the correlation among species in terms of their responses to <span class="math inline">\(\mathbf{X}\)</span>. Relationships to outputs are discussed in the <strong>Reference notes</strong>.</p>
<p>Simulated data are typical of real data in that there is a large fraction of zeros.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">bty =</span> <span class="st">'n'</span>, <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">family=</span><span class="st">''</span>)
h &lt;-<span class="st"> </span><span class="kw">hist</span>(<span class="kw">c</span>(-<span class="dv">1</span>,f$y),<span class="dt">nclass =</span> <span class="dv">50</span>,<span class="dt">plot =</span> F)
<span class="kw">plot</span>(h$counts,h$mids,<span class="dt">type =</span> <span class="st">'s'</span>)
<span class="kw">plot</span>(f$w,f$y,<span class="dt">cex =</span> .<span class="dv">2</span>)</code></pre></div>
<p><br></p>
<p>Here is a short Gibbs sampler to estimate parameters and fit the data. The function <code>gjam</code> needs the <code>formula</code> for the model, the <code>data.frame xdata</code>, which includes the predictors, the response <code>matrix</code> or <code>data.frame ydata</code>, and a <code>modelList</code> specifying number of Gibbs steps <code>ng</code>, the <code>burnin</code>, and <code>typeNames</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">1000</span>, <span class="dt">burnin =</span> <span class="dv">100</span>, <span class="dt">typeNames =</span> f$typeNames)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)
<span class="kw">summary</span>(out)</code></pre></div>
<p>The <code>print</code> function will print a summary in an different format</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(out)</code></pre></div>
<p>Among the objects to consider initially are the design matrix <code>out$inputs$x</code>, response matrix <code>out$inputs$y</code>, and the MCMC <code>out$chains</code> with these names and sizes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(out$chains)</code></pre></div>
<p><code>$chains</code> is a list of matrices, each with <code>ng</code> rows and as many columns as needed to hold parameter estimates. For example, each row of <code>$chains$bgibbs</code> is a length-<span class="math inline">\(QS\)</span> vector of values for the <span class="math inline">\(Q \times S\)</span> matrix <span class="math inline">\(\mathbf{B}\)</span>, standardized for <span class="math inline">\(\mathbf{X}\)</span>. In other words, a coefficient <span class="math inline">\(\mathbf{B}_{qs}\)</span> has the units of <span class="math inline">\(w_s\)</span>. <code>$chains$sgibbs</code> holds either the <span class="math inline">\(S(S + 1)/2\)</span> unique values of <span class="math inline">\(\boldsymbol{\Sigma}\)</span> or the <span class="math inline">\(N \times r\)</span> unique values of the dimension reduced covariance matrix. A summary of the <code>chains</code> is given in Table 2.</p>
<p>Additional summaries are available in the list <code>inputs</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(out$inputs)</code></pre></div>
<p>The matrix <code>classBySpec</code> shows the number of observations in each interval. For this example of continuous data censored at zero, the two labels are <span class="math inline">\(k \in \{0, 1\}\)</span> corresponding to the intervals <span class="math inline">\((p_{s,0}, p_{s,1}] = (-\infty,0]\)</span> and <span class="math inline">\((p_{s,1}, p_{s,2}) = (0, \infty)\)</span>. The length-<span class="math inline">\((K + 1)\)</span> partition vector is the same for all species, <span class="math inline">\(\mathbf{p} = (-\infty, 0, \infty)\)</span>. Here is <code>classBySpec</code> for this example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out$inputs$classBySpec</code></pre></div>
<p>The first interval is censored (all values of <span class="math inline">\(y_{is}\)</span> = 0). The second interval is not censored (<span class="math inline">\(y_{is} = w_{is}\)</span>).</p>
<p>The fitted coefficients in <code>$parameters</code>, as summarized in Table 2. For example, here is posterior mean estimate of unstandardized coefficients <span class="math inline">\(\mathbf{B}_u\)</span>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">signif</span>( out$parameters$betaMuUn, <span class="dv">3</span> )</code></pre></div>
<p>The <code>Un</code> in the name <code>betaMuUn</code> indicates that it is on the unstandardized units, <span class="math inline">\(W/X\)</span>, where <span class="math inline">\(X\)</span> has the units supplied by the user in <code>xdata</code>. Here are the standard errors,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">signif</span>( out$parameters$betaSeUn, <span class="dv">3</span> )</code></pre></div>
<p>Again, check Table 2 for names of all fitted coefficients.</p>
<p>The data are also predicted in <code>gjam</code>, summarized by predictive means and standard errors. These are contained in <span class="math inline">\(n \times Q\)</span> matrices <code>$prediction$xpredMu</code> and <code>$prediction$xpredSd</code> and <span class="math inline">\(n \times S\)</span> matrices <code>$prediction$ypredMu</code> and <code>$prediction$ypredSd</code>. These are in-sample predictions.</p>
<p>The output can be viewed with the function <code>gjamPlot</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f   &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">S =</span> <span class="dv">10</span>, <span class="dt">typeNames =</span> <span class="st">'CA'</span>)
ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">1000</span>, <span class="dt">burnin =</span> <span class="dv">200</span>, <span class="dt">typeNames =</span> f$typeNames)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)
pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">trueValues =</span> f$trueValues, <span class="dt">GRIDPLOTS =</span> T, <span class="dt">SMALLPLOTS =</span> F)
<span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)</code></pre></div>
<p><code>gjamPlot</code> creates a number of plots comparing true and estimated parameters (for simulated data).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">bty =</span> <span class="st">'n'</span>, <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">family=</span><span class="st">''</span>)
<span class="kw">plot</span>(f$trueValues$beta, out$parameters$betaMu, <span class="dt">cex =</span> .<span class="dv">2</span>)
<span class="kw">plot</span>(f$trueValues$corSpec, out$parameters$corMu, <span class="dt">cex =</span> .<span class="dv">2</span>)
<span class="kw">plot</span>(f$y,out$prediction$ypredMu, <span class="dt">cex =</span> .<span class="dv">2</span>)</code></pre></div>
<p>To process the output beyond what is provided in <code>gjamPlot</code> I can work directly with the <code>chains</code>.</p>
</div>
<div id="my-data" class="section level2">
<h2><span style="color:teal">my data</span></h2>
<p><code>gjam</code> uses the standard <code>R</code> syntax in the <code>formula</code> that I would use with functions like <code>lm</code> and <code>glm</code>. Because <code>gjam</code> uses inverse prediction to summarize large multivariate output, it is important to abide by this syntax. For example, to analyze a model with quadratic and interaction terms, I might simply construct my own design matrix with these columns included, i.e., side-stepping the standard syntax for these effects that can be specified in <code>formula</code>. This would be fine for model fitting. However, without specifying this in the <code>formula</code> there is no way for <code>gjam</code> to know that these columns are in fact non-linear transformations of other columns. Without this knowledge there is no way to properly predict them. The prediction that <code>gjam</code> would return would include silly variable combinations.</p>
<p>To illustrate proper model specification I use a few lines from the <code>data.frame</code> of predictors in the <code>forestTraits</code> data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(repmis)
d &lt;-<span class="st"> &quot;https://github.com/jimclarkatduke/gjam/blob/master/forestTraits.RData?raw=True&quot;</span>
<span class="kw">source_data</span>(d)
xdata &lt;-<span class="st"> </span>forestTraits$xdata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">8</span>)]</code></pre></div>
<p>Here are a few rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xdata[<span class="dv">1</span>:<span class="dv">5</span>,]</code></pre></div>
<p>Here is a simple model specification with <code>as.formula()</code> that includes only main effects:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">formula &lt;-<span class="st"> </span><span class="kw">as.formula</span>( ~<span class="st"> </span>temp +<span class="st"> </span>deficit +<span class="st"> </span>soil )</code></pre></div>
<p>The design matrix <code>x</code> that is generated in <code>gjam</code> has an intercept, two covariates, and four columns for the multilevel factor <code>soil</code>:</p>
<pre><code>##   (Intercept)  temp deficit soilSpodHist soilEntVert soilMol soilUltKan
## 1           1  1.22    0.04            1           0       0          0
## 2           1  0.18    0.21            1           0       0          0
## 3           1 -0.94    0.20            0           0       0          0
## 4           1  0.64    0.82            1           0       0          0
## 5           1  0.82   -0.18            1           0       0          0</code></pre>
<p>To include interactions between <code>temp</code> and <code>soil</code> I use the symbol ‘<code>*</code>’:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">formula &lt;-<span class="st"> </span><span class="kw">as.formula</span>( ~<span class="st"> </span>temp*soil )</code></pre></div>
<p>Here is the design matrix that results from this <code>formula</code> with interaction terms indicated by the symbol <code>':'</code></p>
<pre><code>##   (Intercept)  temp soilSpodHist soilEntVert soilMol soilUltKan
## 1           1  1.22            1           0       0          0
## 2           1  0.18            1           0       0          0
## 3           1 -0.94            0           0       0          0
## 4           1  0.64            1           0       0          0
## 5           1  0.82            1           0       0          0
##   temp:soilSpodHist temp:soilEntVert temp:soilMol temp:soilUltKan
## 1              1.22                0            0               0
## 2              0.18                0            0               0
## 3              0.00                0            0               0
## 4              0.64                0            0               0
## 5              0.82                0            0               0</code></pre>
<p>For a quadratic term I use the <code>R</code> function <code>I()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">formula &lt;-<span class="st"> </span><span class="kw">as.formula</span>( ~<span class="st"> </span>temp +<span class="st"> </span><span class="kw">I</span>(temp^<span class="dv">2</span>) +<span class="st"> </span>deficit )</code></pre></div>
<p>Here is the design matrix with linear and quadratic terms:</p>
<pre><code>##   (Intercept)  temp I(temp^2) deficit
## 1           1  1.22    1.4884    0.04
## 2           1  0.18    0.0324    0.21
## 3           1 -0.94    0.8836    0.20
## 4           1  0.64    0.4096    0.82
## 5           1  0.82    0.6724   -0.18</code></pre>
<p>Here is a quadratic response surface for <code>temp</code> and <code>deficit</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">formula &lt;-<span class="st"> </span><span class="kw">as.formula</span>( ~<span class="st"> </span>temp*deficit +<span class="st"> </span><span class="kw">I</span>(temp^<span class="dv">2</span>) +<span class="st"> </span><span class="kw">I</span>(deficit^<span class="dv">2</span>) )</code></pre></div>
<p>Here is the design matrix with all combinations:</p>
<pre><code>##   (Intercept)  temp deficit I(temp^2) I(deficit^2) temp:deficit
## 1           1  1.22    0.04    1.4884       0.0016       0.0488
## 2           1  0.18    0.21    0.0324       0.0441       0.0378
## 3           1 -0.94    0.20    0.8836       0.0400      -0.1880
## 4           1  0.64    0.82    0.4096       0.6724       0.5248
## 5           1  0.82   -0.18    0.6724       0.0324      -0.1476</code></pre>
<p>These are examples of the <code>formula</code> options available in <code>gjam</code>. Using them will allow for proper inverse prediction of <code>x</code>. To optimize MCMC, gjam does not predict <code>x</code> for higher order polynomials–they are rarely used, being both hard to interpret and a cause of unstable predictions. To accelerate MCMC I can set <code>PREDICTX = F</code> in the <code>modelList</code>.</p>
<p>I can use this model to analyze a tree data set. For my data set I use the tree data contained in <code>forestTraits</code>. It is stored in de-zeroed (sparse matrix) format, so I extract it with the function <code>gjamReZero</code>. Here are dimensions and the upper left corner of the response matrix <span class="math inline">\(\mathbf{Y}\)</span>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y  &lt;-<span class="st"> </span><span class="kw">gjamReZero</span>(forestTraits$treesDeZero)  <span class="co"># extract y</span>
treeYdata  &lt;-<span class="st"> </span><span class="kw">gjamTrimY</span>(y,<span class="dv">10</span>)$y                 <span class="co"># at least 10 plots</span>
<span class="kw">dim</span>(treeYdata)
treeYdata[<span class="dv">1</span>:<span class="dv">5</span>,<span class="dv">1</span>:<span class="dv">6</span>]</code></pre></div>
<p>In code that follows I treat responses as discrete counts, <code>typeNames = 'DA'</code>. Because of the large number of columns (98) I speed things up calling for dimension reduction, passed as <span class="math inline">\(N \times r = 20 \times 8\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rl   &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">r =</span> <span class="dv">8</span>, <span class="dt">N =</span> <span class="dv">20</span>)
ml   &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2500</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> <span class="st">'DA'</span>, <span class="dt">reductList =</span> rl)
form &lt;-<span class="st"> </span><span class="kw">as.formula</span>( ~<span class="st"> </span>temp*deficit +<span class="st"> </span><span class="kw">I</span>(temp^<span class="dv">2</span>) +<span class="st"> </span><span class="kw">I</span>(deficit^<span class="dv">2</span>) )
out  &lt;-<span class="st"> </span><span class="kw">gjam</span>(form, <span class="dt">xdata =</span> xdata, <span class="dt">ydata =</span> treeYdata, <span class="dt">modelList =</span> ml)
specNames &lt;-<span class="st"> </span><span class="kw">colnames</span>(treeYdata)
specColor &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">'black'</span>,<span class="kw">ncol</span>(treeYdata))
specColor[ <span class="kw">c</span>(<span class="kw">grep</span>(<span class="st">'quer'</span>,specNames),<span class="kw">grep</span>(<span class="st">'cary'</span>,specNames)) ] &lt;-<span class="st"> 'brown'</span>
specColor[ <span class="kw">c</span>(<span class="kw">grep</span>(<span class="st">'acer'</span>,specNames),<span class="kw">grep</span>(<span class="st">'frax'</span>,specNames)) ] &lt;-<span class="st"> 'darkgreen'</span>
specColor[ <span class="kw">c</span>(<span class="kw">grep</span>(<span class="st">'abie'</span>,specNames),<span class="kw">grep</span>(<span class="st">'pice'</span>,specNames)) ] &lt;-<span class="st"> 'blue'</span>

pl   &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">SMALLPLOTS =</span> F, <span class="dt">GRIDPLOTS=</span>T, <span class="dt">specColor =</span> specColor)
<span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)</code></pre></div>
<p>Additional information on variable types and their treatment in <code>gjam</code> is included later in this document and in the other <code>gjam vignettes</code>.</p>
<p><br></p>
</div>
</div>
<div id="plotting-output" class="section level1">
<h1><span style="color:darkgreen">plotting output</span></h1>
<p>In the foregoing example arguments passed to <code>gjamPlot</code> in the <code>list plotPars</code> included <code>SMALLPLOTS = F</code> (do not compress margins and axes), <code>GRIDPLOTS = T</code> (draw grid diagrams as heat maps for parameter values and predictions). In this section I summarize plots generated by <code>gjamPlot</code>.</p>
<p>By default, plots are rendered to the screen. I enter ‘return’ to render the next plot. Faster execution obtains if I write plots directly to pdf files, with <code>SAVEPLOTS = T</code>. I can specify a folder this way:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotPars &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">SMALLPLOTS =</span> F, <span class="dt">GRIDPLOTS=</span>T, <span class="dt">SAVEPLOTS =</span> T, <span class="dt">outfolder =</span> <span class="st">'plots'</span>)</code></pre></div>
<p>In all plots, posterior distributions and predictions are shown as <span class="math inline">\(68\%\)</span> (boxes) and <span class="math inline">\(95\%\)</span> (whiskers) intervals, respectively. Here are the plots in alphabetical order by file name:</p>
<table>
<colgroup>
<col width="18%"></col>
<col width="81%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="right">Name</th>
<th align="left">Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><code>betaAll</code></td>
<td align="left">Posterior <span class="math inline">\(\mathbf{B}\)</span></td>
</tr>
<tr class="even">
<td align="right"><code>beta_(variable)</code></td>
<td align="left">Posterior distributions, one file per variable</td>
</tr>
<tr class="odd">
<td align="right"><code>betaChains</code></td>
<td align="left">Example MCMC chains for <span class="math inline">\(\mathbf{B}\)</span> (has it converged?)</td>
</tr>
<tr class="even">
<td align="right"><code>clusterDataE</code></td>
<td align="left">Cluster analysis of raw data and <span class="math inline">\(\textbf{E}\)</span> matrix</td>
</tr>
<tr class="odd">
<td align="right"><code>clusterGridB</code></td>
<td align="left">Cluster and grid plot of <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span></td>
</tr>
<tr class="even">
<td align="right"><code>clusterGridE</code></td>
<td align="left">Cluster and grid plot of <span class="math inline">\(\mathbf{E}\)</span></td>
</tr>
<tr class="odd">
<td align="right"><code>clusterGridR</code></td>
<td align="left">Cluster and grid plot of <span class="math inline">\(\mathbf{R}\)</span></td>
</tr>
<tr class="even">
<td align="right"><code>corChains</code></td>
<td align="left">Example MCMC chains for <span class="math inline">\(\textbf{R}\)</span></td>
</tr>
<tr class="odd">
<td align="right"><code>dimRed</code></td>
<td align="left">Dimension reduction (see <code>vignette</code>) for <span class="math inline">\(\Sigma\)</span> matrix</td>
</tr>
<tr class="even">
<td align="right"><code>gridF_B</code></td>
<td align="left">Grid plot of sensitivity <span class="math inline">\(\mathbf{F}\)</span> and <span class="math inline">\(\mathbf{B}\)</span>, ordered by clustering <span class="math inline">\(\mathbf{F}\)</span></td>
</tr>
<tr class="odd">
<td align="right"><code>gridR_E</code></td>
<td align="left">Grid plot of <span class="math inline">\(\mathbf{R}\)</span> and <span class="math inline">\(\mathbf{E}\)</span> ordered by clustering <span class="math inline">\(\mathbf{R}\)</span></td>
</tr>
<tr class="even">
<td align="right"><code>gridR</code></td>
<td align="left">Grid plot of <span class="math inline">\(\mathbf{R}\)</span>, ordered by cluster analysis.</td>
</tr>
<tr class="odd">
<td align="right"><code>gridY_E</code></td>
<td align="left">Grid plot of correlation for data <span class="math inline">\(\mathbf{Y}\)</span> and <span class="math inline">\(\mathbf{E}\)</span>, ordered by clustering cor(<span class="math inline">\(\mathbf{Y}\)</span>)</td>
</tr>
<tr class="even">
<td align="right"><code>gridTraitB</code></td>
<td align="left">If traits are predicted, see <code>gjam vignette</code> on traits.</td>
</tr>
<tr class="odd">
<td align="right"><code>ordination</code></td>
<td align="left">PCA of <span class="math inline">\(\mathbf{E}\)</span> matrix, including eigenvalues (cumulative)</td>
</tr>
<tr class="even">
<td align="right"><code>partition</code></td>
<td align="left">If ordinal responses, posterior distribution of <span class="math inline">\(\mathcal{P}\)</span></td>
</tr>
<tr class="odd">
<td align="right"><code>richness</code></td>
<td align="left">Predictive distribution with distribution of data (histogram)</td>
</tr>
<tr class="even">
<td align="right"><code>sensitivity</code></td>
<td align="left">Overall sensitivity <span class="math inline">\(\textbf{f}\)</span> by predictor</td>
</tr>
<tr class="odd">
<td align="right"><code>traits</code></td>
<td align="left">If traits are predicted, see <code>gjam vignette</code> on traits.</td>
</tr>
<tr class="even">
<td align="right"><code>traitPred</code></td>
<td align="left">If traits are predicted, see <code>gjam vignette</code> on traits.</td>
</tr>
<tr class="odd">
<td align="right"><code>trueVsPars</code></td>
<td align="left">If simulated data and <code>trueValues</code> included in <code>plotPars</code></td>
</tr>
<tr class="even">
<td align="right"><code>xPred</code></td>
<td align="left">Inverse predictive distribution of of <span class="math inline">\(\mathbf{X}\)</span></td>
</tr>
<tr class="odd">
<td align="right"><code>xPredFactors</code></td>
<td align="left">Inverse predictive distribution of factor levels</td>
</tr>
<tr class="even">
<td align="right"><code>yPred</code></td>
<td align="left">Predicted <span class="math inline">\(\mathbf{Y}\)</span>, in-sample (blue bars), out-of-sample (dots), and distribution of data (histogram)</td>
</tr>
<tr class="odd">
<td align="right"><code>yPredAll</code></td>
<td align="left">If <code>PLOTALLY</code> all response predictions shown</td>
</tr>
</tbody>
</table>
<p>If the <code>plotPars</code> list passed to <code>gjamPlot</code> specifies <code>GRIDPLOTS = T</code>, then grid and cluster plots are generated as gridded values for <span class="math inline">\(\mathbf{B}\)</span>, <span class="math inline">\(\boldsymbol{\Sigma}\)</span> and <span class="math inline">\(\mathbf{R}\)</span>. Gridplots of matrix <span class="math inline">\(\mathbf{R}\)</span> show conditional and marginal dependence in white and grey. In plots of <span class="math inline">\(\mathbf{E}\)</span> marginal independence is shown in grey, but conditional independence is not shown, as the matrix does not have an inverse (Clark et al. 2017).</p>
<p>The sensitivity matrix <span class="math inline">\(\mathbf{F}\)</span> is shown together in a plot with individual species responses <span class="math inline">\(\mathbf{B}\)</span>.</p>
<p>The plot in which the model residual correlation <span class="math inline">\(\mathbf{R}\)</span> and the response correlation <span class="math inline">\(\mathbf{B}\)</span> are compared are ordered by their similiarity in the <span class="math inline">\(\mathbf{R}\)</span>. If the two contain similar structure, then it will be evident in this comparison. There is no reason to expect them to be similar.</p>
<p>For large <span class="math inline">\(S\)</span> the labels are not shown on the graphs, they would be too small. The order of species and the cluster groups to which they belong are returned in <code>fit$clusterOrder</code> and <code>fit$clusterIndex</code>.</p>
<p><br></p>
</div>
<div id="flexibility-in-gjam" class="section level1">
<h1><span style="color:darkgreen">flexibility in gjam</span></h1>
<div id="heterogeneous-effort" class="section level2">
<h2><span style="color:teal">heterogeneous effort</span></h2>
<p>Here is an example with discrete abundance data, now with heterogeneous sample effort. Heterogeneous effort applies where vegetation plots have different areas, animal survey data have variable search times, or catch returns from fishing vessels have different gear and/or trawling times. Here I simulate a list containing the columns and the effort that applies to those columns, shown for 50 observations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S  &lt;-<span class="st"> </span><span class="dv">5</span>                             
n  &lt;-<span class="st"> </span><span class="dv">50</span>
ef &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">columns =</span> <span class="dv">1</span>:S, <span class="dt">values =</span> <span class="kw">round</span>(<span class="kw">runif</span>(n,.<span class="dv">5</span>,<span class="dv">5</span>),<span class="dv">1</span>) )
f  &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(n, S, <span class="dt">typeNames =</span> <span class="st">'DA'</span>, <span class="dt">effort =</span> ef)
ef</code></pre></div>
<p>If <code>ef$values</code> consists of a length-n <code>vector</code>, then gjam assumes each value applies to all columns in the corresponding row specified in the <code>vector ef$columns</code>. This is the case shown above and would apply when effort is plot area, search time, sample volume, and so forth. Alternatively, <code>values</code> can be supplied as a <code>matrix</code>, having the same dimensions as <code>ydata</code>. As a <code>matrix</code>, <code>ef$values</code> can have elements that differ by observation and species. For example, camera trap data detect large animals at greater distances than small animals (column differences), and each camera can be deployed for different lengths of time (row differences). For simulation purposes <code>gjamSimData</code> only accepts a <code>vector</code>. However, for fitting with <code>gjam</code> <code>effort$values</code> can be supplied as a <code>matrix</code> with as many columns as are listed in <code>effort$columns</code>.</p>
<p>Because observations are discrete the continuous latent variables <span class="math inline">\(w_{is}\)</span> are censored. Unlike the previous continuous example, observations <span class="math inline">\(y_{is}\)</span> now assume only discrete values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(f$w,f$y, <span class="dt">cex =</span> .<span class="dv">2</span>)</code></pre></div>
<p>The large scatter reflects the variable effort represented by each observation. Incorporating the effort scale gives this plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(f$w*ef$values, f$y, <span class="dt">cex =</span> .<span class="dv">2</span>)</code></pre></div>
<p>The heterogeneous effort affects the weight of each observation in model fitting. The <code>effort</code> is entered in <code>modelList</code>. Increase the number of iterations and look at plots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S   &lt;-<span class="st"> </span><span class="dv">10</span>                             
n   &lt;-<span class="st"> </span><span class="dv">1500</span>
ef  &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">columns =</span> <span class="dv">1</span>:S, <span class="dt">values =</span> <span class="kw">round</span>(<span class="kw">runif</span>(n,.<span class="dv">5</span>,<span class="dv">5</span>),<span class="dv">1</span>) )
f   &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(n, S, <span class="dt">typeNames =</span> <span class="st">'DA'</span>, <span class="dt">effort =</span> ef)
ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">1000</span>, <span class="dt">burnin =</span> <span class="dv">250</span>, <span class="dt">typeNames =</span> f$typeNames, <span class="dt">effort =</span> ef)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)
pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">trueValues =</span> f$trueValues, <span class="dt">SMALLPLOTS=</span>F)
<span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)</code></pre></div>
<p>Use <code>summary(out)</code> to see a summary of effort.</p>
</div>
<div id="specifying-censored-intervals" class="section level2">
<h2><span style="color:teal">specifying censored intervals</span></h2>
<p>To analyze data that are censored at specific intervals, I specify the censored values and the intervals to which those values apply. In the help page for <code>gjamCensorY</code> I discuss a <code>vector</code> of <code>values</code> and a corresponding <code>matrix</code> of upper and lower bounds in two rows and one column for each element in <code>values</code>. For example, if an observer stops counting wildebeest or sea lions at, say, 100 animals, I can set this as a censored interval:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># assumes there is a data matrix ydata</span>
upper &lt;-<span class="st"> </span><span class="dv">100</span>
intv  &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(upper,<span class="ot">Inf</span>),<span class="dv">2</span>)
<span class="kw">rownames</span>(intv) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'lower'</span>,<span class="st">'upper'</span>)
tmp &lt;-<span class="st"> </span><span class="kw">gjamCensorY</span>(<span class="dt">values =</span> upper, <span class="dt">intervals =</span> intv, <span class="dt">y =</span> ydata, <span class="dt">type=</span><span class="st">'DA'</span>)</code></pre></div>
<p>There are two objects returned by <code>gjamCensor</code>. The <code>list $censor</code> holds two lists, the <code>$columns</code>, indicating which columns in <code>$y</code> are censored, and the <code>$partition</code>, giving the values and bounds for the partition. Because I did not specify <code>whichcol</code> in my call to <code>gjamCensorY</code>, censoring defaults to all columns in <code>ydata</code>. The object <code>$y</code> matches the mode and dimensions of the input <code>y</code> (a <code>matrix</code> or <code>data.frame</code>). This new version of the response matrix replaces any values in <code>ydata</code> that fall within a censored interval with the censored <code>value</code>. This feature is useful when observers are inconsistent on the assignment of intervals or where an analyst distrusts the precision reported in data. For example, if counts range to thousands, but it is known that counts beyond 100 are inaccurate, then all counts above 100 are censored and, thus, uncertain.</p>
<p>Censoring can be applied differently to each response variable. For example, chemical constitents reported as concentrations in a sample, sometimes reach non-zero minimum values, taken as detection limits for that instrument and that constituent (detection limits can differ for each constituent). In this case, there is a <code>list</code> for each column in <code>ydata</code>. I can generate this <code>list</code> with a loop, where the censored interval for each column <code>j</code> spans from <code>-Inf</code> to <code>min(ydata[,j])</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># assumes there is a data matrix ydata</span>
miny   &lt;-<span class="st"> </span><span class="kw">apply</span>(ydata, <span class="dv">2</span>, min, <span class="dt">na.rm=</span>T)     <span class="co">#minimum value by column</span>
censor &lt;-<span class="st">  </span><span class="kw">numeric</span>(<span class="dv">0</span>)     
p      &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;values&quot;</span>,<span class="st">&quot;lower&quot;</span>,<span class="st">&quot;upper&quot;</span>), <span class="ot">NULL</span>))

for(j in <span class="dv">1</span>:<span class="kw">ncol</span>(ydata)){
  p[<span class="dv">1</span>:<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(miny[j], -<span class="ot">Inf</span>, miny[j])
  jlist  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;columns&quot;</span> =<span class="st"> </span>j, <span class="st">&quot;partition&quot;</span> =<span class="st"> </span>p)
  censor &lt;-<span class="st"> </span><span class="kw">c</span>(censor, <span class="kw">list</span>(jlist))
  <span class="kw">names</span>(censor)[j] &lt;-<span class="st"> 'CA'</span>
}</code></pre></div>
<p>This <code>list censor</code> can be passed directly to <code>gjam</code> in the <code>list modelList</code>.</p>
</div>
<div id="prior-distribution-on-coefficients" class="section level2">
<h2><span style="color:teal">prior distribution on coefficients</span></h2>
<p>Informative prior distributions in regression models are rare, perhaps partly because it is hard to assign both magnitude (e.g., large or small prior mean value) and weight (large or small prior variance) without obscuring the relative contributions of prior and data. Prior distributions for regression coefficients are typically Gaussian, having support on <span class="math inline">\((-\infty, \infty)\)</span>. In many cases, the sign of the effect is known, but the magnitude is not. Ad hoc experimentation with prior mean and variance can, at best, only insure that ‘most’ of the posterior distribution is positive or negative. Yet, it can be important to use prior information, especially in the multivariate setting, where covariances between responses can result in estimates where the sign of a coefficient effect makes no sense.</p>
<p>The knowledge of the ‘direction’ of the effect can be readily implmented with uniform priors truncated at zero, having the advantage that the posterior distribution that preserves the shape of the likelihood, but is restricted to positive or negative values (Clark et al. 2013).</p>
<p>The prior distribution for <span class="math inline">\(\mathbf{B}\)</span> is either non-informative (if unspecified) or truncated by limits provided in the <code>list betaPrior</code>. The <code>betaPrior list</code> contains the two matrices <code>lo</code> and <code>hi</code>. The rows of these matrices have <code>rownames</code> that match explanatory variables in the <code>formula</code> and <code>colnames</code> in <code>xdata</code>. In the example that follows I fit a model for FIA data to winter temperature <code>temp</code>, climatic <code>deficit</code>, and their interaction. For this example, I use a prior distribution having positive effects of warm winters and negative effects of climate deficit. This prior is set up with the function <code>gjamPriorTemplate</code>.</p>
<p>The prior distribution is also the place to exclude specific predictor/response combinations, by setting them equal to <code>NA</code> in <code>lo</code> or <code>hi</code>. Here is an example of informative priors on some coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xdata   &lt;-<span class="st"> </span>forestTraits$xdata
formula &lt;-<span class="st"> </span><span class="kw">as.formula</span>(~<span class="st"> </span>temp*deficit)
snames  &lt;-<span class="st"> </span><span class="kw">colnames</span>(treeYdata)

<span class="co"># warm winter</span>
hot &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;liquStyr&quot;</span>,<span class="st">&quot;liriTuli&quot;</span>,<span class="st">&quot;pinuEchi&quot;</span>,<span class="st">&quot;pinuElli&quot;</span>,<span class="st">&quot;pinuPalu&quot;</span>,<span class="st">&quot;pinuTaed&quot;</span>,
         <span class="st">&quot;querImbr&quot;</span>,<span class="st">&quot;querLaur&quot;</span>,<span class="st">&quot;querLyra&quot;</span>,<span class="st">&quot;querMich&quot;</span>,<span class="st">&quot;querMueh&quot;</span>,<span class="st">&quot;querNigr&quot;</span>,
         <span class="st">&quot;querPhel&quot;</span>,<span class="st">&quot;querVirg&quot;</span>)  <span class="co"># arbitrary spp, positive winter temp</span>
nh &lt;-<span class="st"> </span><span class="kw">length</span>(hot)
lo  &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">'list'</span>, nh)
<span class="kw">names</span>(lo) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">'temp'</span>,hot,<span class="dt">sep=</span><span class="st">'_'</span>)
for(j in <span class="dv">1</span>:nh)lo[[j]] &lt;-<span class="st"> </span><span class="dv">0</span>

<span class="co"># humid climate (negative deficit)</span>
humid &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;abieBals&quot;</span>, <span class="st">&quot;betuAlle&quot;</span>, <span class="st">&quot;querNigr&quot;</span>, <span class="st">&quot;querPhel&quot;</span>)  <span class="co">#again, arbitrary</span>
nh &lt;-<span class="st"> </span><span class="kw">length</span>(humid)
hi  &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">'list'</span>, nh)
<span class="kw">names</span>(hi) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">'deficit'</span>,humid,<span class="dt">sep=</span><span class="st">'_'</span>)
for(j in <span class="dv">1</span>:nh)hi[[j]] &lt;-<span class="st"> </span><span class="dv">0</span>
                      
bp &lt;-<span class="st"> </span><span class="kw">gjamPriorTemplate</span>(formula, xdata, <span class="dt">ydata =</span> treeYdata, <span class="dt">lo =</span> lo, <span class="dt">hi=</span>hi)
rl &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">N =</span> <span class="dv">10</span>, <span class="dt">r =</span> <span class="dv">5</span>) 
ml &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng=</span><span class="dv">1000</span>, <span class="dt">burnin=</span><span class="dv">200</span>, <span class="dt">typeNames =</span> <span class="st">'CA'</span>, <span class="dt">betaPrior =</span> bp, <span class="dt">reductList=</span>rl)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(formula, xdata, <span class="dt">ydata =</span> treeYdata, <span class="dt">modelList =</span> ml)

sc  &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">'grey'</span>,<span class="kw">ncol</span>(treeYdata))
sc[snames %in%<span class="st"> </span>hot] &lt;-<span class="st"> 'orange'</span>      <span class="co"># highlight informative priors</span>
sc[snames %in%<span class="st"> </span>humid] &lt;-<span class="st"> 'blue'</span>
pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">SMALLPLOTS=</span>F, <span class="dt">specColor=</span>sc)
<span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)</code></pre></div>
<p>The combination of <code>lo</code> and <code>hi</code> set the limits for posterior draws from the truncated multivariate normal distribution. The <code>help</code> page for <code>gjamPriorTemplate</code> provides an example with informative priors specified for individual predictor-response combinations.</p>
</div>
<div id="sample-effort-in-count-data" class="section level2">
<h2><span style="color:teal">sample effort in count data</span></h2>
<p>Discrete count (<code>'DA'</code>) data have effort associated with search time, plot area, and so forth. When the effort values are measured in units that result in large differences between data types sampled with different efforts, model fitting deteriorates. The modeling scale is <span class="math inline">\(W = Y/E\)</span>, where <span class="math inline">\(Y\)</span> are counts, and <span class="math inline">\(E\)</span> is effort. Units that make <span class="math inline">\(E\)</span> large, can make <span class="math inline">\(W\)</span> vanishingly small. When counts per unit effort span different orders of magnitude for different data types, consider changing the units on effort to bring them more in alignment with one another. Model predictions for ground beetles (pitfall traps) and small mammals (live traps) in our NEON analysis improved by shifting from trap-days to trap-months.</p>
</div>
<div id="sample-effort-in-composition-data" class="section level2">
<h2><span style="color:teal">sample effort in composition data</span></h2>
<p>Composition count (<code>'CC'</code>) data have heterogenous effort due to different numbers of counts for each sample. For example, in microbiome data, the number of reads per sample can range from <span class="math inline">\(10^{2}\)</span> to <span class="math inline">\(10^{6}\)</span>. Typically, the number of reads does not depend on total abundance. It is generally agreed that only relative differences are important. gjam knows that the effort in <code>CC</code> data is the total count for the sample, so <code>effort</code> does not need to be specified. Here is an example with simulated data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f   &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">S =</span> <span class="dv">8</span>, <span class="dt">typeNames =</span> <span class="st">'CC'</span>)
ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> f$typeNames)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)
pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">trueValues =</span> f$trueValues, <span class="dt">SMALLPLOTS =</span> F)
<span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)</code></pre></div>
<p>For comparison, here is an example with fractional composition, where there is no effort:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f   &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">S =</span> <span class="dv">20</span>, <span class="dt">typeNames =</span> <span class="st">'FC'</span>)
ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> f$typeNames)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)
pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">trueValues =</span> f$trueValues, <span class="dt">SMALLPLOTS =</span> F)
<span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)</code></pre></div>
</div>
<div id="the-partition-in-ordinal-data" class="section level2">
<h2><span style="color:teal">the partition in ordinal data</span></h2>
<p>Ordinal count (<code>'OC'</code>) data are collected where abundance must be evaluated rapidly or precise measurements are difficult. Because there is no absolute scale the partition must be inferred. Here is an example with 10 species:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f   &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">typeNames =</span> <span class="st">'OC'</span>) 
ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> f$typeNames)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)
<span class="kw">print</span>(out)</code></pre></div>
<p>A simple plot of the posterior mean values of <code>cutMu</code> shows the estimates with true values from simulation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">keep &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="kw">colnames</span>(out$parameters$cutMu),<span class="st">'C-'</span>) <span class="co">#only saved columns</span>
keep &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">as.numeric</span>(<span class="kw">unlist</span>(keep)), <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> T)[,<span class="dv">2</span>]
<span class="kw">plot</span>(f$trueValues$cuts[,keep],out$parameters$cutMu)</code></pre></div>
<p>Here are plots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">trueValues =</span> f$trueValues, <span class="dt">SMALLPLOTS =</span> F)
<span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)</code></pre></div>
</div>
<div id="categorical-data" class="section level2">
<h2><span style="color:teal">categorical data</span></h2>
<p>Categorical data have levels within groups. The levels are unordered. The columns in <code>ydata</code> that hold categorical responses are declared as <code>typeNames = &quot;CAT&quot;</code>. In observation vector <span class="math inline">\(\mathbf{y}_{i}\)</span> there are elements for one less than the number of factor levels. Suppose that observations are obtained on attributes of individual plants, each plant being an observation. The group <code>leaf</code> type might have four levels broadleaf decidious <code>bd</code>, needleleaf decidious <code>nd</code>, broadleaf evergreen <code>be</code>, and needleaf evergreen <code>ne</code>. A second group <code>xylem</code> anatomy might have three levels diffuse porous <code>dp</code>, ring porous <code>rp</code>, and tracheid <code>tr</code>. In both cases I assign the last class to be a reference class, <code>other</code>. Ten rows of the response matrix data might look like this:</p>
<pre><code>##    leaf xylem
## 1 other    rp
## 2    nd    rp
## 3 other    rp
## 4    nd    dp
## 5    be    rp
## 6    bd other
## 7    nd    dp</code></pre>
<p>This <code>data.frame ydata</code> becomes this response matrix <code>y</code>:</p>
<pre><code>##      leaf_bd leaf_nd leaf_be leaf_other xylem_dp xylem_rp xylem_other
## [1,]       0       0       0          1        0        1           0
## [2,]       0       1       0          0        0        1           0
## [3,]       0       0       0          1        0        1           0
## [4,]       0       1       0          0        1        0           0
## [5,]       0       0       1          0        0        1           0
## [6,]       1       0       0          0        0        0           1
## [7,]       0       1       0          0        1        0           0</code></pre>
<p><code>gjam</code> expands the two groups into four and three columns in <code>y</code>, respectively. As for composition data there is one redundant column for each group. Here is an example with simulated data, having two categorical groups:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'CAT'</span>,<span class="st">'CAT'</span>)
f     &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">n=</span><span class="dv">2000</span>, <span class="dt">S =</span> <span class="kw">length</span>(types), <span class="dt">typeNames =</span> types)
ml    &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">1500</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> f$typeNames, <span class="dt">PREDICTX =</span> F)
out   &lt;-<span class="st"> </span><span class="kw">gjam</span>( f$formula, <span class="dt">xdata =</span> f$xdata, <span class="dt">ydata =</span> f$ydata, <span class="dt">modelList =</span> ml )
pl    &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">trueValues =</span> f$trueValues, <span class="dt">SMALLPLOTS=</span>F, <span class="dt">PLOTALLY =</span> T)
<span class="kw">gjamPlot</span>(out, <span class="dt">plotPars =</span> pl)</code></pre></div>
</div>
<div id="combinations-of-data-types" class="section level2">
<h2><span style="color:teal">combinations of data types</span></h2>
<p>One of the advantages of gjam is that it combines data of many types. Here is an example showing joint analysis of 12 species represented by five data types, specified by column:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'OC'</span>,<span class="st">'OC'</span>,<span class="st">'OC'</span>,<span class="st">'OC'</span>,<span class="st">'CC'</span>,<span class="st">'CC'</span>,<span class="st">'CC'</span>,<span class="st">'CC'</span>,<span class="st">'CC'</span>,<span class="st">'CA'</span>,<span class="st">'CA'</span>,<span class="st">'PA'</span>,<span class="st">'PA'</span>) 
f     &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">S =</span> <span class="kw">length</span>(types), <span class="dt">Q =</span> <span class="dv">5</span>, <span class="dt">typeNames =</span> types)
ml    &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> f$typeNames)
out   &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)
tmp   &lt;-<span class="st"> </span><span class="kw">data.frame</span>(f$typeNames, out$inputs$classBySpec[,<span class="dv">1</span>:<span class="dv">10</span>])
<span class="kw">print</span>(tmp)</code></pre></div>
<p>I have displayed the first 10 columns of <code>classBySpec</code> from the <code>inputs</code> of <code>out</code>, with their <code>typeNames</code>. The ordinal count (<code>'OC'</code>) data occupy lower intervals. The width of each interval in <code>OC</code> data depends on the estimate of the partition in <code>cutMu</code>.</p>
<p>The composition count (<code>'CC'</code>) data occupy a broader range of intervals. Because <code>CC</code> data are only relative, there is information on only <span class="math inline">\(S - 1\)</span> species. One species is selected as <code>other</code>. The <code>other</code> class can be a collection of rare species (Clark et al. 2017).</p>
<p>Both continuous abundance (<code>'CA'</code>) and presence-absence (<code>'PA'</code>) data have two intervals. For CA data only the first interval is censored, the zeros (see above). For <code>PA</code> data both interval are censored; it is a multivariate probit.</p>
<p>Here are some plots for analysis of this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">trueValues =</span> f$trueValues, <span class="dt">SMALLPLOTS =</span> F, <span class="dt">GRIDPLOTS =</span> T)
<span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)</code></pre></div>
</div>
<div id="missing-data-out-of-sample-prediction" class="section level2">
<h2><span style="color:teal">missing data, out-of-sample prediction</span></h2>
<p>gjam identifies missing values in <code>xdata</code> and <code>ydata</code> and models them as part of the posterior distribution. These are located at <code>$missing$xmiss</code> and <code>$missing$ymiss</code>. The estimates for missing <span class="math inline">\(\mathbf{X}\)</span> are <code>$missing$xmissMu</code> and <code>$missing$xmissSe</code>. The estimates for missing <span class="math inline">\(\mathbf{Y}\)</span> are <code>$missing$ymissMu</code> and <code>$missing$ymissSe</code>.</p>
<p>To simulate missing data use <code>nmiss</code> to indicate the number of missing values. The actual value will be less than <code>nmiss</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">typeNames =</span> <span class="st">'OC'</span>, <span class="dt">nmiss =</span> <span class="dv">20</span>)
<span class="kw">which</span>(<span class="kw">is.na</span>(f$xdata), <span class="dt">arr.ind =</span> T)</code></pre></div>
<p>Note that missing values are assumed to occur in random rows and columns, but not in column one, which is the intercept and known. No further action is needed for model fitting, as <code>gjam</code> knows to treat these as missing data.</p>
<p>Out-of-sample prediction of <span class="math inline">\(\mathbf{Y}\)</span> is not part of the posterior distribution. For model fitting, holdouts can be specified randomly in <code>modelList</code> with <code>holdoutN</code> (the number of plots to be held out at random) or with <code>holdoutIndex</code> (observation numbers, i.e., row numbers in <code>x</code> and <code>y</code>). The latter can be useful when a comparison of predictions is desired for different models using the same plots as holdouts.</p>
<p>When observations are held out, <code>gjam</code> provides out-of-sample prediction for both <code>x[holdoutIndex,]</code> and <code>y[holdoutIndex,]</code>. The holdouts are not included in the fitting of <span class="math inline">\(\boldsymbol{B}\)</span>,<span class="math inline">\(\boldsymbol{\Sigma}\)</span>, or <span class="math inline">\(\mathcal{P}\)</span>. For prediction of <code>y[holdoutIndex,]</code>, the values of <code>x[holdoutIndex,]</code> are known, and sampling for <code>w[holdoutIndex,]</code> is done with multivariate normal distribution, without censoring. This is done because the censoring depends on <code>y[holdoutIndex,]</code>, which taken to be unknown. This sample of <code>w[holdoutIndex,]</code> becomes a prediction for <code>y[holdoutIndex,]</code> using the partition (Figure 1a).</p>
<p>For inverse prediction of <code>x[holdoutIndex,]</code> the values of <code>y[holdoutIndex,]</code> are known. This represents the situation where a sample of the community is available, and the investigator would like to predict the environment of origin.</p>
<p>Here is an example with simulated data having both missing values and holdout observations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f   &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">typeNames =</span> <span class="st">'CA'</span>, <span class="dt">nmiss =</span> <span class="dv">20</span>)
ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> f$typeNames, <span class="dt">holdoutN =</span> <span class="dv">50</span>)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
xMu  &lt;-<span class="st"> </span>out$prediction$xpredMu        <span class="co">#inverse prediction of x</span>
xSd  &lt;-<span class="st"> </span>out$prediction$xpredSd
yMu  &lt;-<span class="st"> </span>out$prediction$ypredMu        <span class="co">#predicted y</span>
hold &lt;-<span class="st"> </span>out$modelList$holdoutIndex    <span class="co">#holdout observations (rows)</span>

<span class="kw">plot</span>(out$inputs$x[hold,-<span class="dv">1</span>],xMu[hold,-<span class="dv">1</span>], <span class="dt">cex=</span>.<span class="dv">2</span>, <span class="dt">xlab=</span><span class="st">'True'</span>, <span class="dt">ylab=</span><span class="st">'Predictive mean'</span>)
<span class="kw">title</span>(<span class="st">'holdouts in x'</span>); <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)
<span class="kw">plot</span>(out$inputs$y[hold,], yMu[hold,], <span class="dt">cex=</span>.<span class="dv">2</span>, <span class="dt">xlab=</span><span class="st">'True'</span>, <span class="dt">ylab=</span><span class="st">''</span>)
<span class="kw">title</span>(<span class="st">'holdouts in y'</span>); <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)

xmiss &lt;-<span class="st"> </span>out$missing$xmiss                              <span class="co">#locations of missing x</span>
xMu   &lt;-<span class="st"> </span>out$missing$xmissMu
xSe   &lt;-<span class="st"> </span>out$missing$xmissSe
xmean &lt;-<span class="st"> </span><span class="kw">apply</span>(f$xdata,<span class="dv">2</span>,mean,<span class="dt">na.rm=</span>T)[xmiss[,<span class="dv">2</span>]]               <span class="co">#column means for missing values</span>
<span class="kw">plot</span>(xmean, xMu, <span class="dt">xlab=</span><span class="st">'Variable mean'</span>, <span class="dt">ylab=</span><span class="st">'Missing estimate'</span>) <span class="co">#posterior estimates</span>
<span class="kw">segments</span>(xmean, xMu -<span class="st"> </span><span class="fl">1.96</span>*xSe, xmean, xMu +<span class="st"> </span><span class="fl">1.96</span>*xSe)          <span class="co">#approx 95% CI</span>
<span class="kw">title</span>(<span class="st">'missing x'</span>)</code></pre></div>
<p>Note that there are no ‘true’ values in the simulation for missing x–the last graph at right just shows estimates relative to mean values for respective variables.</p>
</div>
<div id="prediction-with-heterogenous-effort" class="section level2">
<h2><span style="color:teal">prediction with heterogenous effort</span></h2>
<p>Out-of-sample prediction can not only be done by holding out samples in <code>gjam</code>. It can also be done post-fitting, with the function <code>gjamPredict</code>. In this second case, a prediction grid is passed together with the fitted object generated by <code>gjam</code>. Here is an example with counts (<code>DA</code>) and continuous data (<code>CA</code>). I simulate, fit, and predict these data with heterogeneous sample effort:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sc   &lt;-<span class="st"> </span><span class="dv">3</span>                               <span class="co">#no. CA responses</span>
sd   &lt;-<span class="st"> </span><span class="dv">10</span>                              <span class="co">#no. DA responses</span>
tn   &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">rep</span>(<span class="st">'CA'</span>,sc),<span class="kw">rep</span>(<span class="st">'DA'</span>,sd) )  <span class="co">#combine CA and DA obs</span>
S    &lt;-<span class="st"> </span><span class="kw">length</span>(tn)
n    &lt;-<span class="st"> </span><span class="dv">500</span>
emat &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">runif</span>(n,.<span class="dv">5</span>,<span class="dv">5</span>), n, sd)              <span class="co">#simulated DA effort</span>
eff  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">columns =</span> <span class="kw">c</span>((sc<span class="dv">+1</span>):S), <span class="dt">values =</span> emat )
f    &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">n =</span> n, <span class="dt">typeNames =</span> tn, <span class="dt">effort =</span> eff)
ml   &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> f$typeNames, <span class="dt">effort =</span> f$effort)
out  &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">bty=</span><span class="st">'n'</span>)             
<span class="kw">gjamPredict</span>(out, <span class="dt">y2plot =</span> <span class="kw">colnames</span>(f$ydata)[tn ==<span class="st"> 'DA'</span>]) <span class="co">#predict DA data</span></code></pre></div>
<p>The prediction plot fits the data well, because it assumes the same effort. However, I might wish to predict data with a standard level of effort, say ‘1’. This new effort is taken in the same units as was used to fit the data, e.g., plot area, time observed, and so on. I use the same design matrix, but specify this new effort. Here I first predict the data with the actual effort, followed by the new effort of 1</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">xdata =</span> f$xdata, <span class="dt">effort=</span>eff, <span class="dt">nsim =</span> <span class="dv">500</span> ) <span class="co"># effort unchanged </span>
p1  &lt;-<span class="st"> </span><span class="kw">gjamPredict</span>(<span class="dt">output =</span> out, <span class="dt">newdata =</span> new)

<span class="kw">plot</span>(f$y[,tn ==<span class="st"> 'DA'</span>], p1$sdList$yMu[,tn ==<span class="st"> 'DA'</span>],<span class="dt">ylab =</span> <span class="st">'Predicted'</span>,<span class="dt">cex=</span>.<span class="dv">1</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)

new$effort$values &lt;-<span class="st"> </span>eff$values*<span class="dv">0</span> +<span class="st"> </span><span class="dv">1</span>       <span class="co"># predict for effort = 1</span>
p2 &lt;-<span class="st"> </span><span class="kw">gjamPredict</span>(<span class="dt">output =</span> out, <span class="dt">newdata =</span> new)

<span class="kw">points</span>(f$y[,tn ==<span class="st"> 'DA'</span>], p2$sdList$yMu[,tn ==<span class="st"> 'DA'</span>],<span class="dt">col=</span><span class="st">'orange'</span>,<span class="dt">cex=</span>.<span class="dv">1</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</code></pre></div>
<p>The orange dots show what the model would predict had effort on all observations been equal to 1.</p>
</div>
<div id="conditional-prediction" class="section level2">
<h2><span style="color:teal">conditional prediction</span></h2>
<p><code>gjam</code> can predict a subset of columns in <code>y</code> conditional on other columns using the function <code>gjamPredict</code>. Here is an example using the model fitted in the previous section. Consider model prediction in the case where the second plant species is absent, and the first species is at its mean value. In other words, for these plant species abundances, what is the effect of model predictors? I compare it to predictions where I first condition on the observed values for the first two plant species. I do not specify a new version of <code>xdata</code>, but rather include the columns of <code>y</code> to condition on:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ydataCond =</span> f$y[,<span class="dv">1</span>:<span class="dv">2</span>], <span class="dt">nsim=</span><span class="dv">200</span>)   <span class="co"># cond on obs CA data</span>
p1  &lt;-<span class="st"> </span><span class="kw">gjamPredict</span>(<span class="dt">output =</span> out, <span class="dt">newdata =</span> new)$sdList$yMu[,tn ==<span class="st"> 'DA'</span>]

yc     &lt;-<span class="st"> </span>f$y[,<span class="dv">1</span>:<span class="dv">2</span>]                                  <span class="co"># cond on new CA values</span>
yc[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(yc[,<span class="dv">1</span>])
yc[,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
new    &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ydataCond =</span> yc, <span class="dt">nsim=</span><span class="dv">200</span>)
p2     &lt;-<span class="st"> </span><span class="kw">gjamPredict</span>(<span class="dt">output =</span> out, <span class="dt">newdata =</span> new)$sdList$yMu[,tn ==<span class="st"> 'DA'</span>]
<span class="kw">plot</span>(f$y[,tn ==<span class="st"> 'DA'</span>], p1, <span class="dt">xlab=</span><span class="st">'Obs'</span>, <span class="dt">ylab =</span> <span class="st">'Pred'</span>, <span class="dt">cex=</span>.<span class="dv">1</span>,
    <span class="dt">ylim=</span><span class="kw">range</span>(<span class="kw">c</span>(p1,p2)))
<span class="kw">points</span>(f$y[,tn ==<span class="st"> 'DA'</span>], p2,<span class="dt">col=</span><span class="st">'orange'</span>,<span class="dt">cex=</span>.<span class="dv">1</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</code></pre></div>
<p>In the first case, I held the values for columns 1 and 2 at the values observed. In the second case, I conditioned on the specific values of <code>y</code> mentioned above. Both differ from the unconditional prediction.</p>
<p>When there are large covariances in the estimates of <span class="math inline">\(\Sigma\)</span> the conditional predictions can differ dramatically from anything observed. In fact, if I condition on values of y that are well outside the data predictions will make no sense at all. Conversely, if covariances in <span class="math inline">\(\Sigma\)</span> are near zero conditional distributions will not look much different from unconditional predictions. With dimension reduction we have only a crude estimate of <span class="math inline">\(\Sigma\)</span>, so conditional prediction was be judged accordingly.</p>
<p>Here is a second example, where I ask how knowledge of some species affects ability to predict others.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(repmis)
d &lt;-<span class="st"> &quot;https://github.com/jimclarkatduke/gjam/blob/master/forestTraits.RData?raw=True&quot;</span>
<span class="kw">source_data</span>(d)

xdata &lt;-<span class="st"> </span>forestTraits$xdata                          <span class="co"># n X Q</span>
ydata  &lt;-<span class="st"> </span><span class="kw">gjamReZero</span>(forestTraits$treesDeZero)        <span class="co"># n X S</span>
ydata &lt;-<span class="st"> </span>ydata[,<span class="kw">colnames</span>(ydata) !=<span class="st"> 'other'</span>]
ydata &lt;-<span class="st"> </span><span class="kw">gjamTrimY</span>(ydata, <span class="dv">10</span>, <span class="dt">OTHER=</span>F)$y</code></pre></div>
<p>Here is a model fitted to the forest <code>&quot;CA&quot;</code> data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rl      &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">N =</span> <span class="dv">15</span>, <span class="dt">r =</span> <span class="dv">15</span>)
ml      &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">5000</span>, <span class="dt">burnin =</span> <span class="dv">2000</span>, <span class="dt">typeNames =</span> <span class="st">'CA'</span>, 
                <span class="dt">reductList =</span> rl, <span class="dt">PREDICTX =</span> F)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(formula, xdata, ydata, <span class="dt">modelList =</span> ml)

<span class="co">#prediction</span>
newdata &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">xdata =</span> xdata, <span class="dt">nsim=</span><span class="dv">100</span>)
tmp     &lt;-<span class="st"> </span><span class="kw">gjamPredict</span>(out, <span class="dt">newdata=</span>newdata)
full    &lt;-<span class="st"> </span>tmp$sdList$yMu</code></pre></div>
<p>Here I condition on half of the species and predict the other half:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cnames &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">colnames</span>(ydata),S/<span class="dv">2</span>)
wc     &lt;-<span class="st"> </span><span class="kw">match</span>(cnames, <span class="kw">colnames</span>(ydata))

yc &lt;-<span class="st"> </span>ydata[,cnames]

newdata &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ydataCond =</span> yc, <span class="dt">nsim=</span><span class="dv">200</span>)
tmp     &lt;-<span class="st"> </span><span class="kw">gjamPredict</span>(out, <span class="dt">newdata =</span> newdata)
condy   &lt;-<span class="st"> </span>tmp$sdList$yMu

<span class="kw">plot</span>(ydata[,-wc], full[,-wc], <span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">range</span>(ydata)), <span class="dt">cex=</span>.<span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)
<span class="kw">points</span>(ydata[,-wc],condy[,-wc],<span class="dt">col=</span><span class="dv">2</span>, <span class="dt">cex=</span>.<span class="dv">2</span>)
rmspe &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">mean</span>((ydata[,-wc] -<span class="st"> </span>full[,-wc])^<span class="dv">2</span>),
            <span class="kw">mean</span>((ydata[,-wc] -<span class="st"> </span>condy[,-wc])^<span class="dv">2</span>))
<span class="kw">names</span>(rmspe) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'unconditional'</span>,<span class="st">'conditional'</span>)
rmspe</code></pre></div>
<p>The rmspe for the unconditional prediction is lower, because there are residual relationships between species.</p>
</div>
<div id="presence-only-data-with-effort" class="section level2">
<h2><span style="color:teal">presence-only data with effort</span></h2>
<p>If I have a model for effort, then incidence data can have a likelihood, i.e., a probability assigned to observations that are aggregated into groups of known effort. I cannot model absence for the aggregate data unless I know how much effort was devoted to searching for it. Effort is widely known to have large spatio-temporal and taxonomic bias.</p>
<p>If I know the effort for a region, even in terms of a model (e.g., distance from universities and museums, from rivers or trails, numbers of a species already in collections), I can treat aggregate data as counts. If I do not know effort, out of desperation I might use the total numbers of all species counted in a region as a crude index of effort. The <code>help</code> page for function <code>gjamPoints2Grid</code> provides examples to aggregate incidence data with (x, y) locations to a lattice.</p>
<p>If effort is known I can supply a prediction grid <code>predGrid</code> for the known effort map and aggregate incidence to that map. I can then model the data are <code>'DA'</code> data, specifying effort as in the example above.</p>
<p>If effort is unknown, I can model the data as composition data, <code>'CC'</code>. Again, this is a desperate measure, because there are many reasons why even the total for all species at a lattice point might not represent relative effort.</p>
<p><br></p>
</div>
</div>
<div id="dimension-reduction" class="section level1">
<h1><span style="color:darkgreen">dimension reduction</span></h1>
<p>Microbiome, genetic, and hyperspectral satelitte data are examples of observations characterized by a large number of response variables <span class="math inline">\(S\)</span> (e.g., species); we refer to such data sets as <em>‘big-S’</em>. Covariance <span class="math inline">\(\boldsymbol{\Sigma}\)</span> has dimension <span class="math inline">\(S \times S\)</span>, with <span class="math inline">\(S(S + 1)/2\)</span> unique elements, the <em>S</em> diagonal elements plus <span class="math inline">\(1/2\)</span> of the non-diagonal elements. For example, a data set with <span class="math inline">\(S = 100\)</span> has 5050 unique elements in <span class="math inline">\(\boldsymbol{\Sigma}\)</span>. It must be inverted, an order<span class="math inline">\((S^{3})\)</span> operation. Even in cases where <span class="math inline">\(\Sigma\)</span> can be inverted the number of observations may not be sufficient to accurately estimate the large number of parameters in the model. In gjam, <em>big-S</em> is handled by generating a low-order approximation of <span class="math inline">\(\boldsymbol{\Sigma}\)</span>. The rank of <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is reduced by finding structure, essentially groups of responses that respond similarly. (Taylor-Rodriguez et al. 2017).</p>
<p>The interpretation of a reduced model warrants a few words. If we replace <span class="math inline">\(\boldsymbol{\Sigma}\)</span> with a much smaller number of estimates, we cannot insist that we can know the covariance between every species. If <span class="math inline">\(\boldsymbol{\Sigma}\)</span> does not contain structure that can be adequately summarized with fewer estimates, then we have at best a version of the model that soaks up some of the dependence structure that is important for estimating <span class="math inline">\(\mathbf{B}\)</span>. On the other hand <span class="math inline">\(\boldsymbol{\Sigma}\)</span> may contain substantial structure that can be captured by a small number of estimates. We first we point out that an analysis of <em>big-S</em> data sets need not include every species that might be recorded in a data set and how gjam functions can be used to trim large data sets. We then describe dimension reduction in gjam.</p>
<p>A species <em>s</em> that bears no relationship to any of the predictors in <span class="math inline">\(\mathbf{X}\)</span> (all <span class="math inline">\(\mathbf{B}_{s}\)</span> small) or to other species <em>s’</em> (all <span class="math inline">\(\boldsymbol{\Sigma}_{s',s}\)</span> small) will not be ‘explained’ by the model. Such species will contribute little to the model fit, while degrading performance. Consider either of two options for reducing the number of species in the model, <em>trimming</em> and <em>aggregation</em>.</p>
<p><strong>Trim</strong> species that are not of interest, that will not affect the fit, or both.</p>
<p><strong>Aggregation</strong> can be based on a number of criteria, such as phylogenetic similarity (e.g., members of the same genus), by functional similarity (e.g., a feeding guild, C<sub>3</sub> vs C<sub>4</sub> plants), and so forth. Rare species can be aggregated into a single group. For example, Clark et al. (2014) include 96 tree species that occur on a minimum of 50 forest inventory plots in eastern North America. The remaining species can be gathered into a single class. When this option is used the name <em>‘other’</em> is assigned to this class in the plots-by-species matrix <code>ydata</code>. Including this class is important where species compete, such as forest trees. It can also be used as a reference category for composition data, summarized below</p>
<p>In gjam, the total number of covariance parameter estimates is reduced to <span class="math inline">\(N \times r\)</span>, where <span class="math inline">\(r &lt; N &lt;&lt; S\)</span>. The integer <span class="math inline">\(N\)</span> represents the potential number of response groups. The integer <span class="math inline">\(r\)</span> is the dimensionality of each group. In other words, large <em>N</em> means more groups, and large <em>r</em> increases the flexibility of those <em>N</em> groups.</p>
<p>Dimension reduction is invoked in one of two ways. <strong>The first way</strong> is automatic, when i) a data set includes more species than can be fitted given sample size <em>n</em> or when ii) <em>S</em> is too large irrespective of <em>n</em>.</p>
<p><strong>A second way</strong> to invoke dimension reduction is to specify it in <code>modelList</code>, through the <code>list reductList</code>. Here is an example using simulated data, where the number of species is twice the number of observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S   &lt;-<span class="st"> </span><span class="dv">200</span>
f   &lt;-<span class="st"> </span><span class="kw">gjamSimData</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">S =</span> S, <span class="dt">typeNames=</span><span class="st">'CA'</span>)
rl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">r =</span> <span class="dv">5</span>, <span class="dt">N =</span> <span class="dv">20</span>)
ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> f$typeNames, 
            <span class="dt">reductList =</span> rl, <span class="dt">PREDICTX =</span> F)  
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(f$formula, f$xdata, f$ydata, <span class="dt">modelList =</span> ml)
pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">trueValues =</span> f$trueValues, <span class="dt">SMALLPLOTS =</span> F)
<span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)</code></pre></div>
<p>The full matrix is not stored, so gjam needs time to construct versions of it as needed. The setting <code>PREDICTX = F</code> can be included in <code>modelList</code> to speed up computation, when prediction of inputs is not of interest.</p>
<p>The massive reduction in rank of the covariance matrix means that the we cannot estimate the ‘true’ version of <span class="math inline">\(\boldsymbol{\Sigma}\)</span>, particularly given the fact that the simulator does not generate a structured <span class="math inline">\(\boldsymbol{\Sigma}\)</span>. These appear as highly structured <code>GRIDPLOTS</code> for the posterior mean estimates of the correlation matrix <span class="math inline">\(\mathbf{R}\)</span>. However, we can still obtain estimates of <span class="math inline">\(\mathbf{B}\)</span> and predictions of <span class="math inline">\(\mathbf{Y}\)</span> that are close to true values.</p>
<p>To override the automatic dimension reduction for a large response matrix, specify <code>modelList$REDUCT &lt;- FALSE</code>.</p>
<p>Orthogonalization:</p>
<p><span class="math display">\[
\mathbf{B} + \left( \mathbf{X}'\mathbf{X} \right)^{-1} \mathbf{X}' 
\mathbf{W}
\]</span></p>
<div id="big-s-composition-data-fungal-endophytes" class="section level2">
<h2><span style="color:teal"><em>big-S</em> composition data: fungal endophytes</span></h2>
<p>Microbiome data are often <em>big-S, small-n</em>; with thousands of response variables, columns in <span class="math inline">\(\mathbf{Y}\)</span> (e.g., OTUs). They are also composition count (<code>'CC'</code>) data, discrete counts, but not related to absolute abundance; they are meaningful in a relative sense. Because data only inform about relative abundance, there is information for only <span class="math inline">\(S - 1\)</span> species. If there are thousands of OTUs, most of which are rare and thus not explained by the model, consider aggregating the many rare types into a single <code>other</code> class.</p>
<p>Fungal endophytes were sequenced on host tree seedlings (Hersh et al. 2016). In the data set <code>fungEnd</code> there is a compressed version of responses <code>yDeZero</code> containing OTU counts, a <code>data.frame</code> <code>xdata</code> containing predictors, and <code>status</code>, a vector of host responses, 0 for morbid, 1 for no signs of morbidity. Several histograms show the overwhelming numbers of zeros. Here we extract the data, stored in de-zeroed format, and generate some plots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(repmis)
d &lt;-<span class="st"> &quot;https://github.com/jimclarkatduke/gjam/blob/master/fungEnd.RData?raw=True&quot;</span>
<span class="kw">source_data</span>(d)

xdata  &lt;-<span class="st"> </span>fungEnd$xdata
otu    &lt;-<span class="st"> </span><span class="kw">gjamReZero</span>(fungEnd$yDeZero)
status &lt;-<span class="st"> </span>fungEnd$status

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">bty=</span><span class="st">'n'</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), 
    <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">tcl =</span> -<span class="fl">0.5</span>, <span class="dt">mgp =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">family=</span><span class="st">''</span>)
<span class="kw">hist</span>(status, <span class="dt">main=</span><span class="st">'Host condition (morbid = 0)'</span>, <span class="dt">ylab =</span> <span class="st">'Host obs'</span>)
<span class="kw">hist</span>(otu, <span class="dt">nclass=</span><span class="dv">100</span>, <span class="dt">ylab =</span> <span class="st">'Reads'</span>, <span class="dt">main=</span><span class="st">'each observation'</span>)
nobs &lt;-<span class="st"> </span><span class="kw">gjamTrimY</span>(otu, <span class="dt">minObs =</span> <span class="dv">1</span>, <span class="dt">OTHER =</span> F)$nobs
<span class="kw">hist</span>(nobs, <span class="dt">nclass=</span><span class="dv">100</span>, <span class="dt">ylab =</span> <span class="st">'Total reads per OTU'</span>, <span class="dt">main=</span><span class="st">'Full sample'</span>)</code></pre></div>
<p>The model will provide no information on the rarest taxa. Here we trim <code>otu</code> to include only OTUs that occur in &gt; 100 observations. The rarest OTUs are aggregated into the last column of <code>y</code> with the column name <code>other</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp &lt;-<span class="st"> </span><span class="kw">gjamTrimY</span>(otu, <span class="dt">minObs =</span> <span class="dv">100</span>)
y   &lt;-<span class="st"> </span>tmp$y
<span class="kw">dim</span>(fungEnd$y)               <span class="co"># all OTUs</span>
<span class="kw">dim</span>(y)                       <span class="co"># trimmed data</span>
<span class="kw">tail</span>(<span class="kw">colnames</span>(y))            <span class="co"># 'other' class added</span></code></pre></div>
<p>The full response matrix includes the OTU composition counts and the host status in column 1:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ydata &lt;-<span class="st"> </span><span class="kw">cbind</span>(status, y)     <span class="co"># host status is also a response</span>
S     &lt;-<span class="st"> </span><span class="kw">ncol</span>(ydata)
typeNames    &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">'CC'</span>,S)   <span class="co"># composition count data</span>
typeNames[<span class="dv">1</span>] &lt;-<span class="st"> 'PA'</span>          <span class="co"># binary host status </span></code></pre></div>
<p>The interactions in the model involve two factors <code>poly</code> (two levels, polyculture vs monoculture) and <code>host</code> (eight factor levels, one for each host species). I assign <code>acerRubr</code> as the reference class for <code>host</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xdata$host &lt;-<span class="st"> </span><span class="kw">relevel</span>(xdata$host,<span class="st">'acerRubr'</span>)</code></pre></div>
<p>The <code>gjam vignette</code> on traits discusses multilevel factors in more detail. We discuss multilevel factors in the context of interactions below.</p>
<p>For this example we specify up to <span class="math inline">\(N = 20\)</span> clusters with <span class="math inline">\(r = 3\)</span> columns each. Here is an analysis of host seedling and polyculture effect on combined host morbidity status and the microbiome composition:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rl &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">r =</span> <span class="dv">5</span>, <span class="dt">N =</span> <span class="dv">15</span>)
ml &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> typeNames, <span class="dt">reductList =</span> rl)
output &lt;-<span class="st"> </span><span class="kw">gjam</span>(~<span class="st"> </span>host*poly, xdata, ydata, <span class="dt">modelList =</span> ml)</code></pre></div>
<p>Here is output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S &lt;-<span class="st"> </span><span class="kw">ncol</span>(ydata)
specColor     &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">'black'</span>,S)
specColor[<span class="dv">1</span>]  &lt;-<span class="st"> 'red'</span>                 <span class="co"># highlight host status</span>
plotPars      &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">specColor =</span> specColor, <span class="dt">GRIDPLOTS=</span>T,
                      <span class="dt">SMALLPLOTS =</span> F) 
fit &lt;-<span class="st"> </span><span class="kw">gjamPlot</span>(output, plotPars)
fit$eComs[<span class="dv">1</span>:<span class="dv">5</span>,]</code></pre></div>
<p>Check the chains for convergence. Those coefficients that do not converge are poorly represented in factorial factor combinations.</p>
<p>Again, the low dimensional version of covariance <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is expected to perform best when there is structure in the data. The responses in matrix <span class="math inline">\(\mathbf{E}\)</span>, returned in <code>fit$ematrix</code>, classify OTUs in three main groups, contained in <code>fit$eComs</code>.</p>
</div>
<div id="interactions-and-indirect-effects" class="section level2">
<h2><span style="color:teal">interactions and indirect effects</span></h2>
<p>A plot of main effects, interactions, and indirect effects is used in this example to show contributions to host status, the response variable <code>status</code>. The effects on host status of on responses is available as a table with standard errors and credible intervals:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beta &lt;-<span class="st"> </span>fit$summaryCoeffs$betaCoeff
ws   &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">'status_'</span>,<span class="kw">rownames</span>(beta))  <span class="co"># find coefficients for status</span>
beta[ws,]</code></pre></div>
<p>Following the intercept are rows showing main effects. These are followed by interaction terms. A quick visual of coefficients having credible intervals that exclude zero is here:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit$summaryCoeffs$betaSig[<span class="st">'status'</span>,]</code></pre></div>
<p>with <code>-</code> and <code>+</code> indicating negative and postive values.</p>
<p>Here I use the function <code>gamIIE</code> to create the object <code>fit1</code>, a <code>list</code> of these main, interaction, and indirect effects. I specify not to include the response variable <code>other</code> as an indirect effect on <code>status</code>, because we want to focus on the effects of microbes that have been assigned to known taxonomic groups.</p>
<p>I specify the values for main effects that are involved in the interactions between <code>poly</code> and <code>host</code>. Each factor has one less column in the design matrix <code>x</code> than factor levels. <code>poly</code> has two classes in <code>xdata</code>, one each for monoculture and polyculture, so there is one <code>poly</code> column in <code>x</code>. <code>host</code> has eight species in <code>xdata</code>, so there are seven columns in <code>x</code>. Recall that we assigned <code>acerRubr</code> to be the reference class, so there is no column for it in <code>x</code>.</p>
<p>The vector of predictor values <code>xvector</code> passed to <code>gjamIIE</code> has the same elements and names as columns in <code>x</code>. For this reason it is easiest to simply assign it a row in <code>x</code>, then change the values. The only values that influence interactions are those that are involved in interaction terms, as specified in <code>formula</code>.</p>
<p>For the following plots I copy the first row of <code>x</code>. In the first are main effects of all predictors on <code>status</code>. In the second plot is interactions with <code>poly</code> set to 1. In the third plot are indirect effects of the microbes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>output$inputs$x
xvector &lt;-<span class="st"> </span>x[<span class="dv">1</span>,]*<span class="dv">0</span>
<span class="kw">names</span>(xvector)  &lt;-<span class="st"> </span><span class="kw">colnames</span>(x)

xvector[<span class="st">'hostfraxAmer'</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
xvector[<span class="st">'polypoly'</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
fit1 &lt;-<span class="st"> </span><span class="kw">gjamIIE</span>(output, xvector, <span class="dt">omitY =</span> <span class="st">'other'</span>)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">bty=</span><span class="st">'n'</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), 
    <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">tcl =</span> -<span class="fl">0.5</span>, <span class="dt">mgp =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>))
<span class="kw">gjamIIEplot</span>(fit1, <span class="dt">response =</span> <span class="st">'status'</span>, <span class="dt">effectMu =</span> <span class="st">'direct'</span>, 
            <span class="dt">effectSd =</span> <span class="st">'direct'</span>, <span class="dt">legLoc =</span> <span class="st">'bottomright'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-<span class="dv">5</span>,<span class="dv">10</span>))
<span class="kw">title</span>(<span class="st">'Direct effect by host'</span>)

<span class="kw">gjamIIEplot</span>(fit1, <span class="dt">response =</span> <span class="st">'status'</span>, <span class="dt">effectMu =</span> <span class="st">'int'</span>, <span class="dt">effectSd =</span> <span class="st">'int'</span>,
            <span class="dt">legLoc =</span> <span class="st">'topright'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-<span class="dv">5</span>,<span class="dv">10</span>))
<span class="kw">title</span>(<span class="st">'Interactions with polyculture'</span>)

<span class="kw">gjamIIEplot</span>(fit1, <span class="dt">response =</span> <span class="st">'status'</span>, <span class="dt">effectMu =</span> <span class="st">'ind'</span>, <span class="dt">effectSd =</span> <span class="st">'ind'</span>,
            <span class="dt">legLoc =</span> <span class="st">'topright'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">title</span>(<span class="st">'Indirect effect of microbiome'</span>)</code></pre></div>
<p>The plot at left is the direct effect, which includes both the main effects plus interactions and plotted relative to the mean over all hosts. The interaction contribution at center is the effect of each host, when grown in polyculture (<code>poly = ref1</code>) and of polyculture when the <code>host = 'fraxAmer</code>.</p>
<p>The indirect effects bring with them the main effects and interaction effects on each microbial taxon. In this example the indirect effects are noisy, showing large 95% intervals.</p>
<p>I might also wish to explore the taxa that are more abundant in healthy versus morbid hosts. This can be done with <code>gjamPredict</code>. Here are conditional predictions for responses with <code>status</code> first set to 0 (morbid) and then set to 1 (healthy):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y0 &lt;-<span class="st"> </span>ydata[,<span class="dv">1</span>,drop=F]*<span class="dv">0</span>       <span class="co">#unhealthy host</span>

new    &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ydataCond =</span> y0, <span class="dt">nsim=</span><span class="dv">50</span>)
morbid &lt;-<span class="st"> </span><span class="kw">gjamPredict</span>(output, <span class="dt">newdata =</span> new ) 

new     &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ydataCond =</span> y0 +<span class="st"> </span><span class="dv">1</span>, <span class="dt">nsim =</span> <span class="dv">50</span> )
healthy &lt;-<span class="st"> </span><span class="kw">gjamPredict</span>(output, <span class="dt">newdata =</span> new )

<span class="co"># compare predictions</span>
y &lt;-<span class="st"> </span>output$inputs$y
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">bty=</span><span class="st">'n'</span>)
<span class="kw">plot</span>(healthy$sdList$yMu[,-<span class="dv">1</span>],morbid$sdList$yMu[,-<span class="dv">1</span>], <span class="dt">cex=</span>.<span class="dv">4</span>,
     <span class="dt">xlab=</span><span class="st">'healty'</span>,<span class="dt">ylab=</span><span class="st">'morbid'</span>)
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">'grey'</span>)
<span class="kw">plot</span>(y[,<span class="dv">2</span>:<span class="dv">20</span>],healthy$sdList$yMu[,<span class="dv">2</span>:<span class="dv">20</span>], <span class="dt">cex=</span>.<span class="dv">4</span>,<span class="dt">col=</span><span class="st">'orange'</span>,
     <span class="dt">xlab=</span><span class="st">'Observed'</span>,<span class="dt">ylab=</span><span class="st">'Predicted'</span>, <span class="dt">pch=</span><span class="dv">16</span>)
<span class="kw">points</span>(y[,<span class="dv">2</span>:<span class="dv">20</span>],morbid$sdList$yMu[,<span class="dv">2</span>:<span class="dv">20</span>], <span class="dt">cex=</span>.<span class="dv">4</span>,<span class="dt">col=</span><span class="st">'blue'</span>, <span class="dt">pch=</span><span class="dv">16</span>)
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">'grey'</span>)</code></pre></div>
<p>In the first plot dots above the the 1:1 line are microbial taxa predicted to be more abundant in morbid hosts, and vice versa. In the second plot response to healthy hosts are in orange for a subset of types, to limit clutter.</p>
<p><br></p>
</div>
</div>
<div id="joint-trait-modeling" class="section level1">
<h1><span style="color:darkgreen">joint trait modeling</span></h1>
<p>Because it accommodates different data types gjam can be used to model ecological traits by either of two approaches (Clark 2016). One approach uses community weighted mean/mode (CWMM) trait values for a plot <span class="math inline">\(i\)</span> as a response vector <span class="math inline">\(\mathbf{u}_{i}\)</span>, where each trait has a corresponding data type designation in <code>typeNames</code>. I discuss this approach first. I then summarize the second approach, predictive trait modeling.</p>
<div id="trait-response-model-trm" class="section level2">
<h2><span style="color:teal">trait response model (TRM)</span></h2>
<p>There are <span class="math inline">\(n\)</span> observations of <span class="math inline">\(M\)</span> traits to be explained by <span class="math inline">\(Q - 1\)</span> predictors in design matrix <span class="math inline">\(\mathbf{X}\)</span>. The Trait Response Model (TRM) in Clark (2016) is</p>
<p><span class="math display">\[\mathbf{w}_{i} \sim MVN(\mathbf{A}'\mathbf{x}_{i},\Omega)\]</span></p>
<p>where <span class="math inline">\(\mathbf{w}_{i}\)</span> is a length-<span class="math inline">\(M\)</span> vector of expected CWMM values, <span class="math inline">\(\mathbf{A}\)</span> is the <span class="math inline">\(Q \times M\)</span> matrix of coefficients, and <span class="math inline">\(\Omega\)</span> is the <span class="math inline">\(M \times M\)</span> residual covariance (diagram below). After describing the setup and model fitting I show how gjam summarizes the estimates and predictions.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAFQCAYAAABgRsxBAAAD8GlDQ1BJQ0MgUHJvZmlsZQAAOI2NVd1v21QUP4lvXKQWP6Cxjg4Vi69VU1u5GxqtxgZJk6XpQhq5zdgqpMl1bhpT1za2021Vn/YCbwz4A4CyBx6QeEIaDMT2su0BtElTQRXVJKQ9dNpAaJP2gqpwrq9Tu13GuJGvfznndz7v0TVAx1ea45hJGWDe8l01n5GPn5iWO1YhCc9BJ/RAp6Z7TrpcLgIuxoVH1sNfIcHeNwfa6/9zdVappwMknkJsVz19HvFpgJSpO64PIN5G+fAp30Hc8TziHS4miFhheJbjLMMzHB8POFPqKGKWi6TXtSriJcT9MzH5bAzzHIK1I08t6hq6zHpRdu2aYdJYuk9Q/881bzZa8Xrx6fLmJo/iu4/VXnfH1BB/rmu5ScQvI77m+BkmfxXxvcZcJY14L0DymZp7pML5yTcW61PvIN6JuGr4halQvmjNlCa4bXJ5zj6qhpxrujeKPYMXEd+q00KR5yNAlWZzrF+Ie+uNsdC/MO4tTOZafhbroyXuR3Df08bLiHsQf+ja6gTPWVimZl7l/oUrjl8OcxDWLbNU5D6JRL2gxkDu16fGuC054OMhclsyXTOOFEL+kmMGs4i5kfNuQ62EnBuam8tzP+Q+tSqhz9SuqpZlvR1EfBiOJTSgYMMM7jpYsAEyqJCHDL4dcFFTAwNMlFDUUpQYiadhDmXteeWAw3HEmA2s15k1RmnP4RHuhBybdBOF7MfnICmSQ2SYjIBM3iRvkcMki9IRcnDTthyLz2Ld2fTzPjTQK+Mdg8y5nkZfFO+se9LQr3/09xZr+5GcaSufeAfAww60mAPx+q8u/bAr8rFCLrx7s+vqEkw8qb+p26n11Aruq6m1iJH6PbWGv1VIY25mkNE8PkaQhxfLIF7DZXx80HD/A3l2jLclYs061xNpWCfoB6WHJTjbH0mV35Q/lRXlC+W8cndbl9t2SfhU+Fb4UfhO+F74GWThknBZ+Em4InwjXIyd1ePnY/Psg3pb1TJNu15TMKWMtFt6ScpKL0ivSMXIn9QtDUlj0h7U7N48t3i8eC0GnMC91dX2sTivgloDTgUVeEGHLTizbf5Da9JLhkhh29QOs1luMcScmBXTIIt7xRFxSBxnuJWfuAd1I7jntkyd/pgKaIwVr3MgmDo2q8x6IdB5QH162mcX7ajtnHGN2bov71OU1+U0fqqoXLD0wX5ZM005UHmySz3qLtDqILDvIL+iH6jB9y2x83ok898GOPQX3lk3Itl0A+BrD6D7tUjWh3fis58BXDigN9yF8M5PJH4B8Gr79/F/XRm8m241mw/wvur4BGDj42bzn+Vmc+NL9L8GcMn8F1kAcXgSteGGAAAniElEQVR4Ae3dCbRd4/k/8CckoWKIGCrmVlExVAmqohqtOamhJWaLqtQ8hbQVy68iVs1iLkENCULaEjWrsmosomIWGlNMCTUkhiTyz7v/vVfIDfcmN2fvc9/PXus25+6z937f9/NsPd+7zx7aTZs+hYkAAQIECBAgQIBAjQTmqVE7miFAgAABAgQIECBQCAigdgQCBAgQIECAAIGaCgigNeXWGAECBAgQIECAgABqHyBAgAABAgQIEKipgABaU26NESBAgAABAgQICKD2AQIECBAgQIAAgZoKCKA15dYYAQIECBAgQICAAGofIECAAAECBAgQqKmAAFpTbo0RIECAAAECBAgIoPYBAgQIECBAgACBmgoIoDXl1hgBAgQIECBAgIAAah8gQIAAAQIECBCoqYAAWlNujREgQIAAAQIECAig9gECBAgQIECAAIGaCgigNeXWGAECBAgQIECAgABqHyBAgAABAgQIEKipgABaU26NESBAgAABAgQICKD2AQIECBAgQIAAgZoKCKA15dYYAQIECBAgQICAAGofIECAAAECBAgQqKmAAFpTbo0RIECAAAECBAgIoPYBAgQIECBAgACBmgoIoDXl1hgBAgQIECBAgIAAah8gQIAAAQIECBCoqYAAWlNujREgQIAAAQIECAig9gECBAgQIECAAIGaCgigNeXWGAECBAgQIECAgABqHyBAgAABAgQIEKipgABaU26NESBAgAABAgQICKD2AQIECBAgQIAAgZoKCKA15dYYAQIECBAgQICAAGofIECAAAECBAgQqKmAAFpTbo0RIECAAAECBAgIoPYBAgQIECBAgACBmgoIoDXl1hgBAgQIECBAgIAAah8gQIAAAQIECBCoqYAAWlNujREgQIAAAQIECAig9gECBAgQIECAAIGaCgigNeXWGAECBAgQIECAgABqHyBAgAABAgQIEKipgABaU26NESBAgAABAgQICKD2AQIECBAgQIAAgZoKCKA15dYYAQIECBAgQICAAGofIECAAAECBAgQqKmAAFpTbo0RIECAAAECBAi0R9BygQkTJsSYMWNavqI12qRA165dY/nll2+TY2vJoMaNGxevvPJKS1axbEUF2rdvH+uuu25Fe/d5t0aPHh2TJk36fIZXWQukfTbtu6b6EGg3bfpUH12tTi9XXHHFmDJlSiyzzDLV6ZSelCbw0EMPxYcffhidOnUqrQ9VaLhdu3axzjrr+ACoQjHmsA9pn/7zn/8c22+//Rxuae6tfu+990aPHj1i/fXXn3uN2HLdCKR9duDAgTFgwIC66XPuHfWnwmzsAR07dozbbrstVlllldlY2yptTaBz584xefLktjasFo+nQ4cOcf/990f678NU3wJHHnlkvPjii5UexOuvvx4///nP47rrrqt0P3WuNgLnn39+PP7447VpTCutIuAc0FZhtBECBAgQIECAAIHmCgigzZWyHAECBAgQIECAQKsICKCtwmgjBAgQIECAAAECzRUQQJsrZTkCBAgQIFAxgXQXgHRnFhOBehMQQOutYvpLgAABAgT+J3DeeedF//79eRCoOwFXwdddyXSYAAECBAhEcTvAIUOGRLoF2ltvvRVLLrkkFgJ1I+AIaN2USkcJECBAgMDnAulerRtuuGH86le/inQbIhOBehIQQOupWvpKgAABAgT+J3D66afHgQceGHvvvXdceuml8cknn7AhUDcCAmjdlEpHCRAgQIDA/xdID3347LPPonv37rHoootGz549Y+jQoXgI1I2AAFo3pdJRAgQI1I/A+PHj47DDDotu3boVj0dMv6dHex5xxBHxzjvv1M9AKtrThqOfDd074IAD4owzzmj41b8EKi8ggFa+RDpIgACB+hNYfPHFY9CgQcXXwq+88krMN9980b59+zj11FOjS5cu9TegCvX4008/jaWXXjr69OnT2Kv11lsvtt1223jttdca53lBoMoCroKvcnX0jQABAnUs0KlTpzjrrLPiZz/7WUycODFOPPHEmGcexz3mtKQdO3aMwYMHF5tJYXTKlCmxwAILxAknnDCnm7Y+gZoJ+H+CmlFriAABAvkJbLPNNtGrV68YO3ZsrLLKKvkBzOURX3bZZXHaaafN5VZsnkDrCwigrW9qiwQIECAwg8CCCy4Yo0aNimHDhs0w18vWEEg3or/gggti8uTJrbE5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IFCegABanr2WCRAgQIAAAQJZCgigWZbdoAkQIECAAAEC5QkIoOXZa5kAAQIECBAgkKWAAJpl2Vs26MUWWyy22267uPTSS+Opp56KoUOHxgILLBDt2rUrfvr3719scMiQIbHUUks1zj/iiCNiwoQJ8cYbb8Tuu+8eHTt2jCuuuCIee+yxuPDCC2OLLbaIrl27tqwzliZAgAABAgTqXkAArfsSzt4AxowZE3379i3C4nrrrRfHHntsHHPMMcW8RRddNK688sovbHi//faLvffeO7p16xa77bZb7L///o3vH3bYYcXrfffdNwYOHNg4Py2fwmsKpSmMHnTQQbHHHnvE2muvHWl7qf1p06Y1Lu8FgSoJPP7447HOOus0/kE1//zzx6BBg+K9996Lm266KdZcc82Yd955Y/PNN49nn322Sl3XFwIECFReQACtfInmTge/853vxEYbbVRs/NRTTy2CY/pw/eMf/xjHHXdc43uzaj2F0IbpL3/5S8PLWHfddRtf//Wvf218PXLkyNhll10af08vGo6gfmGmXwhURGCttdaKO++8M5ZbbrmiR1OnTo3evXvHIossEltttVUsscQSceONN8Ztt90Wq666akV6rRsECBCoDwEBtD7qNFd6ecsttxRHKHv06FFsf9KkSTF58uTiSOe3vvWtr2wzHRlKITZNI0aMaFx2+PDhkY6opmnGYPrQQw9F9+7dG5fzgkA9CKRvAy655JLij6UpU6bEXnvtVfw3Mnjw4CKMpiBqIkCAAIGWCwigLTdrE2t89tlnceutt8bWW29dfI2YBpWOgKajkukIT3OmPn36FIvdfffdMX78+EhHiF599dXo169fMX/UqFExduzYeO6552LllVcutt2c7Vrm6wXSObTpD4dZ/ZxzzjlfvxFLNEvgpz/9aeMpJ+n85RRC77vvvjj88MObtb6FCBAgQGBmgfYzzzInB4EHH3ww3nnnneIioXRe5v333x/rr79+tG/f/F0iBdAUWlPwvP7664tzPdP5cL169YpOnTrFxIkTI30N/9FHH8UOO+yQA2vNxpjOP9xpp51m2d73vve9Wb7njZYLnHzyycUfbC+88EJcddVVRQBt+VasQYAAAQINAs1PGw1r+LdNCNx8883Fkc90RXvnzp3jjjvuiLfffrtFY0shKF2UlK6Mv+666+Kb3/xmnHvuucUV8imEXnPNNcXX8AsuuGA0XCnfogYsPEuBDTfcMNKPqTYC6Q+qyy67rDjinFpMF+z9/e9/r03jWiFAgEAbFPAVfBssanOGlK7i3WCDDYrwmZZfffXVi6/jm7PujMs0fA2fAmw6epo+qNPUMP+ee+4pLuKYZx672oxuc/r65ZdfLo7Cpa+Cm/pJpz6YWlfg6aefbjyP+a677ophw4a1bgO2RoAAgYwEpIKMit0w1DfffDMeffTR4j6cDfPS/TjTuZ/jxo2LdO5mc6eGoJku0Nh1110bV0sXZyy00ELF775+b2RptRcXX3xxbLrpprP8Of/881utLRuKeOKJJ4qgn/7QWnLJJQuSI488Mt5//308BAgQIDAbAgLobKDV+yo33HBDcf/NdHHFjFM6apbOK2y4un3G92b1Ot1+Jp1vuPzyy0fPnj0bF0v3TNx2220jXUU84/zGBbyYI4Hf//738fHHH8/y56STTpqj7Vv5c4F0LvMhhxwS6XZl6Y+0E088sXgzPWAh3T/XRIAAAQItF3AOaMvN6nqNdMX6CSecUIwhfZCmWyalozjpRtrpnLZ0r86GI5fNHWg6Cpo+pNMV9DNOaX766r1Dhw4zzvaaQN0IpLtFpAcmpKd2denSpej3PvvsE6eddlqkr+TTOc/pj7aGe+rWzcB0lAABAiULCKAlF6DWzW+yySbx0ksvtWqzv/71ryN9UH95Sh/a6alHJgL1KJBuuZRuKZZuRp+O8qf72P7kJz+JdIurd999txhSugNECqCXX3558V49jlOfCRAgUIaAAFqGeh22+dZbb82y1+lr9qamdORz2WWXbeqtYl56pKGJQFUF0h9P6ZzPL08HH3xwpB8TAQIECMy+gHNAZ98umzXTDbfT/Q8vuOCCGD169ByPOz1je8iQIfHiiy8W59bN8QZtgAABAgQIEKgrAUdA66pc5XR2wIABrdpwesZ2+jERIECAAAECeQo4Appn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeAAJpn3Y2aAAECBAgQIFCagABaGr2GCRAgQIAAAQJ5CgigedbdqAkQIECAAAECpQkIoKXRa5gAAQIECBAgkKeA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KGqqvXTl+0477VTcRim9ny4+WmONNYqLktL2mjOlBzCk2yztueeexW2gBg4cGCeffHLssMMOseaaa8aNN95Y3IKsOduyDAECBNqUwPR7MprasMCrr7467cc//vG06TvttNNOO23a9PsXTuvTp0/x+/Tb0UybHg6/cvQvv/zytE033XTacccdVyw3/ebZ0370ox9Nm/7BOm36PT2/ct305mOPPTatd+/eRXvTb8M0bfpFF8U6Z5999rT77ruveJ3aOPjgg4tlpl+0MW36h/S06Ueqivf8D4G2IvDII49Mm/5Ahsb/FtvKuIyDAAECsyPgSUht6s8JgyFAoMoC//nPf4pbQU3/wyz+7//+r3g0Z3r8rIkAAQK5CQiguVXceAkQKFVg6tSpceedd8aIESNi0qRJseqqqxYXOaWv900ECBDIRUAAzaXSxkmAAAECBAgQqIiAi5AqUgjdIECAAAECBAjkIiCA5lJp4yRAgAABAgQIVERAAK1IIXSDAAECBAgQIJCLgACaS6WNkwABAgQIECBQEQEBtCKF0A0CBAgQIECAQC4CAmgulTZOAgQIECBAgEBFBATQihRCNwgQIECAAAECuQgIoLlU2jgJECBAgAABAhUREEArUgjdIECAAAECBAjkIiCA5lJp4yRAgAABAgQIVERAAK1IIXSDAAECBAgQIJCLgACaS6WNkwABAgQIECBQEQEBtCKF0A0CBAgQIECAQC4CAmgulTZOAgQIECBAgEBFBATQihRCNwgQIECAAAECuQgIoLlU2jgJECBAgAABAhUREEArUgjdIECAAAECBAjkIiCA5lJp4yRAgAABAgQIVERAAK1IIXSDAAECBAgQIJCLgACaS6WNkwABAgQIECBQEQEBtCKF0A0CBAgQIECAQC4CAmgulTZOAgQIECBAgEBFBATQihRCNwgQIECAAAECuQgIoLlU2jgJECBAgAABAhUREEArUgjdIECAAAECBAjkIiCA5lJp4yRAgAABAgQIVERAAK1IIXSDAAECBAgQIJCLgACaS6WNkwABAgQIECBQEQEBtCKF0A0CBAgQIECAQC4CAmgulTZOAgQIECBAgEBFBATQihRCNwgQIECAAAECuQgIoLlU2jgJECBAgAABAhUREEArUgjdIECAAAECBAjkIiCA5lJp4yRAgAABAgQIVERAAK1IIXSDAAECBAgQIJCLgACaS6WNkwABAgQIECBQEQEBtCKF0A0CBAgQIECAQC4CAmgulTZOAgQIECBAgEBFBATQihRCNwgQIECAAAECuQgIoLlU2jgJECBAgAABAhUREEArUgjdIECAAAECBAjkIiCA5lJp4yRAgAABAgQIVERAAK1IIXSDAAECBAgQIJCLgACaS6WNkwABAgQIECBQEQEBtCKF0A0CBAgQIECAQC4CAmgulTZOAgQIECBAgEBFBATQihRCNwgQIECAAAECuQgIoLlU2jgJECBAgAABAhUREEArUgjdIECAAAECBAjkIiCA5lJp4yRAgAABAgQIVERAAK1IIXSDAAECBAgQIJCLgACaS6WNkwABAgQIECBQEQEBtCKF0A0CBAgQIECAQC4CAmgulTZOAgQIECBAgEBFBATQihRCNwgQIECAAAECuQgIoLlU2jgJECBAgAABAhUREEArUgjdIECAAAECBAjkIiCA5lJp4yRAgAABAgQIVETg/wGiSeyOnIU2qwAAAABJRU5ErkJggg==" /><!-- --></p>
<p><strong>Trait response model</strong> showing the sizes of matrices for a sample containing <em>n</em> observations, <em>M</em> traits, and <em>Q</em> predictors.</p>
<p><br></p>
<div id="input-data" class="section level3">
<h3><span style="color:brown">input data</span></h3>
<p>Data contained in <code>forestTraits</code> include predictors in <code>xdata</code>, a character vector of data types in <code>traitTypes</code>, and <code>treesDeZero</code>, which contains tree biomass in de-zeroed format. Here the data are loaded, re-zeroed with <code>gjamReZero</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(repmis)
d &lt;-<span class="st"> &quot;https://github.com/jimclarkatduke/gjam/blob/master/forestTraits.RData?raw=True&quot;</span>
<span class="kw">source_data</span>(d)

xdata &lt;-<span class="st"> </span>forestTraits$xdata                          <span class="co"># n X Q</span>
types &lt;-<span class="st"> </span>forestTraits$traitTypes                     <span class="co"># 12 trait types </span>
sbyt  &lt;-<span class="st"> </span>forestTraits$specByTrait                    <span class="co"># S X 12</span>
pbys  &lt;-<span class="st"> </span><span class="kw">gjamReZero</span>(forestTraits$treesDeZero)        <span class="co"># n X S</span>
pbys  &lt;-<span class="st"> </span><span class="kw">gjamTrimY</span>(pbys,<span class="dv">5</span>)$y                         <span class="co"># at least 5 plots</span>
sbyt  &lt;-<span class="st"> </span>sbyt[<span class="kw">match</span>(<span class="kw">colnames</span>(pbys),<span class="kw">rownames</span>(sbyt)),] <span class="co"># trait matrix matches ydata</span>
<span class="kw">identical</span>(<span class="kw">rownames</span>(sbyt),<span class="kw">colnames</span>(pbys))</code></pre></div>
<p>The matrix <code>pbys</code> holds biomass values for species, rounded off to reduce storage. The first six columns of <code>sbyt</code> are centered and standardized. The three ordinal classes are integer values, but do not represent an absolute scale (see below). The three groups of categorical variables in <code>data.frame sbyt</code> have different numbers of levels shown here:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(sbyt$leaf)      <span class="co"># four levels</span>

<span class="kw">table</span>(sbyt$xylem)     <span class="co"># diffuse/tracheid vs ring-porous</span>

<span class="kw">table</span>(sbyt$repro)     <span class="co"># two levels</span></code></pre></div>
<p>These species traits are translated into community-weighted means and modes (CWMM) by the function <code>gjamSpec2Trait</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp         &lt;-<span class="st"> </span><span class="kw">gjamSpec2Trait</span>(pbys, sbyt, types)
tTypes      &lt;-<span class="st"> </span>tmp$traitTypes                  <span class="co"># M = 15 values</span>
u           &lt;-<span class="st"> </span>tmp$plotByCWM                   <span class="co"># n X M</span>
censor      &lt;-<span class="st"> </span>tmp$censor                      <span class="co"># (0, 1) censoring, two-level CAT's</span>
specByTrait &lt;-<span class="st"> </span>tmp$specByTrait                 <span class="co"># S X M</span>
M           &lt;-<span class="st"> </span><span class="kw">ncol</span>(u)
n           &lt;-<span class="st"> </span><span class="kw">nrow</span>(u)
types                                          <span class="co"># 12 individual trait types</span>
<span class="kw">cbind</span>(<span class="kw">colnames</span>(u),tTypes)                      <span class="co"># M trait names and types</span></code></pre></div>
</div>
<div id="traits-by-species" class="section level3">
<h3><span style="color:brown">traits by species</span></h3>
<p>Note the change in data types by comparing <code>types</code> for individuals of a species with <code>tTypes</code> for CWMM values at the plot scale. At the plot scale <code>tTypes</code> has <span class="math inline">\(M = 15\)</span> values, because the leaf <code>'CAT'</code> group in <code>types</code> includes four levels, which are expanded to four <code>'FC'</code> columns in <code>u</code>. The two-level groups <code>'xylem'</code> and <code>'repro'</code> are transformed to censored continuous values on (0, 1) and thus each occupy a single column in <code>u</code>.</p>
<p>As discussed in Clark (2016) the interpretation of CWMM values in <code>u</code> is not the same as the interpretation of species-level traits assigned in <code>forestTraits$specByTrait</code>. Let <span class="math inline">\(\mathbf{T'}\)</span> be a species-by-traits matrix <code>specByTrait</code>, constructed as CWMM values in function <code>gjamSpec2Trait</code>. The row names of <code>specByTrait</code> match the column names for the <span class="math inline">\(n \times S\)</span> species abundance matrix <code>plotByTrees</code>. The latter is referenced to individuals of a species.</p>
<p>The plot-by-trait matrix <code>u</code> is referenced to a location, i.e., one row in matrix <code>u</code>. It is a CWMM, with values derived from measurements on individual trees, but combined to produce a weighted value for each location. Ordinal traits (<code>shade</code>, <code>drought</code>, <code>flood</code>) are community weighted modes, because ordinal scores cannot be averaged. The CWMM value for a plot may not be the same data type as the trait measured on an individual tree <code>sbyt</code>. Here is a table of 15 columns in <code>u</code>:</p>
<table style="width:100%;">
<colgroup>
<col width="16%"></col>
<col width="16%"></col>
<col width="26%"></col>
<col width="39%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center">trait</th>
<th align="center"><code>typeName</code></th>
<th align="center">partition</th>
<th align="left">comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><code>gmPerSeed</code></td>
<td align="center"><code>CON</code></td>
<td align="center"><span class="math inline">\((-\infty, \infty)\)</span></td>
<td align="left">centered, standardized</td>
</tr>
<tr class="even">
<td align="center"><code>maxHt</code></td>
<td align="center"><code>CON</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="odd">
<td align="center"><code>leafN</code></td>
<td align="center"><code>CON</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="even">
<td align="center"><code>leafP</code></td>
<td align="center"><code>CON</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="odd">
<td align="center"><code>SLA</code></td>
<td align="center"><code>CON</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="even">
<td align="center"><code>woodSG</code></td>
<td align="center"><code>CON</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="odd">
<td align="center"><code>shade</code></td>
<td align="center"><code>OC</code></td>
<td align="center"><span class="math inline">\((-\infty, 0, p_{s1}, p_{s2}, p_{s3}, p_{s4}, \infty)\)</span></td>
<td align="left">five tolerance bins</td>
</tr>
<tr class="even">
<td align="center"><code>drought</code></td>
<td align="center"><code>OC</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="odd">
<td align="center"><code>flood</code></td>
<td align="center"><code>OC</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="even">
<td align="center"><code>leaf_broaddeciduous</code></td>
<td align="center"><code>FC</code></td>
<td align="center"><span class="math inline">\((-\infty, 0, 1, \infty)\)</span></td>
<td align="left">categorical traits become FC data as CWMs</td>
</tr>
<tr class="odd">
<td align="center"><code>leaf_broadevergreen</code></td>
<td align="center"><code>FC</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="even">
<td align="center"><code>leaf_needleevergreen</code></td>
<td align="center"><code>FC</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="odd">
<td align="center"><code>leaf_other</code></td>
<td align="center"><code>FC</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
<tr class="even">
<td align="center"><code>repro_monoecious</code></td>
<td align="center"><code>CA</code></td>
<td align="center"><span class="math inline">\((-\infty, 0, 1, \infty)\)</span></td>
<td align="left">two categories become continuous (censored)</td>
</tr>
<tr class="odd">
<td align="center"><code>xylem_ring</code></td>
<td align="center"><code>CA</code></td>
<td align="center">“</td>
<td align="left">“</td>
</tr>
</tbody>
</table>
<p>The first six <code>CON</code> variables are continuous, centered, and standardized, as is often done in trait studies. In gjam <code>CON</code> is the only data type that is not assumed to be censored at zero.</p>
<p>The three <code>OC</code> variables are ordinal classes, lacking an absolute scale–the partition must be estimated.</p>
<p>The four fractional composition <code>FC</code> columns are the levels of the single <code>CAT</code> variable <code>leaf</code>, expanded by the function <code>gjamSpec2Trait</code>.</p>
<p>The last two traits in <code>u</code> are fractions with two classes, only one of which is included here. They are censored at both 0 and 1, the intervals <span class="math inline">\((-\infty, 0)\)</span> and <span class="math inline">\((1, \infty)\)</span>. This censoring can be generated using <code>gjamCensorY</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">censorList    &lt;-<span class="st"> </span><span class="kw">gjamCensorY</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">intervals =</span> <span class="kw">cbind</span>( <span class="kw">c</span>(-<span class="ot">Inf</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="ot">Inf</span>) ), 
                             <span class="dt">y =</span> u, <span class="dt">whichcol =</span> <span class="kw">c</span>(<span class="dv">13</span>:<span class="dv">14</span>))$censor</code></pre></div>
<p>This censoring was already done with <code>gjamSpec2Trait</code>, which knows to treat <code>'CAT'</code> data with only two levels as censored <code>'CA'</code> data. In this case the <code>values = c(0,1)</code> indicates that zeros and ones in the data indicate censoring. The <code>intervals</code> matrix gives their ranges.</p>
</div>
<div id="factors-in-this-example" class="section level3">
<h3><span style="color:brown">factors in this example</span></h3>
<p>Multilevel factors in <code>xdata</code> require some interpretation. If you have not worked with multilevel factors, refer to the R <code>help</code> page for <code>factor</code>. The interpretation of coefficients for multilevel factors depends on the reference level used to construct a <em>contrasts</em> matrix. Standard models in R assign contrasts that may not assume the reference level that is desired. Moreover, if the reference is unspecified, it depends on on the order of observations and variables in the data.</p>
<p>In <code>xdata</code> the variable <code>soil</code> is a multilevel factor, which includes soil types that are both common and have potentially strong effects. Here are the first few rows of <code>xdata</code>:</p>
<p>I used the name <code>reference</code> for a soil type to aggregate types that are rare. Factor levels that rarely occur cannot be estimated in the model.</p>
<p>The R function <code>relevel</code> allows definition of a reference level. In this case I want to compare levels to the reference soil type <code>reference</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xdata$soil &lt;-<span class="st"> </span><span class="kw">relevel</span>(xdata$soil,<span class="st">'reference'</span>)</code></pre></div>
<p>To avoid confusion, contrasts can be inspected as <code>output$modelSummary$contrasts</code>. If the reference class is all zeros and other classes are zeros and ones, then the intercept is the reference class.</p>
</div>
<div id="trm-analysis" class="section level3">
<h3><span style="color:brown">TRM analysis</span></h3>
<p>Here is an analysis of the data, with 20 holdout plots. Predictors in <code>xdata</code> are winter temperature (<code>temp</code>), slope (<code>f1</code>), aspect (<code>f2</code>, <code>f3</code>), local <code>moisture</code>, climatic moisture <code>deficit</code> and <code>soil</code>.</p>
<p><span class="math display">\[[f_{i,1}, f_{i,2}, f_{i,3}]' = [sin(slope_{i}), sin(slope_{i})sin(aspect_{i}), sin(slope_{i})cos(aspect_{i})]'\]</span></p>
<p>(Clark 1990). As discussed above, the variable <code>soil</code> is a multi-level factor. Because slope and aspect variables are products (interactions) I do not standardize them, including them in <code>notStandard</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">3000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> tTypes, <span class="dt">holdoutN =</span> <span class="dv">20</span>,
            <span class="dt">censor=</span>censor, <span class="dt">notStandard =</span> <span class="kw">c</span>(<span class="st">'f1'</span>,<span class="st">'f2'</span>,<span class="st">'f3'</span>))
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(~<span class="st"> </span>temp +<span class="st"> </span>stdage +<span class="st"> </span>moisture*deficit +<span class="st"> </span>deficit*soil, 
                 <span class="dt">xdata =</span> xdata, <span class="dt">ydata =</span> u, <span class="dt">modelList =</span> ml)
tnames &lt;-<span class="st"> </span><span class="kw">colnames</span>(u)
sc &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">'black'</span>, M)                           <span class="co"># highlight types</span>
wo &lt;-<span class="st"> </span><span class="kw">which</span>(tnames %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;leafN&quot;</span>,<span class="st">&quot;leafP&quot;</span>,<span class="st">&quot;SLA&quot;</span>) )     <span class="co"># foliar traits</span>
wf &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;leaf&quot;</span>,tnames)                              <span class="co"># leaf habit</span>
wc &lt;-<span class="st"> </span><span class="kw">which</span>(tnames %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;woodSG&quot;</span>,<span class="st">&quot;diffuse&quot;</span>,<span class="st">&quot;ring&quot;</span>) ) <span class="co"># wood anatomy</span>

sc[wc] &lt;-<span class="st"> 'brown'</span>
sc[wf] &lt;-<span class="st"> 'darkblue'</span>
sc[wo] &lt;-<span class="st"> 'darkgreen'</span>

pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">GRIDPLOTS =</span> <span class="ot">TRUE</span>, <span class="dt">PLOTALLY =</span> T, <span class="dt">specColor =</span> sc, <span class="dt">SMALLPLOTS =</span> F)
fit &lt;-<span class="st"> </span><span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, <span class="dt">plotPars =</span> pl)
<span class="kw">summary</span>(out)</code></pre></div>
<p>The model fit is interpreted in the same way as other gjam analyses. Note that <code>specColor</code> is used to highlight different types of traits in the posterior plots for values in coefficient matrix <span class="math inline">\(\mathbf{A}\)</span>. Parameter estimates are contained in <code>parameters</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out$parameters$betaMuUn      <span class="co"># Q by M coefficient matrix alpha</span>
out$parameters$betaSeUn      <span class="co"># Q by M coefficient std errors</span>
out$parameters$sigMu         <span class="co"># M by M covariance matrix omega</span>
out$parameters$sigSe         <span class="co"># M by M covariance std errors</span></code></pre></div>
<p>The <code>output</code> list contains a large number of diagnostics explained in help pages.</p>
<p>The object <code>fit</code> generated by <code>gjamPlot</code> holds coefficients that are summarized in a table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit$summaryCoeffs$betaCoeff[<span class="dv">1</span>:<span class="dv">5</span>,]      <span class="co"># Q by M coefficient matrix alpha</span></code></pre></div>
<p>The matrices <code>out$parameters$cutMu</code> and <code>out$parameters$cutSe</code> hold the estimates for the partion for ordinal (<code>'OC'</code>) variables shade, drought, and flood tolerance. Each has three fitted cutpoints, because the first is fixed, with three estimates to partition the remaining four intervals.</p>
</div>
<div id="interactions-and-indirect-effects-1" class="section level3">
<h3><span style="color:brown">interactions and indirect effects</span></h3>
<p>Consider the interactions and indirect effects for this model. If there are no interactions in the <code>formula</code> passed to <code>gjam</code>, then there will be no interactions to estimate with the function <code>gjamIIE</code> (there will still be indirect effects, discussed below). If there are interactions in the <code>formula</code>, I must specify the values for main effects that are involved in these interactions to be used for estimating their effects on predictions. For example, consider a model containing the interaction between predictors <span class="math inline">\(q\)</span> and <span class="math inline">\(q'\)</span>,</p>
<p><span class="math display">\[E[y_{s}] = \cdots + \beta_{q,s}x_{q} + \beta_{q',s}x_{q'} + \beta_{qq',s}x_{q}x_{q'} + \cdots\]</span></p>
<p>The ‘effect’ of predictor <span class="math inline">\(x_{q}\)</span> on <span class="math inline">\(y_{s}\)</span> is the derivative</p>
<p><span class="math display">\[\frac{dy_{s}}{dx_{q}} = \beta_{q,s} + \beta_{qq',s}x_{q'}\]</span></p>
<p>which depends not on <span class="math inline">\(x_{q}\)</span>, but rather on <span class="math inline">\(x_{q'}\)</span>. So if I want to know how interactions affect the response I have to decide on values for all of the predictors that are involved in interactions. These values are passed to <code>gjamIIE</code> in <code>xvector</code>. The default has <code>sdScaleX = F</code>, which means that effects can be compared on the basis of variation in <span class="math inline">\(\mathbf{X}\)</span>.</p>
<p>In this example interactions involve <code>moisture</code>, <code>deficit</code>, and the multi-level factor <code>soil</code>, as specified in the <code>formula</code> passed to <code>gjam</code>. The first row of the design matrix is used with <code>moisture</code> and <code>deficit</code> set to -1 or +1 standard deviation to compare dry and wet sites in a dry climate:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xdrydry &lt;-<span class="st"> </span>xwetdry  &lt;-<span class="st"> </span>out$inputs$x[<span class="dv">1</span>,]
xdrydry[<span class="st">'moisture'</span>] &lt;-<span class="st"> </span>xdrydry[<span class="st">'deficit'</span>] &lt;-<span class="st"> </span>-<span class="dv">1</span>
xwetdry[<span class="st">'moisture'</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
xwetdry[<span class="st">'deficit'</span>]  &lt;-<span class="st"> </span>-<span class="dv">1</span></code></pre></div>
<p>The first observation is from the reference soil level <code>reference</code>, so all other soil classes are zero. Here is a plot of main effects and interactions for deciduous and evergreen traits:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">bty=</span><span class="st">'n'</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), 
    <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">tcl =</span> -<span class="fl">0.5</span>, <span class="dt">mgp =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">family=</span><span class="st">''</span>)

fit1 &lt;-<span class="st"> </span><span class="kw">gjamIIE</span>(<span class="dt">output =</span> out, <span class="dt">xvector =</span> xdrydry)
fit2 &lt;-<span class="st"> </span><span class="kw">gjamIIE</span>(<span class="dt">output =</span> out, <span class="dt">xvector =</span> xwetdry)

<span class="kw">gjamIIEplot</span>(fit1, <span class="dt">response =</span> <span class="st">'leafbroaddeciduous'</span>, 
            <span class="dt">effectMu =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'int'</span>), <span class="dt">effectSd =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'int'</span>), 
            <span class="dt">legLoc =</span> <span class="st">'bottomleft'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-.<span class="dv">31</span>,.<span class="dv">3</span>))
<span class="kw">title</span>(<span class="st">'deciduous'</span>)
<span class="kw">gjamIIEplot</span>(fit1, <span class="dt">response =</span> <span class="st">'leafneedleevergreen'</span>, 
            <span class="dt">effectMu =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'int'</span>), <span class="dt">effectSd =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'int'</span>), 
            <span class="dt">legLoc =</span> <span class="st">'bottomleft'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-.<span class="dv">3</span>,.<span class="dv">3</span>))
<span class="kw">title</span>(<span class="st">'evergreen'</span>)

<span class="kw">gjamIIEplot</span>(fit2, <span class="dt">response =</span> <span class="st">'leafbroaddeciduous'</span>, 
            <span class="dt">effectMu =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'int'</span>), <span class="dt">effectSd =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'int'</span>), 
            <span class="dt">legLoc =</span> <span class="st">'bottomleft'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-.<span class="dv">3</span>,.<span class="dv">3</span>))
<span class="kw">gjamIIEplot</span>(fit2, <span class="dt">response =</span> <span class="st">'leafneedleevergreen'</span>, 
            <span class="dt">effectMu =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'int'</span>), <span class="dt">effectSd =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'int'</span>), 
            <span class="dt">legLoc =</span> <span class="st">'bottomleft'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-.<span class="dv">3</span>,.<span class="dv">3</span>))</code></pre></div>
<p>The main effects plotted in the graphs do not depend on the values in <code>xvector</code>. Although this observation is taken from the <code>reference</code> soil, the plot shows the main effects that would be obtained if it were on the different soils included in the model. The interactions show how the effect of each predictor is modified by interactions with other variables. Again, the interactions from each predictor do not depend on values for the predictor itself, but rather on the other variables with which it interacts. For example, the interaction effect of <code>soilUltKan</code> on the <code>broaddeciduous</code> trait is positive on dry sites in dry climates (top left). Combined with a negative main effect, this means that deciduous trees tend to be more abundance on moist sites in this soil type. Its main effect on <code>leafneedleevergreen</code> is positive, but less so on moist sites in dry climates (bottom right).</p>
<p>The indirect effects come from the effects of responses. This example shows indirect effects for foliar N and P that come through <code>broaddeciduous</code> leaf habit:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xvector &lt;-<span class="st"> </span>out$inputs$x[<span class="dv">1</span>,]
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">bty=</span><span class="st">'n'</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), 
    <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">tcl =</span> -<span class="fl">0.5</span>, <span class="dt">mgp =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">family=</span><span class="st">''</span>)

omitY &lt;-<span class="st"> </span><span class="kw">colnames</span>(u)[<span class="kw">colnames</span>(u) !=<span class="st"> 'leafbroaddeciduous'</span>] <span class="co"># omit all but deciduous</span>

fit &lt;-<span class="st"> </span><span class="kw">gjamIIE</span>(out, xvector)
<span class="kw">gjamIIEplot</span>(fit, <span class="dt">response =</span> <span class="st">'leafP'</span>, <span class="dt">effectMu =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'ind'</span>), 
            <span class="dt">effectSd =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'ind'</span>), <span class="dt">legLoc =</span> <span class="st">'topright'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-.<span class="dv">6</span>,.<span class="dv">6</span>))
<span class="kw">title</span>(<span class="st">'foliar P'</span>)
<span class="kw">gjamIIEplot</span>(fit, <span class="dt">response =</span> <span class="st">'leafN'</span>, <span class="dt">effectMu =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'ind'</span>), 
            <span class="dt">effectSd =</span> <span class="kw">c</span>(<span class="st">'main'</span>,<span class="st">'ind'</span>), <span class="dt">legLoc =</span> <span class="st">'bottomright'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-.<span class="dv">6</span>,.<span class="dv">6</span>))
<span class="kw">title</span>(<span class="st">'foliar N'</span>)</code></pre></div>
<p>There will always be indirect effects, because they come through the covariance matrix.</p>
</div>
</div>
<div id="predictive-trait-model-ptm" class="section level2">
<h2><span style="color:teal">predictive trait model (PTM)</span></h2>
<p>The PTM models species abundance data, then predicts traits. This approach has a number of advantages over TRM discussed in Clark (2016). The response is the <span class="math inline">\(n \times S\)</span> matrix <span class="math inline">\(\mathbf{Y}\)</span>, which could be counts, biomass, and so forth.</p>
<div id="start-with-species-abundance" class="section level3">
<h3><span style="color:brown">start with species abundance</span></h3>
<p>PTM is based on species abundance, but includes trait data for CWMM prediction. On the latent scale the observation is represented by a composition (<code>'FC'</code> or <code>'CC'</code>) vector,</p>
<p><span class="math display">\[\mathbf{w}_{i} \sim MVN(\mathbf{B'}\mathbf{x}_{i},\Sigma)\]</span></p>
<p>where <span class="math inline">\(\mathbf{B}\)</span> is the <span class="math inline">\(Q \times S\)</span> matrix of coefficients, and <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is the <span class="math inline">\(S \times S\)</span> residual covariance. A predictive distribution on the trait scale is obtained as a <em>variable change</em>,</p>
<p><span class="math display">\[\mathbf{A} = \mathbf{B}\mathbf{T}\]</span> <span class="math display">\[\boldsymbol{\Omega} = \mathbf{T'}\boldsymbol{\Sigma}\mathbf{T}\]</span> <span class="math display">\[\mathbf{u}_{i} = \mathbf{T'}\mathbf{w}_{i}\]</span></p>
<p>where <span class="math inline">\(\mathbf{T}\)</span> is a <span class="math inline">\(S \times M\)</span> matrix of trait values for each species, <span class="math inline">\(\mathbf{A}\)</span> is the <span class="math inline">\(Q \times M\)</span> matrix of coefficients, and <span class="math inline">\(\boldsymbol{\Omega}\)</span> is the <span class="math inline">\(M \times M\)</span> residual covariance (diagram below).</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>The predictive trait model</strong> fits species data and predicts traits using the species-by-trait matrix <strong>T</strong>, contained in the object <code>specbyTrait</code>. The white boxes are fitted, with trait matrix <strong>U</strong>, and coefficient matrix <span class="math inline">\(\boldsymbol{\alpha'}\)</span> obtained by variable change.</p>
<p><br></p>
<p>The PTM begins by fitting <code>pbys</code>, followed by predicting <code>plotByTraits</code>. This requires a <code>traitList</code>, which defines the objects needed for prediction. The species are weights, so they should be modeled as composition data, eight <code>'FC'</code> (rows sum to 1) or <code>'CC'</code>. Here the model is fitted with dimension reduction:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">plotByTrait =</span> u, <span class="dt">traitTypes =</span> tTypes, <span class="dt">specByTrait =</span> specByTrait)
rl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">r =</span> <span class="dv">8</span>, <span class="dt">N =</span> <span class="dv">25</span>)
ml  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ng =</span> <span class="dv">2000</span>, <span class="dt">burnin =</span> <span class="dv">500</span>, <span class="dt">typeNames =</span> <span class="st">'CC'</span>, <span class="dt">holdoutN =</span> <span class="dv">20</span>,
                  <span class="dt">traitList =</span> tl, <span class="dt">reductList =</span> rl)
out &lt;-<span class="st"> </span><span class="kw">gjam</span>(~<span class="st"> </span>temp +<span class="st"> </span>stdage +<span class="st"> </span>deficit*soil, <span class="dt">xdata =</span> xdata, 
                     <span class="dt">ydata =</span> pbys, <span class="dt">modelList =</span> ml)
S  &lt;-<span class="st"> </span><span class="kw">nrow</span>(specByTrait)
sc &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">'black'</span>,S)

wr &lt;-<span class="st"> </span><span class="kw">which</span>(specByTrait[,<span class="st">'ring'</span>] ==<span class="st"> </span><span class="dv">1</span>)                  <span class="co"># ring porous</span>
wb &lt;-<span class="st"> </span><span class="kw">which</span>(specByTrait[,<span class="st">'leafneedleevergreen'</span>] ==<span class="st"> </span><span class="dv">1</span>)   <span class="co"># evergreen</span>
ws &lt;-<span class="st"> </span><span class="kw">which</span>(specByTrait[,<span class="st">'shade'</span>] &gt;=<span class="st"> </span><span class="dv">4</span>)                 <span class="co"># shade tolerant</span>
sc[wr] &lt;-<span class="st"> 'brown'</span>
sc[ws] &lt;-<span class="st"> 'black'</span>
sc[wb] &lt;-<span class="st"> 'darkgreen'</span>
         
<span class="kw">par</span>(<span class="dt">family =</span> <span class="st">''</span>)
pl  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">width=</span><span class="dv">4</span>, <span class="dt">height=</span><span class="dv">4</span>, <span class="dt">CORLINES=</span>F, <span class="dt">SMALLPLOTS=</span>F,<span class="dt">GRIDPLOTS=</span>T,
                  <span class="dt">specColor =</span> sc, <span class="dt">ncluster =</span> <span class="dv">5</span>) 
fit &lt;-<span class="st"> </span><span class="kw">gjamPlot</span>(<span class="dt">output =</span> out, pl)</code></pre></div>
<p>Output is interpreted as previously, now with coefficients <span class="math inline">\(\mathbf{B}\)</span> and covariance <span class="math inline">\(\boldsymbol{\Sigma}\)</span>. gjamPlot generates an additional plot with trait predictions. Parameter values are here:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out$parameters$betaTraitMu   <span class="co"># Q by M coefficient matrix alpha</span>
out$parameters$betaTraitSe   <span class="co"># Q by M coefficient std errors</span>
out$parameters$sigmaTraitMu  <span class="co"># M by M covariance matrix omega</span>
out$parametes$sigmaTraitSe  <span class="co"># M by M covariance std errors</span></code></pre></div>
<p>Trait predictive distributions are summarized here:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out$parameters$tMu[<span class="dv">1</span>:<span class="dv">5</span>,]     <span class="co"># n by M predictive means</span>
out$parameters$tSd[<span class="dv">1</span>:<span class="dv">5</span>,]     <span class="co"># n by M predictive std errors</span></code></pre></div>
<p>The groupings of species in terms of their similar responses to the environment (the <code>ematrix</code>) are here, showing only the 4 most frequent species in each of the <code>ncluster</code> = 8 groups:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit$eComs[,<span class="dv">1</span>:<span class="dv">4</span>]</code></pre></div>
<p>Additional quantities can be predicted from the output using the MCMC output in the list <code>out$chains</code>.</p>
</div>
<div id="trouble-shooting-in-ptm" class="section level3">
<h3><span style="color:brown">trouble shooting in PTM</span></h3>
<p>When using <code>gjam</code> in predictive trait mode remember the following:</p>
<ol style="list-style-type: decimal">
<li><p><code>typeNames</code> for <code>ydata</code> data should be composition, either <code>CC</code> or <code>FC</code></p></li>
<li><p><code>nrow(plotByTrait)</code> must equal <code>nrow(ydata)</code></p></li>
<li><p><code>ncol(plotByTrait)</code> must equal <code>length(traitTypes)</code></p></li>
<li><p><code>ncol(plotByTrait)</code> must equal <code>length(traitTypes)</code></p></li>
<li><p><code>rownames(specByTrait)</code> must match <code>colnames(ydata)</code></p></li>
</ol>
<p><br></p>
</div>
</div>
</div>
<div id="selecting-variables" class="section level1">
<h1><span style="color:darkgreen">selecting variables</span></h1>
<p>In a univariate model, there is one response and perhaps a number of potential predictor variables from which to choose. Variable selection focuses on <span class="math inline">\(\mathbf{X}\)</span>. In a multivariate model, the overall fit and predictive capacity depends not only on what’s in <span class="math inline">\(\mathbf{X}\)</span>, but also on what’s in <span class="math inline">\(\mathbf{Y}\)</span>. A different combination of variables in <span class="math inline">\(\mathbf{X}\)</span> will provide the best “fit” for each combination of variables in <span class="math inline">\(\mathbf{Y}\)</span>. Given that many species may be rare, and rare types will not be explained by the model, there will be decisions about what variables to include on both sides of the likelihood.</p>
<p>These considerations mean that simple rules like ‘lowest DIC’ are not sensible. Do I want the model that best explains the subset of response variables having the most ‘signal’? Not necessarily, because many less abundant types may be of interest. Alternatively, the best model for responses ranging from rare to abundant will depend on precisely which of the rare types are included. As discussed in the section on <strong>dimension reduction</strong>, rare types also affect the coefficients for abundant types through covariance <span class="math inline">\(\boldsymbol{\Sigma}\)</span>. I often want to consider a range of variable combinations. Here are a few objects available in <code>gjam</code> output that can provide some guidance for selecting variables.</p>
<table>
<colgroup>
<col width="47%"></col>
<col width="52%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="right"><code>output</code> or <code>.pdf</code> plot file</th>
<th align="left">explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><code>output$fit$DIC</code></td>
<td align="left">Low is good</td>
</tr>
<tr class="even">
<td align="right"><code>output$inputs$designTable</code></td>
<td align="left">Redundant predictors based on high correlation and/or high VIF (&gt; 10 to 20)?</td>
</tr>
<tr class="odd">
<td align="right"><code>output$inputs$factorBeta$missFacSpec</code></td>
<td align="left">Missing predictor-response combinations listed here–consider consolidating factor levels or removing predictors and/or responses.</td>
</tr>
<tr class="even">
<td align="right"><code>output$parameters$fMu</code>, <code>sensitivity.pdf</code></td>
<td align="left">High values account for most variation across all responses.</td>
</tr>
<tr class="odd">
<td align="right"><code>betaAll.pdf</code></td>
<td align="left">Do CIs include zero for all responses?</td>
</tr>
<tr class="even">
<td align="right"><code>betaChains.pdf</code>, <code>output$chains$bgibbs</code></td>
<td align="left">Any not converged?</td>
</tr>
<tr class="odd">
<td align="right"><code>yPredAll.pdf</code></td>
<td align="left">Generated if <code>PLOTALLY = T</code> in <code>plotPars</code>; remove some responses that are not well predicted?</td>
</tr>
<tr class="even">
<td align="right"><code>yPred.pdf</code></td>
<td align="left">Model predicts responses in-sample?</td>
</tr>
<tr class="odd">
<td align="right"><code>xPred.pdf</code>, <code>xPredFactors.pdf</code></td>
<td align="left">Model inversely predicts inputs?</td>
</tr>
</tbody>
</table>
<p>To cull rare types in <span class="math inline">\(\mathbf{Y}\)</span> see the help page for <code>gjamTrimY</code>. To evaluate the model with out-of-sample prediction see the section <strong>missing data, out-of-sample prediction</strong>.</p>
<p><br></p>
</div>
<div id="trouble-shooting" class="section level1">
<h1><span style="color:darkgreen">trouble shooting</span></h1>
<p>A joint model for data sets with many response variables can be unstable for several reasons. Because the model can accommodate large, multivariate data sets, there is temptation to throw everything in and see what happens. gjam is vulnerable due to the fact that columns in <code>ydata</code> have different scales and, thus, can range over orders of magnitude. It’s best to start small, gain a feel for the data and how it translates to estimates of many coefficients and covariances. More species and predictors can be added without changing the model. The opposite approach of throwing in everything is asking for trouble and is unlikely to generate insight.</p>
<p>If a model won’t execute, start by simplifying it. Use a small number of predictors and response variables. It’s easy to add complexity later. If execution fails there are several options.</p>
<p><strong>Check <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{Y}\)</span></strong>. Most errors come from the data. If there are many species (large <span class="math inline">\(\mathbf{Y}\)</span>), some may occur once or not at all. This is easy to check with the function <code>gjamTrimY</code>. If I suspect trouble with the design matrix <span class="math inline">\(\mathbf{X}\)</span>, I can make sure it is full rank, e.g.,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(formula, xdata)
<span class="kw">qr</span>(x)$rank</code></pre></div>
<p>The rank must equal the number of columns in <code>x</code>.</p>
<p><strong>If I am simulating data</strong>, first try it again. The simulator aims to generate data that will actually work, more challenging than would be the case for a univariate simulation of a single data type. Simulated data are random, so try again.</p>
<p><strong>If the fit is bad</strong>, it could be noisy data (there is no ‘signal’), but there are other things to check. Again, insure that all columns in <code>ydata</code> include at least some non-zero values. One would not expect a univariate model to fit a data set where the response is all zeros. However, when there are many columns in <code>ydata</code>, the fact that some are never or rarely observed can be overlooked. The functions <code>hist</code>, <code>colSums</code>, and, for discrete data, <code>table</code>, can be used. The function <code>gjamTrimY(ydata, m)</code> can be used to limit <code>ydata</code> to only those columns with at least <code>m</code> non-zero observations.</p>
<p><strong>Large differences in scale</strong> in <code>ydata</code> can contribute to instability. Unlike <code>xdata</code>, where the design matrix is standardized, <code>ydata</code> is not rescaled. It is used as-is, because the user may want effort on a specific scale. However, the algorithm is most stable when responses in <code>ydata</code> do not span widely different ranges. For continuous data (<code>&quot;CA&quot;</code>, <code>&quot;CON&quot;</code>), consider changing the units in <code>ydata</code> from, say, g to kg or from g ml<span class="math inline">\(^{-1}\)</span> to g l<span class="math inline">\(^{-1}\)</span>.</p>
<p>For discrete counts (<code>&quot;DA&quot;</code>) consider changing the units for effort, e.g., m<span class="math inline">\(^{2}\)</span> versus ha or hours versus days. Recall, the dimension for the latent <span class="math inline">\(W\)</span> is <span class="math inline">\(Y/E\)</span>. If I count hundreds or thousands of animals per hour, I could consider specifying effort in minutes, thus reducing the scale for <span class="math inline">\(W\)</span> by a factor of <span class="math inline">\(1/60\)</span>. Rescaling is not relevant for <code>&quot;CC&quot;</code>, where modeling is done on the <span class="math inline">\([0, 1]\)</span> scale.</p>
<p>Unlike experiments, where attention is paid to balanced design, observational data often involve <strong>factors</strong>, for which only some species occur in all factor combinations. This inadequate distribution of data is compounded when those factors are included in interaction terms. Consider ways to eliminate factor levels/combinations that cannot be estimated from the data.</p>
<p>If a simulation fails due to a cholesky error (<span class="math inline">\(\boldsymbol{\Sigma}\)</span> is not positive definite), consider either reducing the number of columns in <code>ydata</code> or implementing dimension reduction (see the gjam vignette on this subject).</p>
<p><br></p>
</div>
<div id="reference-notes" class="section level1">
<h1><span style="color:darkgreen">reference notes</span></h1>
<div id="model-summary-1" class="section level2">
<h2><span style="color:teal">model summary</span></h2>
<p>An observation consists of environmental variables and species attributes, <span class="math inline">\(\lbrace \mathbf{x}_{i}, \mathbf{y}_{i}\rbrace\)</span>, <span class="math inline">\(i = 1,..., n\)</span>. The vector <span class="math inline">\(\mathbf{x}_{i}\)</span> contains predictors <span class="math inline">\(x_{iq}: q = 1,..., Q\)</span>. The vector <span class="math inline">\(\mathbf{y}_{i}\)</span> contains attributes (responses), such as species abundance, presence-absence, and so forth, <span class="math inline">\(y_{is}: s = 1,..., S\)</span>. The effort <span class="math inline">\(E_{is}\)</span> invested to obtain the observation of response <span class="math inline">\(s\)</span> at location <span class="math inline">\(i\)</span> can affect the observation. The combinations of continuous and discrete measurements in observed <span class="math inline">\(\mathbf{y}_{i}\)</span> motivate the three elements of <code>gjam</code>.</p>
<p>A length-<span class="math inline">\(S\)</span> vector <span class="math inline">\(\mathbf{w}_{i}\in{\Re}^S\)</span> represents response <span class="math inline">\(\mathbf{y}_i\)</span> in continuous space. This continuous space allows for the dependence structure with a covariance matrix. An element <span class="math inline">\(w_{is}\)</span> can be known (e.g., continuous response <span class="math inline">\(y_{is}\)</span>) or unknown (e.g., discrete responses).</p>
<p>A length-<span class="math inline">\(S\)</span> vector of integers <span class="math inline">\(\mathbf{z}_{i}\)</span> represents <span class="math inline">\(\mathbf{y}_i\)</span> in discrete space. Each observed <span class="math inline">\(y_{is}\)</span> is assigned to an interval <span class="math inline">\(z_{is} \in \{0,...,K_{is}\}\)</span>. The number of intervals <span class="math inline">\(K_{is}\)</span> can differ between observations and between species, because each species can be observed in different ways.</p>
<p>The partition of continuous space at points <span class="math inline">\(p_{is,z} \in{\mathcal{P}}\)</span> defines discrete intervals <span class="math inline">\(z_{is}\)</span>. Two values <span class="math inline">\((p_{is,k}, p_{is,k+1}]\)</span> bound the <span class="math inline">\(k^{th}\)</span> interval of <span class="math inline">\(s\)</span> in observation <span class="math inline">\(i\)</span>. Intervals are contiguous and provide support over the real line <span class="math inline">\((-\infty, \infty)\)</span>. For discrete observations, <span class="math inline">\(k\)</span> is a censored interval, and <span class="math inline">\(w_{is}\)</span> is a latent variable. The set of censored intervals is <span class="math inline">\(\mathcal{C}\)</span>. The partition set <span class="math inline">\(\mathcal{P}\)</span> can include both known (discrete counts, including composition data) and unknown (ordinal, categorical) points.</p>
<p>An observation <span class="math inline">\(y\)</span> maps to <span class="math inline">\(w\)</span>,</p>
<p><span class="math display">\[y_{is} = \left \{
\begin{matrix}
\ w_{is} &amp; continuous\\
\ z_{is}, &amp; w_{is} \in (p_{z_{is}}, p_{z_{is} + 1}] &amp; discrete
\end{matrix}
\right.\]</span></p>
<p>Effort <span class="math inline">\(E_{is}\)</span> affects the partition for discrete data. For the simple case where there is no error in the assignment of discrete intervals, <span class="math inline">\(\mathbf{z}_i\)</span> is known, and the model for <span class="math inline">\(\mathbf{w}_i\)</span> is</p>
<p><span class="math display">\[\mathbf{w}_i|\mathbf{x}_i, \mathbf{y}_i, \mathbf{E}_i \sim MVN(\boldsymbol{\mu}_i,\boldsymbol{\Sigma}) \times \prod_{s=1}^S\mathcal{I}_{is}\]</span> <span class="math display">\[\boldsymbol{\mu}_i = \mathbf{B}'\mathbf{x}_i\]</span> <span class="math display">\[\mathcal{I}_{is} = \prod_{k \in \mathcal{C}}I_{is,k}^{I(y_{is} = k)} (1 - I_{is,k})^{I(y_{is} \neq k)}\]</span></p>
<p>where <span class="math inline">\(I_{is} =I(p_{z_{is}} &lt; w_{is} &lt; p_{z_{is} + 1}]\)</span>, <span class="math inline">\(\mathcal{C}\)</span> is the set of discrete intervals, <span class="math inline">\(\mathbf{B}\)</span> is a <span class="math inline">\(Q \times S\)</span> matrix of coefficients, and <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is a <span class="math inline">\(S \times S\)</span> covariance matrix. There is a correlation matrix associated with <span class="math inline">\(\boldsymbol{\Sigma}\)</span>,</p>
<p><span class="math display">\[\mathbf{R}_{s,s'} = \frac{\boldsymbol{\Sigma}_{s,s'}}{\sqrt{\boldsymbol{\Sigma}_{s,s} \boldsymbol{\Sigma}_{s',s'}}}\]</span></p>
<p>For <strong>presence-absence</strong> (binary) data, <span class="math inline">\(\mathbf{p}_{is} = (-\infty, 0, \infty)\)</span>. This is equivalent to Chib and Greenberg’s (2008) model, which could be written <span class="math inline">\(\mathcal{I}_{is} = I(w_{is} &gt; 0)^{y_{is}}I(w_{is} \leqslant 0)^{1 - y_{is}}\)</span>.</p>
<p>For a continous variable with point mass at zero, <strong>continuous abundance</strong>, this is a multivariate Tobit model, with <span class="math inline">\(\mathcal{I}_{is} = I(w_{is} = y_{is})^{I(y_{is} &gt; 0)}I(w_{is} \leqslant 0)^{I(y_{is} = 0)}\)</span>. This is the same partition used for the probit model, the difference being that the positive values in the Tobit are uncensored.</p>
<p><strong>Categorical</strong> responses fit within the same framework. Each categorical response occupies as many columns in <span class="math inline">\(\mathbf{Y}\)</span> as there are independent levels in response <span class="math inline">\(s\)</span>, levels being <span class="math inline">\(k = 1,..., K_{s}-1\)</span>. For example, if randomly sampled plots are scored by one of five cover types, then there are four columns in <span class="math inline">\(\mathbf{Y}\)</span> for the response <span class="math inline">\(s\)</span>. The four columns can have at most one <span class="math inline">\(1\)</span>. If all four columns are <span class="math inline">\(0\)</span>, then the reference level is observed. The observed level has the largest value of <span class="math inline">\(w_{is,k}\)</span> (Table 1). This is similar to Zhang et al.’s (2008) model for categorical data.</p>
<p>For <strong>ordinal counts</strong> gjam is Lawrence et al.’s (2008) model having the partition <span class="math inline">\(\mathbf{p}_{is} = (-\infty, 0, p_{is,2}, p_{is,3},..., p_{is,K}, \infty)\)</span>, where all but the first two and the last elements must be inferred. The partition must be inferred, because the ordinal scale is only relative.</p>
<p>Like categorical data, <strong>composition</strong> data have one reference class. For this and other <strong>discrete count</strong> data, the partition for observation <span class="math inline">\(i\)</span> can be defined to account for sample effort (next section).</p>
</div>
<div id="more-on-parameter-dimensions" class="section level2">
<h2><span style="color:teal">more on parameter dimensions</span></h2>
<p>Unlike a univariate model that has one <span class="math inline">\(Y\)</span> per observation or multivariate models where all <span class="math inline">\(Y\)</span>’s have the same dimension, gjam has <span class="math inline">\(Y\)</span>’s on multiple dimensions. So there are two sets of dimensions to consider, the dimensions for the <span class="math inline">\(X\)</span>’s and those for the <span class="math inline">\(Y\)</span>’s. To avoid more notation I just refer to the dimension of a coefficient in the unstandardized coefficient matrix <span class="math inline">\(\mathbf{B}_u\)</span> as <span class="math inline">\(W/X\)</span> (Table 2). Except for responses that have no dimension (presence-absence, ordinal, categorical) <span class="math inline">\(W\)</span> has the same dimension as <span class="math inline">\(Y\)</span> (or <span class="math inline">\(Y/E\)</span>, if effort is specified). <code>gjam</code> returns unstandardized coefficients in tables <code>parameters$betaMuUn, parameters$betaSeUn</code>, and in MCMC <code>chains$bgibbsUn</code>, because they are not prone to be misinterpreted by a user who has supplied unstandardized predictors in <code>xdata</code>. I refer to the coefficient matrix as <span class="math inline">\(\mathbf{B}_u\)</span> and corresponding unstandardized design matrix as <span class="math inline">\(\mathbf{X}_u\)</span>. Each row of <code>$chains$bgibbsUn</code> is one draw from the <span class="math inline">\(Q \times S\)</span> matrix <span class="math inline">\(\mathbf{B}_u\)</span>.</p>
<p>Models are commonly fitted to covariates <span class="math inline">\(X\)</span> that are ‘standardized’ for mean and variance. Standardization can stabilize posterior simulation. It is desirable when coefficients are needed in standard deviations. Inside <code>gjam</code> design matrix <span class="math inline">\(\mathbf{X}\)</span>, and thus <span class="math inline">\(\mathbf{B}\)</span>, are standardized, thus having dimension <span class="math inline">\(W\)</span>, not <span class="math inline">\(W/X\)</span>. Of course, for variables in <code>xdata</code> supplied in standarized form, <span class="math inline">\(\mathbf{B} = \mathbf{B}_u\)</span>. See <strong>Algorithm summary</strong>. Variables returned by <code>gjam</code>, including MCMC chains in <code>$chains$bgibbs</code> and posterior means and standard errors <code>$parameters$betaMu</code> and <code>$parameters$betaSe</code> are standardized.</p>
<p>The third set of scales comes from the correlation scale for the <span class="math inline">\(W\)</span>’s. The correlation scale can be useful when considering responses that have different dimensions. In addition to <span class="math inline">\(\mathbf{B}_u\)</span> I provide parameters on the correlation scale. This correlation scale is <span class="math inline">\(\mathbf{B}_r = \mathbf{B} \mathbf{D}^{-1/2}\)</span>, where <span class="math inline">\(\mathbf{D} = diag(\boldsymbol{\Sigma})\)</span>. If <span class="math inline">\(\mathbf{X}\)</span> is standardized, <span class="math inline">\(\mathbf{B}_r\)</span> is dimensionless. The MCMC chains in <code>$chains$fbgibbs</code> and the estimates in <code>$parameterTable$fBetaMu</code> and <code>$parameterTable$fBetaSd</code> are standardized for <span class="math inline">\(X\)</span> (standard deviation scale) and for <span class="math inline">\(W\)</span> (correlation scale). They are dimensionless.</p>
<p>For sensitivity over all species and for comparisons between predictors I provide standardized sensitivity in a length-<span class="math inline">\(Q\)</span> vector <span class="math inline">\(\mathbf{f}\)</span>. The sensitivity matrix to <span class="math inline">\(X\)</span> across the full model is given by</p>
<p><span class="math display">\[\mathbf{F} = \mathbf{B}\boldsymbol{\Sigma}^{-1} \mathbf{B}'\]</span></p>
<p>Note that <span class="math inline">\(\mathbf{F}\)</span> takes <span class="math inline">\(\mathbf{B}_r\)</span>, not <span class="math inline">\(\mathbf{B}\)</span>, and not <span class="math inline">\(\mathbf{B}_u\)</span>. The sensitivity matrix <span class="math inline">\(\mathbf{F}\)</span> is <code>$parameters$fmatrix</code>. The sensitivity vector <span class="math inline">\(\mathbf{f} = diag( \mathbf{F} )\)</span> is <code>vector $parameters$fMu</code>. Details are given in Clark et al. (2017).</p>
</div>
<div id="more-on-factors-in-mathbfx" class="section level2">
<h2><span style="color:teal">more on factors in <span class="math inline">\(\mathbf{X}\)</span></span></h2>
<p>The coefficient matrix <span class="math inline">\(\boldsymbol{\tilde{\mathbf{B}}}\)</span> is useful when there are <strong>factors</strong> in the model. Factor treatment in <code>gjam</code> follows the convention where a reference level is taken as the overall intercept, and remaining coefficients are added to the intercept. The reference level can be controlled with the R function <code>relevel</code>. This approach makes sense in the ANOVA context, where an experiment has a control level to which other treatment levels are to be compared. A ‘significant’ level is different from the reference (e.g., control), but we are not told about its relationship to other levels. The coefficients in <code>$parameters$betaMu</code> and <code>$parameters$betaSd</code> are reported this way. Should it be needed, the contrasts matrix for this design is returned as a list for all factors in the model as <code>$inputs$factorBeta$contrast</code> and as a single contrasts matrix for the entire model as <code>$inputs$factorBeta$eCont</code>.</p>
<p>This standard structure is not the best way to compare factors in many ecological data sets, where a factor might represent soil type, cover type, fishing gear, and so on. In all of these cases there is no ‘control’ treatment. Here it is more useful to know how all levels relate to the mean taken across factor levels.</p>
<p>To provide more informative comparisons across factor levels and species I introduce a <span class="math inline">\(Q_1 \times S\)</span> recontrast matrix that translates <span class="math inline">\(\mathbf{B}\)</span>, with intercept, to all factor levels, without intercept. Consider a three-level factor with levels <code>a, b, c</code>, the first being the reference class. There is a matrix <span class="math inline">\(\mathbf{G}\)</span></p>
<pre><code>##   intercept  b  c
## a         1 -1 -1
## b         1  1  0
## c         1  0  1</code></pre>
<p>and a matrix <span class="math inline">\(\mathbf{H}\)</span>,</p>
<pre><code>##            a b c
## intercept  1 0 0
## b         -1 1 0
## c         -1 0 1</code></pre>
<p>With <span class="math inline">\(\mathbf{L'} = \mathbf{G}^{-1}\)</span>, the recontrasted coefficients are</p>
<p><span class="math display">\[\mathbf{\tilde{B}} = \mathbf{L}\mathbf{B}\]</span></p>
<p>The rows of <span class="math inline">\(\mathbf{\tilde{B}}\)</span> correspond to all factor levels. The intercept does not appear, because it has been distributed across factor levels. The corresponding design matrix is</p>
<p><span class="math display">\[\mathbf{\tilde{X}} = \mathbf{X}\mathbf{H}\]</span></p>
<p>If there are multiple factors then <span class="math inline">\(Q_1 &gt; Q\)</span>, because the intercept expands to the reference classes for each factor. <span class="math inline">\(\mathbf{L}\)</span> is provided as <code>$inputs$factorBeta$lCont</code>.</p>
<p>With factors, the sensitivity matrix reported in <code>$parameters$fmatrix</code>is</p>
<p><span class="math display">\[\mathbf{F} = \mathbf{\tilde{B}}\boldsymbol{\Sigma}^{-1} \mathbf{\tilde{B}'}\]</span></p>
<p>The response matrix in <code>$parameters$ematrix</code> is</p>
<p><span class="math display">\[\mathbf{E} = \mathbf{\tilde{B}} \mathbf{\tilde{V}} \mathbf{\tilde{B}'}\]</span></p>
<p>where <span class="math inline">\(\mathbf{\tilde{V}} = cov \left(\mathbf{X} \mathbf{H} \right)\)</span>.</p>
<p><br></p>
</div>
</div>
<div id="algorithm-summary" class="section level1">
<h1><span style="color:darkgreen">algorithm summary</span></h1>
<p>Model fitting is done by Gibbs sampling. The design matrix <span class="math inline">\(\mathbf{X}\)</span> is centered and standardized. Parameters <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\boldsymbol{\Sigma}\)</span> are sampled directly,</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\boldsymbol{\Sigma}|\mathbf{W}, \mathbf{B}\)</span></p></li>
<li><p><span class="math inline">\(\mathbf{B}| \boldsymbol{\Sigma}, \mathbf{W}\)</span></p></li>
<li><p>For unknown partition (ordinal variables) the partition is sampled, <span class="math inline">\(\mathcal{P}|\mathbf{Z}, \mathbf{W}\)</span></p></li>
<li><p>For ordinal, presence-absence, and categorical data, latent variables are drawn on the correlation scale, <span class="math inline">\(\mathbf{W}|\mathbf{R}, \boldsymbol{\alpha}, \mathbf{P}\)</span>, where <span class="math inline">\(\mathbf{R} = \mathbf{D}^{-1/2}\boldsymbol{\Sigma}\mathbf{D}^{-1/2}\)</span>, <span class="math inline">\(\boldsymbol{\alpha} = \mathbf{D}^{-1/2}\mathbf{B}\)</span>, <span class="math inline">\(\mathbf{P} = \mathbf{D}^{-1/2}\mathcal{P}\)</span>, and <span class="math inline">\(\mathbf{D} = diag(\boldsymbol{\Sigma})\)</span>.<br />
For other variables that are discrete or censored, latent variables are drawn on the covariance scale, <span class="math inline">\(\mathbf{W}| \boldsymbol{\Sigma}, \mathbf{B}, \mathcal{P}\)</span>.</p></li>
</ol>
<p>Parameters in <code>$chains$bgibbsUn</code> are returned on the original scale <span class="math inline">\(\mathbf{X}_u\)</span>. Let <span class="math inline">\(\mathbf{X}_u\)</span> be the uncentered/unstandardized version of <span class="math inline">\(\mathbf{X}\)</span>. Parameters are returned as <span class="math inline">\(\mathbf{B}_u = \left(\mathbf{X}'_u \mathbf{X}_u \right)^{-1}\mathbf{X}'_u \mathbf{X}\mathbf{B}\)</span>. Likewise, <code>$x</code> is returned on the original scale, i.e., it is <span class="math inline">\(\mathbf{X}_u\)</span>.</p>
<p>Dimension reduction represents the covariance matrix as <span class="math inline">\(\Sigma = \mathbf{A} \mathbf{A}' + \sigma^2 \mathbf{I}\)</span>. The <span class="math inline">\(S \times r\)</span> matrix <span class="math inline">\(\mathbf{A}\)</span> generates a random effect with prior distribution <span class="math inline">\(\mathbf{a}_i \sim \mathbf{A} \times MVN(\mathbf{0}_r, \mathbf{I}_r )\)</span>. The (posterior) estimate of <span class="math inline">\(\mathbf{a}_i\)</span> depends on observed <span class="math inline">\(\mathbf{y}_i\)</span>. For in-sample prediction, we have <span class="math inline">\(\mathbf{w}_i \sim MVN( \boldsymbol{\mu}_i + \mathbf{a}_i, \sigma^2 \mathbf{I})\)</span>. For out-of-sample prediction the random effect is marginalized <span class="math inline">\(\mathbf{w}_i \sim MVN( \boldsymbol{\mu}_i, \Sigma)\)</span>. For variables on the correlation scale, both the mean and the covariance are on the correlation scale.</p>
<p>Below are mean and variance for prediction sampling, where <span class="math inline">\(\boldsymbol{\mu}_i = \mathbf{B}'\mathbf{x}_i\)</span>. Values are (mean, covariance/correlation). Most importantly, for prediction, there is no partition, because <span class="math inline">\(\mathbf{y}_i\)</span> is unknown and, thus, <span class="math inline">\(\mathbf{w}_i\)</span> is unconstrained by observation:</p>
<table style="width:100%;">
<colgroup>
<col width="27%"></col>
<col width="38%"></col>
<col width="34%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center">.</th>
<th align="center">covariance scale</th>
<th align="left">correlation scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Not dimension reduction:</td>
<td align="center"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="center">in-</td>
<td align="center"><span class="math inline">\(\boldsymbol{\mu}_i, \Sigma\)</span></td>
<td align="left"><span class="math inline">\(\mathbf{D}^{-1/2} \boldsymbol{\mu}_i, \mathbf{R}\)</span></td>
</tr>
<tr class="odd">
<td align="center">out-</td>
<td align="center"><span class="math inline">\(\boldsymbol{\mu}_i, \Sigma\)</span></td>
<td align="left"><span class="math inline">\(\mathbf{D}^{-1/2} \boldsymbol{\mu}_i, \mathbf{R}\)</span></td>
</tr>
<tr class="even">
<td align="center">Dimension reduction:</td>
<td align="center">.</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="center">in-</td>
<td align="center"><span class="math inline">\(\boldsymbol{\mu}_i + \mathbf{a}_i\)</span></td>
<td align="left"><span class="math inline">\(\mathbf{D}^{-1/2} ( \boldsymbol{\mu}_i + \mathbf{a}_i), \mathbf{I}_s\)</span></td>
</tr>
<tr class="even">
<td align="center">out-</td>
<td align="center"><span class="math inline">\(\boldsymbol{\mu}_i, \Sigma\)</span></td>
<td align="left"><span class="math inline">\(\mathbf{D}^{-1/2} \boldsymbol{\mu}_i, \mathbf{R}\)</span></td>
</tr>
</tbody>
</table>
<p>Inverse prediction of input variables provides sensitivity analysis (Clark et al. 2011, 2014). Columns in <span class="math inline">\(\mathbf{X}\)</span> that are linear (not involved in interactions, polynomial terms, or factors) are sampled directly from the inverted model. Others are sampled by Metropolis. Sampling is described in the Supplement file to Clark et al. (2017).</p>
<p><a href="http://sites.nicholas.duke.edu/clarklab/code/">website</a></p>
<p><br></p>
</div>
<div id="acknowledgements" class="section level1">
<h1><span style="color:darkgreen">acknowledgements</span></h1>
<p>For valuable feedback on the model and computation I thank Bene Bachelot, Alan Gelfand, Diana Nemergut, Erin Schliep, Bijan Seyednasrollah, Daniel Taylor-Rodriquez, Brad Tomasek, Phillip Turner, and Stacy Zhang. Daniel Taylor-Rodriguez implemented the dimension reduction. I thank the members of NSF’s <em>SAMSI</em> program on <em>Ecological Statistics</em> and my class <em>Bayesian Analysis of Environmental Data</em> at Duke University. Funding came from NSF’s Macrosystems Biology and EAGER programs.</p>
<p><br></p>
</div>
<div id="references" class="section level1">
<h1><span style="color:darkgreen">references</span></h1>
<p>Brynjarsdottir, J. and A.E. Gelfand. 2014. Collective sensitivity analysis for ecological regression models with multivariate response. <em>Journal of Biological, Environmental, and Agricultural Statistics</em> 19, 481-502.</p>
<p>Chib, S and E Greenberg. 1998. Analysis of multivariate probit models. <em>Biometrika</em> 85, 347-361.</p>
<p>Clark, JS 2016. Why species tell us more about traits than traits tell us about species, <em>Ecology</em> 97, 1979-1993.</p>
<p>Clark, JS, DM Bell, MH Hersh, and L Nichols. 2011. Climate change vulnerability of forest biodiversity: climate and resource tracking of demographic rates. <em>Global Change Biology</em> 17, 1834-1849.</p>
<p>Clark, JS, DM Bell, M Kwit, A Powell, and K Zhu. 2013. Dynamic inverse prediction and sensitivity analysis with high-dimensional responses: application to climate-change vulnerability of biodiversity. <em>Journal of Biological, Environmental, and Agricultural Statistics</em> 18, 376-404.</p>
<p>Clark, JS, AE Gelfand, CW Woodall, and K Zhu. 2014. More than the sum of the parts: forest climate response from joint species distribution models. <em>Ecological Applications</em> 24, 990-999</p>
<p>Clark, JS, D Nemergut, B Seyednasrollah, P Turner, and S Zhang. 2017. Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data, <em>Ecological Monographs</em> 87, 34–56.</p>
<p>Lawrence, E, D Bingham, C Liu, and V N Nair (2008) Bayesian inference for multivariate ordinal data using parameter expansion. <em>Technometrics</em> 50, 182-191.</p>
<p>Taylor-Rodriguez, D, K Kaufeld, E Schliep, JS Clark, and AE Gelfand, 2017. Joint Species distribution modeling: dimension reduction using Dirichlet processes, <em>Bayesian Analysis</em> in press.</p>
<p>Zhang, X, WJ Boscardin, and TR Belin. 2008. Bayesian analysis of multivariate nominal measures using multivariate multinomial probit models. <em>Computational Statistics and Data Analysis</em> 52, 3697-3708.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
